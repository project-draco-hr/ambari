def assert_service_check(self):
    self.assertResourceCalled('ExecuteHadoop', 'dfsadmin -safemode get | grep OFF', logoutput=True, tries=20, conf_dir='/etc/hadoop/conf', try_sleep=15, user='ambari-qa')
    self.assertResourceCalled('ExecuteHadoop', 'fs -mkdir /tmp ; hadoop fs -chmod 777 /tmp', conf_dir='/etc/hadoop/conf', logoutput=True, not_if="/usr/bin/sudo su ambari-qa -l -s /bin/bash -c 'export {ENV_PLACEHOLDER} > /dev/null ; hadoop fs -test -e /tmp'", try_sleep=3, tries=5, user='ambari-qa')
    self.assertResourceCalled('ExecuteHadoop', 'fs -rm /tmp/; hadoop fs -put /etc/passwd /tmp/', logoutput=True, tries=5, conf_dir='/etc/hadoop/conf', try_sleep=3, user='ambari-qa')
    self.assertResourceCalled('ExecuteHadoop', 'fs -test -e /tmp/', logoutput=True, tries=5, conf_dir='/etc/hadoop/conf', try_sleep=3, user='ambari-qa')
    self.assertNoMoreResources()
