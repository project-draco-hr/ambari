def assert_service_check(self):
    self.assertResourceCalled('ExecuteHadoop', 'dfsadmin -safemode get | grep OFF', logoutput=True, tries=20, conf_dir='/etc/hadoop/conf', try_sleep=3, bin_dir='/usr/bin', user='ambari-qa')
    self.assertResourceCalled('ExecuteHadoop', 'fs -mkdir /tmp', conf_dir='/etc/hadoop/conf', bin_dir='/usr/bin', logoutput=True, not_if="su - ambari-qa -c 'hadoop --config /etc/hadoop/conf fs -test -e /tmp'", try_sleep=3, tries=5, user='ambari-qa')
    self.assertResourceCalled('ExecuteHadoop', 'fs -chmod 777 /tmp', conf_dir='/etc/hadoop/conf', bin_dir='/usr/bin', logoutput=True, try_sleep=3, tries=5, user='ambari-qa')
    self.assertResourceCalled('ExecuteHadoop', 'fs -rm /tmp/; hadoop --config /etc/hadoop/conf fs -put /etc/passwd /tmp/', logoutput=True, bin_dir='/usr/bin', tries=5, conf_dir='/etc/hadoop/conf', try_sleep=3, user='ambari-qa')
    self.assertResourceCalled('ExecuteHadoop', 'fs -test -e /tmp/', logoutput=True, tries=5, bin_dir='/usr/bin', conf_dir='/etc/hadoop/conf', try_sleep=3, user='ambari-qa')
