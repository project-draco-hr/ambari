{
  TestViewDataMigrationService service=new TestViewDataMigrationService(viewName,version2,instanceName);
  ViewDataMigrationContextImpl context=getViewDataMigrationContext();
  service.setMigrationContext(context);
  ViewDataMigrator migrator=createStrictMock(ViewDataMigrator.class);
  expect(migrator.beforeMigration()).andReturn(true);
  migrator.migrateEntity(anyObject(Class.class),anyObject(Class.class));
  expectLastCall();
  migrator.migrateInstanceData();
  expectLastCall();
  migrator.afterMigration();
  expectLastCall();
  replay(migrator);
  service.setMigrator(migrator);
  service.migrateData(version1,instanceName);
  verify(migrator);
}
