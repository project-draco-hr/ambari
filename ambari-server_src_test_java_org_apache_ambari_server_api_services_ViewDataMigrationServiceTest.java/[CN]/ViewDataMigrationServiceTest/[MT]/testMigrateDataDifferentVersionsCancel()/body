{
  TestViewDataMigrationService service=new TestViewDataMigrationService(viewName,version2,instanceName);
  ViewDataMigrationContextImpl context=getViewDataMigrationContext();
  service.setMigrationContext(context);
  ViewDataMigrator migrator=createStrictMock(ViewDataMigrator.class);
  expect(migrator.beforeMigration()).andReturn(false);
  replay(migrator);
  service.setMigrator(migrator);
  thrown.expect(ViewDataMigrationException.class);
  service.migrateData(version1,instanceName);
}
