def pre_upgrade_restart(self, env, upgrade_type=None):
    Logger.info('Executing Stack Upgrade pre-restart')
    import params
    env.set_params(params)
    if (not (params.version and check_stack_feature(StackFeature.ROLLING_UPGRADE, params.version))):
        return
    Logger.info('Executing Falcon Server Stack Upgrade pre-restart')
    conf_select.select(params.stack_name, 'falcon', params.version)
    stack_select.select('falcon-server', params.version)
    if ((upgrade_type is not None) and (params.upgrade_direction == Direction.UPGRADE) and check_stack_feature(StackFeature.FALCON_EXTENSIONS, params.stack_version_formatted) and (not check_stack_feature(StackFeature.FALCON_EXTENSIONS, params.current_version_formatted))):
        params.HdfsResource(params.falcon_extensions_dest_dir, type='directory', action='create_on_execute', owner=params.falcon_user, group=params.proxyuser_group, recursive_chown=True, recursive_chmod=True, mode=504, source=params.falcon_extensions_source_dir)
        params.HdfsResource(None, action='execute')
    falcon_server_upgrade.pre_start_restore()
