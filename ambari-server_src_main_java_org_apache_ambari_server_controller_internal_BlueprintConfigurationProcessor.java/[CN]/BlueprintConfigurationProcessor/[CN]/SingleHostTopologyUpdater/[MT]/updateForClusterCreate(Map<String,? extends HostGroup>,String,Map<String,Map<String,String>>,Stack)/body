{
  Matcher m=HOSTGROUP_REGEX.matcher(origValue);
  if (m.find()) {
    String hostGroupName=m.group(1);
    HostGroup hostGroup=hostGroups.get(hostGroupName);
    return origValue.replace(m.group(0),hostGroup.getHostInfo().iterator().next());
  }
 else {
    Collection<HostGroup> matchingGroups=getHostGroupsForComponent(component,hostGroups.values());
    if (matchingGroups.size() == 1) {
      return origValue.replace("localhost",matchingGroups.iterator().next().getHostInfo().iterator().next());
    }
 else {
      Cardinality cardinality=stackDefinition.getCardinality(component);
      if (matchingGroups.isEmpty() && cardinality.isValidCount(0)) {
        return origValue;
      }
 else {
        if (isNameNodeHAEnabled(properties) && isComponentNameNode() && (matchingGroups.size() == 2)) {
          if (properties.get("core-site").get("fs.defaultFS").equals(origValue)) {
            return origValue;
          }
        }
        throw new IllegalArgumentException("Unable to update configuration property with topology information. " + "Component '" + component + "' is not mapped to any host group or is mapped to multiple groups.");
      }
    }
  }
}
