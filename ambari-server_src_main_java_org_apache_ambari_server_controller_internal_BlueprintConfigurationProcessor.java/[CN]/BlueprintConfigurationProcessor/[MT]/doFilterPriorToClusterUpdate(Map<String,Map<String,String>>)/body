{
  for (  String configType : properties.keySet()) {
    Map<String,String> configPropertiesPerType=properties.get(configType);
    Set<String> propertiesToExclude=new HashSet<String>();
    for (    String propertyName : configPropertiesPerType.keySet()) {
      if (shouldPropertyBeExcludedForClusterUpdate(propertyName,configPropertiesPerType.get(propertyName),configType,this.clusterTopology)) {
        propertiesToExclude.add(propertyName);
      }
    }
    if (!propertiesToExclude.isEmpty()) {
      for (      String propertyName : propertiesToExclude) {
        configPropertiesPerType.remove(propertyName);
      }
    }
  }
}
