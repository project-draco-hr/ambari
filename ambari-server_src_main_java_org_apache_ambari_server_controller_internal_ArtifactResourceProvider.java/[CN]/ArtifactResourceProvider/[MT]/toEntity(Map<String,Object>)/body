{
  String name=(String)properties.get(ARTIFACT_NAME_PROPERTY);
  if (name == null || name.isEmpty()) {
    throw new IllegalArgumentException("Artifact name must be provided");
  }
  ArtifactEntity artifact=new ArtifactEntity();
  artifact.setArtifactName(name);
  Map<String,Object> dataMap=new HashMap<String,Object>();
  for (  Map.Entry<String,Object> entry : properties.entrySet()) {
    String key=entry.getKey();
    if (key.startsWith(ARTIFACT_DATA_PROPERTY)) {
      dataMap.put(key.split("/")[1],entry.getValue());
    }
  }
  artifact.setArtifactData(dataMap);
  artifact.setForeignKeys(createForeignKeyMap(properties));
  return artifact;
}
