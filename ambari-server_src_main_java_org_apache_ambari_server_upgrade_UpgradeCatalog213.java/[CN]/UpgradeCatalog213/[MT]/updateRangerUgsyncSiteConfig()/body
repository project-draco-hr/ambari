{
  AmbariManagementController ambariManagementController=injector.getInstance(AmbariManagementController.class);
  for (  final Cluster cluster : getCheckedClusterMap(ambariManagementController.getClusters()).values()) {
    Config rangerUgsyncSiteProperties=cluster.getDesiredConfigByType(RANGER_UGSYNC_SITE_CONFIG);
    if (rangerUgsyncSiteProperties != null && rangerUgsyncSiteProperties.getProperties().containsKey(RANGER_USERSYNC_SOURCE_IMPL_CLASS_PROPERTY)) {
      if (rangerUgsyncSiteProperties.getProperties().get(RANGER_USERSYNC_SOURCE_IMPL_CLASS_PROPERTY).equals("ldap")) {
        Map<String,String> updates=Collections.singletonMap(RANGER_USERSYNC_SOURCE_IMPL_CLASS_PROPERTY,"org.apache.ranger.ldapusersync.process.LdapUserGroupBuilder");
        updateConfigurationPropertiesForCluster(cluster,RANGER_UGSYNC_SITE_CONFIG,updates,true,false);
      }
 else       if (rangerUgsyncSiteProperties.getProperties().get(RANGER_USERSYNC_SOURCE_IMPL_CLASS_PROPERTY).equals("unix")) {
        Map<String,String> updates=Collections.singletonMap(RANGER_USERSYNC_SOURCE_IMPL_CLASS_PROPERTY,"org.apache.ranger.unixusersync.process.UnixUserGroupBuilder");
        updateConfigurationPropertiesForCluster(cluster,RANGER_UGSYNC_SITE_CONFIG,updates,true,false);
      }
 else       if (rangerUgsyncSiteProperties.getProperties().get(RANGER_USERSYNC_SOURCE_IMPL_CLASS_PROPERTY).equals("file")) {
        Map<String,String> updates=Collections.singletonMap(RANGER_USERSYNC_SOURCE_IMPL_CLASS_PROPERTY,"org.apache.ranger.unixusersync.process.FileSourceUserGroupBuilder");
        updateConfigurationPropertiesForCluster(cluster,RANGER_UGSYNC_SITE_CONFIG,updates,true,false);
      }
    }
  }
}
