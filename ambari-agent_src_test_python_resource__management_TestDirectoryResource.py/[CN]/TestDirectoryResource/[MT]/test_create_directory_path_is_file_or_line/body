@patch.object(os.path, 'exists')
@patch.object(os.path, 'isdir')
def test_create_directory_path_is_file_or_line(self, isdir_mock, os_path_exists_mock):
    os_path_exists_mock.return_value = True
    isdir_mock.return_value = False
    try:
        with Environment('/') as env:
            Directory('/a/b/c/d', action='create', mode=511, owner='hdfs', group='hadoop')
        self.fail('Must fail because file /a/b/c/d already exists')
    except Fail as e:
        self.assertEqual('Applying u"Directory[\'/a/b/c/d\']" failed, file /a/b/c/d already exists', str(e))
