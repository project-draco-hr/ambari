{
  LOG.info("Creating Cluster '" + properties.get(CLUSTER_NAME_PROPERTY_ID) + "' based on blueprint '"+ String.valueOf(properties.get(BLUEPRINT_PROPERTY_ID))+ "'.");
  ProvisionClusterRequest createClusterRequest;
  try {
    createClusterRequest=topologyRequestFactory.createProvisionClusterRequest(properties);
  }
 catch (  InvalidTopologyTemplateException e) {
    throw new IllegalArgumentException("Invalid Cluster Creation Template: " + e,e);
  }
  try {
    return topologyManager.provisionCluster(createClusterRequest);
  }
 catch (  InvalidTopologyException e) {
    throw new IllegalArgumentException("Topology validation failed: " + e,e);
  }
catch (  AmbariException e) {
    e.printStackTrace();
    throw new SystemException("Unknown exception when asking TopologyManager to provision cluster",e);
  }
}
