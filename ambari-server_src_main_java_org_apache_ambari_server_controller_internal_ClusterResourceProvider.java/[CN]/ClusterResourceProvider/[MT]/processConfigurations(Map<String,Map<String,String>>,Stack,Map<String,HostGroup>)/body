{
  for (  String service : getServicesToDeploy(stack,blueprintHostGroups)) {
    for (    String type : stack.getConfigurationTypes(service)) {
      Map<String,String> typeProps=mapClusterConfigurations.get(type);
      if (typeProps == null) {
        typeProps=new HashMap<String,String>();
        mapClusterConfigurations.put(type,typeProps);
      }
      typeProps.putAll(stack.getConfigurationProperties(service,type));
    }
  }
  processBlueprintClusterConfigurations(blueprintConfigurations);
  for (  Map.Entry<String,Map<String,String>> entry : mapClusterConfigurations.entrySet()) {
    for (    Map.Entry<String,String> propertyEntry : entry.getValue().entrySet()) {
      String propName=propertyEntry.getKey();
      PropertyUpdater propertyUpdater=propertyUpdaters.get(propName);
      if (propertyUpdater != null) {
        propertyEntry.setValue(propertyUpdater.update(blueprintHostGroups,propertyEntry.getValue()));
      }
    }
  }
  setMissingConfigurations();
}
