{
  final Map<String,String> userProps=new HashMap<String,String>();
  userProps.put("oozie_user","oozie-env");
  userProps.put("hive_user","hive-env");
  userProps.put("hcat_user","hive-env");
  userProps.put("hbase_user","hbase-env");
  userProps.put("falcon_user","falcon-env");
  String proxyUserHosts="hadoop.proxyuser.%s.hosts";
  String proxyUserGroups="hadoop.proxyuser.%s.groups";
  for (  String property : userProps.keySet()) {
    String configType=userProps.get(property);
    Map<String,String> configs=mapClusterConfigurations.get(configType);
    String user=configs.get(property);
    if (user != null && !user.isEmpty()) {
      ensureProperty("core-site",String.format(proxyUserHosts,user),"*");
      ensureProperty("core-site",String.format(proxyUserGroups,user),"users");
    }
  }
}
