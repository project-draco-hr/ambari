{
  ClusterRequest cr=new ClusterRequest((Long)properties.get(CLUSTER_ID_PROPERTY_ID),(String)properties.get(CLUSTER_NAME_PROPERTY_ID),(String)properties.get(CLUSTER_VERSION_PROPERTY_ID),null);
  for (  Entry<String,Object> entry : properties.entrySet()) {
    String absCategory=PropertyHelper.getPropertyCategory(entry.getKey());
    String propName=PropertyHelper.getPropertyName(entry.getKey());
    if (absCategory.startsWith("Clusters.desired_config")) {
      ConfigurationRequest config=(null == cr.getDesiredConfig()) ? new ConfigurationRequest() : cr.getDesiredConfig();
      cr.setDesiredConfig(config);
      if (propName.equals("type"))       config.setType(entry.getValue().toString());
 else       if (propName.equals("tag"))       config.setVersionTag(entry.getValue().toString());
 else       if (absCategory.endsWith(".properties")) {
        config.getProperties().put(propName,entry.getValue().toString());
      }
    }
  }
  return cr;
}
