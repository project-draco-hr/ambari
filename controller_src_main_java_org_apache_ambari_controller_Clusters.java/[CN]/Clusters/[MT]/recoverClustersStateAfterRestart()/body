{
  for (  Cluster cls : this.getClustersList("ALL")) {
    ClusterDefinition cdef=cls.getClusterDefinition(-1);
    this.validateClusterDefinition(cdef.getName(),cdef);
    if (cdef.getNodes() != null && !cdef.getGoalState().equals(ClusterDefinition.GOAL_STATE_ATTIC)) {
      this.updateClusterNodesReservation(cls.getName(),cdef);
    }
    if (!cdef.getGoalState().equals(ClusterDefinition.GOAL_STATE_ATTIC)) {
      this.updateNodeToRolesAssociation(cdef.getNodes(),cdef.getRoleToNodesMap());
    }
    ClusterFSM cs=fsmDriver.createCluster(cls,cls.getLatestRevisionNumber());
    if (cdef.getGoalState().equals(ClusterState.CLUSTER_STATE_ACTIVE)) {
      fsmDriver.startCluster(cls.getName());
    }
 else     if (cdef.getGoalState().equals(ClusterState.CLUSTER_STATE_INACTIVE)) {
      fsmDriver.stopCluster(cls.getName());
    }
 else     if (cdef.getGoalState().equals(ClusterState.CLUSTER_STATE_ATTIC)) {
      fsmDriver.stopCluster(cls.getName());
    }
  }
}
