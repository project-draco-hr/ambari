{
  if (!this.operational_clusters.containsKey(clusterName)) {
    String msg="Cluster [" + clusterName + "] does not exist";
    throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_FOUND)).get());
  }
  if (new_name == null || new_name.equals("")) {
    String msg="New name of the cluster should be specified as query parameter, (?new_name=xxxx)";
    throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.BAD_REQUEST)).get());
  }
synchronized (operational_clusters) {
    if (!this.operational_clusters.get(clusterName).getClusterState().getState().equals(ClusterState.CLUSTER_STATE_ATTIC)) {
      String msg="Cluster state is not ATTIC. Cluster is only allowed to be renamed in ATTIC state";
      throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_ACCEPTABLE)).get());
    }
    Cluster x=this.operational_clusters.get(clusterName);
    x.getLatestClusterDefinition().setName(new_name);
    this.operational_clusters.remove(clusterName);
    this.operational_clusters.put(new_name,x);
    this.operational_clusters_id_to_name.remove(x.getID());
    this.operational_clusters_id_to_name.put(x.getID(),new_name);
  }
}
