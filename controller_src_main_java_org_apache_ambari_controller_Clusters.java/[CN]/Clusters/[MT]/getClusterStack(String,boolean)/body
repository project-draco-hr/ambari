{
  if (!this.operational_clusters.containsKey(clusterName)) {
    String msg="Cluster [" + clusterName + "] does not exist";
    throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_FOUND)).get());
  }
  Cluster cls=this.operational_clusters.get(clusterName);
  String blueprintName=cls.getLatestClusterDefinition().getStackName();
  int blueprintRevision=Integer.parseInt(cls.getLatestClusterDefinition().getStackRevision());
  Stack bp;
  if (!expanded) {
    bp=Stacks.getInstance().getStack(blueprintName,blueprintRevision);
  }
 else {
    bp=Stacks.getInstance().getStack(blueprintName,blueprintRevision);
  }
  return bp;
}
