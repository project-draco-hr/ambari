{
  List<Node> list=new ArrayList<Node>();
  Map<String,Node> nodeMap=nodes.getNodes();
  ClusterDefinition c=operational_clusters.get(clusterName).getClusterDefinition(-1);
  if (c.getNodes() == null || c.getNodes().equals("") || getClusterByName(clusterName).getClusterState().getState().equalsIgnoreCase("ATTIC")) {
    String msg="No nodes are reserved for the cluster. Typically" + " cluster in ATTIC state does not have any nodes reserved";
    throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NO_CONTENT)).get());
  }
  List<String> hosts=getHostnamesFromRangeExpressions(c.getNodes());
  for (  String host : hosts) {
    if (!nodeMap.containsKey(host)) {
      String msg="Node [" + host + "] is expected to be registered w/ controller but not "+ "locatable";
      throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.INTERNAL_SERVER_ERROR)).get());
    }
    Node n=nodeMap.get(host);
    if (roleName != null && !roleName.equals("")) {
      if (!n.getNodeState().getNodeRoleNames().contains(roleName)) {
        continue;
      }
    }
    GregorianCalendar cal=new GregorianCalendar();
    cal.setTime(new Date());
    XMLGregorianCalendar curTime=DatatypeFactory.newInstance().newXMLGregorianCalendar(cal);
    if (alive.equals("") || (alive.equalsIgnoreCase("true") && Nodes.getTimeDiffInMillis(curTime,n.getNodeState().getLastHeartbeatTime()) < Nodes.NODE_NOT_RESPONDING_DURATION) || (alive.equals("false") && Nodes.getTimeDiffInMillis(curTime,n.getNodeState().getLastHeartbeatTime()) >= Nodes.NODE_NOT_RESPONDING_DURATION)) {
      list.add(nodeMap.get(host));
    }
  }
  return list;
}
