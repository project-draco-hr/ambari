{
  Hashtable<String,String> clusterStacks=new Hashtable<String,String>();
  List<String> clusterNames=dataStore.retrieveClusterList();
  for (  String clsName : clusterNames) {
    Cluster c=getClusterByName(clsName);
    String cBPName=c.getClusterDefinition(-1).getStackName();
    String cBPRevision=c.getClusterDefinition(-1).getStackRevision();
    clusterStacks.put(cBPName,cBPRevision);
    Stack bpx=stacks.getStack(cBPName,Integer.parseInt(cBPRevision));
    while (bpx.getParentName() != null) {
      bpx=stacks.getStack(bpx.getParentName(),bpx.getParentRevision());
      clusterStacks.put(bpx.getName(),bpx.getRevision());
    }
  }
  return clusterStacks;
}
