def upgrade_schema(self, env):
    '\n    Executes the schema upgrade binary.  This is its own function because it could\n    be called as a standalone task from the upgrade pack, but is safe to run it for each\n    metastore instance.\n    '
    Logger.info('Upgrading Hive Metastore')
    import params
    env.set_params(params)
    if params.security_enabled:
        kinit_command = format('{kinit_path_local} -kt {smoke_user_keytab} {smokeuser_principal}; ')
        Execute(kinit_command, user=params.smokeuser)
    binary = format('/usr/hdp/{version}/hive/bin/schematool')
    env_dict = {'HIVE_CONF_DIR': params.hive_server_conf_dir, }
    command = format('{binary} -dbType {hive_metastore_db_type} -upgradeSchema')
    Execute(command, user=params.hive_user, tries=1, environment=env_dict, logoutput=True)
