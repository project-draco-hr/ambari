def pre_upgrade_restart(self, env, upgrade_type=None):
    Logger.info('Executing Metastore Stack Upgrade pre-restart')
    import params
    if Script.is_hdp_stack_greater_or_equal('2.3'):
        params.init_metastore_schema = False
    env.set_params(params)
    if Script.is_hdp_stack_greater_or_equal('2.3'):
        self.configure(env)
        self.upgrade_schema(env)
    if (params.version and (compare_versions(format_hdp_stack_version(params.version), '2.2.0.0') >= 0)):
        conf_select.select(params.stack_name, 'hive', params.version)
        hdp_select.select('hive-metastore', params.version)
