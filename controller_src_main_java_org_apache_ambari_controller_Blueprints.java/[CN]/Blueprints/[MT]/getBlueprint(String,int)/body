{
  Blueprint bp=null;
  if (revision == -1) {
    this.blueprints.get(blueprintName).keySet();
    Integer[] a=new Integer[]{};
    Integer[] keys=this.blueprints.get(blueprintName).keySet().toArray(a);
    Arrays.sort(keys);
    bp=this.blueprints.get(blueprintName).get(keys[keys.length - 1]);
  }
 else {
    if (!this.blueprints.containsKey(blueprintName) || !this.blueprints.get(blueprintName).containsKey(revision)) {
      String msg="Blueprint [" + blueprintName + "], revision ["+ revision+ "] does not exists";
      throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.BAD_REQUEST)).get());
    }
    bp=this.blueprints.get(blueprintName).get(revision);
  }
  return bp;
}
