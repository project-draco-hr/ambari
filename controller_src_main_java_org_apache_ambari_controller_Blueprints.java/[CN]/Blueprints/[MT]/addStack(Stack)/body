{
  validateAndSetStackDefaults(bp);
  if (stacks.containsKey(bp.getName())) {
    if (stacks.get(bp.getName()).containsKey(new Integer(bp.getRevision()))) {
      String msg="Specified blueprint [Name:" + bp.getName() + ", Revision: ["+ bp.getRevision()+ "] already imported";
      throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.BAD_REQUEST)).get());
    }
 else {
      stacks.get(bp.getName()).put(new Integer(bp.getRevision()),bp);
    }
  }
 else {
    ConcurrentHashMap<Integer,Stack> x=new ConcurrentHashMap<Integer,Stack>();
    x.put(new Integer(bp.getRevision()),bp);
    this.stacks.put(bp.getName(),x);
  }
  return bp;
}
