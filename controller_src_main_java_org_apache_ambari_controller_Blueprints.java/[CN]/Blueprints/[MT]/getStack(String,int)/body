{
  Stack bp=null;
  if (!this.stacks.containsKey(blueprintName)) {
    String msg="Stack [" + blueprintName + "] is not defined";
    throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_FOUND)).get());
  }
  if (revision == -1) {
    this.stacks.get(blueprintName).keySet();
    Integer[] a=new Integer[]{};
    Integer[] keys=this.stacks.get(blueprintName).keySet().toArray(a);
    Arrays.sort(keys);
    bp=this.stacks.get(blueprintName).get(keys[keys.length - 1]);
  }
 else {
    if (!this.stacks.get(blueprintName).containsKey(revision)) {
      String msg="Stack [" + blueprintName + "], revision ["+ revision+ "] does not exist";
      throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_FOUND)).get());
    }
    bp=this.stacks.get(blueprintName).get(revision);
  }
  return bp;
}
