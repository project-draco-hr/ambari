{
  Blueprint bp=this.blueprints.get(blueprintName).get(new Integer(revision));
  for (  Cluster c : Clusters.getInstance().operational_clusters.values()) {
    String bpName=c.getLatestClusterDefinition().getBlueprintName();
    String bpRevision=c.getLatestClusterDefinition().getBlueprintRevision();
    if (c.getClusterState().getState().equals(ClusterStateFSM.ATTIC)) {
      continue;
    }
    Blueprint bpx=Blueprints.getInstance().blueprints.get(bpName).get(new Integer(bpRevision));
    if (bpx.getName().equals(bp.getName()) && bpx.getRevision().equals(bp.getRevision()) || bpx.getParentName().equals(bp.getParentName()) && bpx.getParentRevision().equals(bp.getParentRevision())) {
      String msg="One or more clusters are associated with the specified blueprint";
      throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_ACCEPTABLE)).get());
    }
  }
  this.blueprints.get(blueprintName).remove(revision);
  if (this.blueprints.get(blueprintName).keySet().isEmpty()) {
    this.blueprints.remove(blueprintName);
  }
}
