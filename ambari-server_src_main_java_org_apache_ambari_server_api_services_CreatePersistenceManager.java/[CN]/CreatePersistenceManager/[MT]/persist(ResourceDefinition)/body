{
  ClusterController controller=getClusterController();
  Map<Resource.Type,String> mapResourceIds=resource.getResourceIds();
  Resource.Type type=resource.getType();
  Schema schema=controller.getSchema(type);
  for (  Map.Entry<Resource.Type,String> entry : mapResourceIds.entrySet()) {
    resource.setProperty(schema.getKeyPropertyId(entry.getKey()),entry.getValue());
  }
  try {
    return controller.createResources(type,createControllerRequest(resource.getProperties()));
  }
 catch (  AmbariException e) {
    throw new RuntimeException("Create of resource failed: " + e,e);
  }
}
