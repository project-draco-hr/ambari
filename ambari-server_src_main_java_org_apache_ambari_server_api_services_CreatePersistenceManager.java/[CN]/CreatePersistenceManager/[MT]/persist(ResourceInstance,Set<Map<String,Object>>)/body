{
  ClusterController controller=getClusterController();
  Map<Resource.Type,String> mapResourceIds=resource.getIds();
  Resource.Type type=resource.getResourceDefinition().getType();
  Schema schema=controller.getSchema(type);
  if (setProperties.size() == 0) {
    setProperties.add(new HashMap<String,Object>());
  }
  for (  Map<String,Object> mapProperties : setProperties) {
    for (    Map.Entry<Resource.Type,String> entry : mapResourceIds.entrySet()) {
      String property=schema.getKeyPropertyId(entry.getKey());
      if (!mapProperties.containsKey(property)) {
        mapProperties.put(property,entry.getValue());
      }
    }
  }
  try {
    return controller.createResources(type,createControllerRequest(setProperties));
  }
 catch (  AmbariException e) {
    throw new RuntimeException("Create of resource failed: " + e,e);
  }
catch (  UnsupportedPropertyException e) {
    throw new RuntimeException("Create of resource failed: " + e,e);
  }
}
