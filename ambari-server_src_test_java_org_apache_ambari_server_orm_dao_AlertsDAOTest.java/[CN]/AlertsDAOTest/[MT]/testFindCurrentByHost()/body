{
  AlertDefinitionEntity hostDef=new AlertDefinitionEntity();
  hostDef.setDefinitionName("Host Alert Definition ");
  hostDef.setServiceName("HostService");
  hostDef.setComponentName(null);
  hostDef.setClusterId(m_clusterId);
  hostDef.setHash(UUID.randomUUID().toString());
  hostDef.setScheduleInterval(Integer.valueOf(60));
  hostDef.setScope(Scope.HOST);
  hostDef.setSource("{\"type\" : \"SCRIPT\"}");
  hostDef.setSourceType(SourceType.SCRIPT);
  m_definitionDao.create(hostDef);
  AlertHistoryEntity history=new AlertHistoryEntity();
  history.setServiceName(hostDef.getServiceName());
  history.setClusterId(m_clusterId);
  history.setAlertDefinition(hostDef);
  history.setAlertLabel(hostDef.getDefinitionName());
  history.setAlertText(hostDef.getDefinitionName());
  history.setAlertTimestamp(Long.valueOf(1L));
  history.setHostName("h2");
  history.setAlertState(AlertState.OK);
  AlertCurrentEntity current=new AlertCurrentEntity();
  current.setOriginalTimestamp(1L);
  current.setLatestTimestamp(2L);
  current.setAlertHistory(history);
  m_dao.create(current);
  List<AlertCurrentEntity> currentAlerts=m_dao.findCurrentByHost(m_clusterId,history.getHostName());
  assertNotNull(currentAlerts);
  assertEquals(1,currentAlerts.size());
  currentAlerts=m_dao.findCurrentByHost(m_clusterId,"foo");
  assertNotNull(currentAlerts);
  assertEquals(0,currentAlerts.size());
}
