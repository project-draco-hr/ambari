def set_cluster(self):
    self.cluster_id = None
    self.cluster_name = None
    try:
        query = 'SELECT cluster_id, cluster_name FROM clusters ORDER BY cluster_name;'
        self.cursor.execute(query)
        rows = self.cursor.fetchall()
        if rows:
            if (len(rows) == 1):
                if (len(rows[0]) == 2):
                    self.cluster_id = int(rows[0][0])
                    self.cluster_name = rows[0][1]
            elif (len(rows) > 1):
                question = 'We found multiple cluster names, which one should we use?\n'
                for i in range(0, len(rows)):
                    question += '{0}) {1}\n'.format((i + 1), rows[i][1])
                answer = None
                while (answer is None):
                    answer = self.ask_question(question, numeric=True)
                    if ((answer > 0) and (answer <= len(rows))):
                        self.cluster_id = int(rows[(answer - 1)][0])
                        self.cluster_name = rows[(answer - 1)][1]
                    else:
                        Logger.error('Invalid option "{0}", please try again.\n'.format(answer))
                        answer = None
            pass
            if (self.cluster_name is None):
                Logger.error('Unable to determine the cluster name.\n')
                self.terminate()
            else:
                Logger.info('Selected cluster name: {0}\n'.format(self.cluster_name))
        else:
            Logger.error('Unable to get cluster from query: {0}\n'.format(query))
            self.terminate()
    except Exception as e:
        Logger.error('Caught an exception. Error: {0}\n'.format(e.message))
        self.terminate()
