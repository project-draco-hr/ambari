{
  try {
    Statement statement=connection.createStatement();
    currentStatement=(HiveStatement)statement;
    boolean hasResultSet=false;
    for (    String syncStatement : job.getStatements()) {
      hasResultSet=statement.execute(syncStatement);
    }
    if (hasResultSet) {
      ResultSet resultSet=statement.getResultSet();
      return Optional.of(resultSet);
    }
 else {
      return Optional.absent();
    }
  }
 catch (  SQLException e) {
    currentStatement.close();
    throw e;
  }
}
