{
  String clusterName=request.getClusterName();
  ClusterTopology topology=clusterTopologyMap.get(clusterName);
  if (topology == null) {
    throw new AmbariException("TopologyManager: Unable to retrieve cluster topology for cluster: " + clusterName);
  }
  topology.update(request);
  return getRequestStatus(processRequest(request,topology).getRequestId());
}
