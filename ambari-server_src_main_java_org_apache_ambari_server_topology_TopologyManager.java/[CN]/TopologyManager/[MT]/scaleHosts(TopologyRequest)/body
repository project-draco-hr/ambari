{
  ensureInitialized();
  String clusterName=request.getClusterName();
  ClusterTopology topology=clusterTopologyMap.get(clusterName);
  if (topology == null) {
    throw new AmbariException("TopologyManager: Unable to retrieve cluster topology for cluster: " + clusterName);
  }
  PersistedTopologyRequest persistedRequest=persistedState.persistTopologyRequest(request);
  topology.update(request);
  return getRequestStatus(processRequest(persistedRequest,topology).getRequestId());
}
