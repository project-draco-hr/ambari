{
  LogicalRequest logicalRequest=new LogicalRequest(request,new ClusterTopologyContext(topology));
  allRequests.put(logicalRequest.getRequestId(),logicalRequest);
synchronized (reservedHosts) {
    for (    String host : logicalRequest.getReservedHosts()) {
      reservedHosts.put(host,logicalRequest);
    }
  }
  return logicalRequest;
}
