{
  ClusterTopology topology=new ClusterTopologyImpl(request);
  String clusterName=topology.getClusterName();
  clusterTopologyMap.put(clusterName,topology);
  createClusterResource(clusterName);
  createServiceAndComponentResources(topology);
  LogicalRequest logicalRequest=processRequest(request,topology);
  try {
    addClusterConfigRequest(new ClusterConfigurationRequest(topology));
  }
 catch (  AmbariException e) {
    throw e;
  }
  persistInstallStateForUI(clusterName);
  return getRequestStatus(logicalRequest.getRequestId());
}
