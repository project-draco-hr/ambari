{
  String hostName=host.getHostName();
  try {
    topology.addHostToTopology(response.getHostGroupName(),hostName);
  }
 catch (  InvalidTopologyException e) {
    throw new RuntimeException("An internal error occurred while performing request host registration: " + e,e);
  }
catch (  NoSuchHostGroupException e) {
    throw new RuntimeException("An internal error occurred while performing request host registration: " + e,e);
  }
  persistedState.registerHostName(response.getHostRequestId(),hostName);
  LOG.info("TopologyManager.processAcceptedHostOffer: about to execute tasks for host = {}",hostName);
  for (  TopologyTask task : response.getTasks()) {
    LOG.info("Processing accepted host offer for {} which responded {} and task {}",hostName,response.getAnswer(),task.getType());
    task.init(topology,ambariContext);
    executor.execute(task);
  }
}
