{
  String hostName=host.getHostName();
  try {
    topology.addHostToTopology(response.getHostGroupName(),hostName);
  }
 catch (  InvalidTopologyException e) {
    throw new RuntimeException("An internal error occurred while performing request host registration: " + e,e);
  }
catch (  NoSuchHostGroupException e) {
    throw new RuntimeException("An internal error occurred while performing request host registration: " + e,e);
  }
  persistedState.registerHostName(response.getHostRequestId(),hostName);
  for (  TopologyTask task : response.getTasks()) {
    task.init(topology,ambariContext);
    executor.execute(task);
  }
}
