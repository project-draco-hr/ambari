{
  LogicalRequest logicalRequest=logicalRequestFactory.createRequest(ambariContext.getNextRequestId(),persistedRequest.getRequest(),topology);
  persistedState.persistLogicalRequest(logicalRequest,persistedRequest.getId());
  allRequests.put(logicalRequest.getRequestId(),logicalRequest);
synchronized (reservedHosts) {
    for (    String host : logicalRequest.getReservedHosts()) {
      reservedHosts.put(host,logicalRequest);
    }
  }
  return logicalRequest;
}
