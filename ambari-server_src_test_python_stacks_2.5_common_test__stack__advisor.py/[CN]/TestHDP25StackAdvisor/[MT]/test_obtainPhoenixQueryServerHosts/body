def test_obtainPhoenixQueryServerHosts(self):
    self.maxDiff = None
    phoenix_query_server_hosts = ['c6402.ambari.apache.org']
    configurations = {'cluster-env': {'properties': {'security_enabled': 'true', }, }, 'core-site': {'properties': {'hadoop.proxyuser.HTTP.hosts': 'c6401.ambari.apache.org', }, }, 'hbase-site': {'properties': {}, }, }
    expected_configuration = {'cluster-env': {'properties': {'security_enabled': 'true', }, }, 'core-site': {'properties': {'hadoop.proxyuser.HTTP.hosts': 'c6401.ambari.apache.org,c6402.ambari.apache.org', }, }, 'hbase-site': {'properties': {'hbase.master.ui.readonly': 'true', }, }, }
    clusterData = {'hbaseRam': 4096, }
    services = {'services': [{'href': '/api/v1/stacks/HDP/versions/2.4/services/HBASE', 'StackServices': {'service_name': 'HBASE', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'PHOENIX_QUERY_SERVER', 'hostnames': phoenix_query_server_hosts, }, }], }], 'configurations': configurations, 'changed-configurations': [], }
    hosts = {'items': [{'href': '/api/v1/hosts/c6401.ambari.apache.org', 'Hosts': {'cpu_count': 1, 'host_name': 'c6401.ambari.apache.org', 'os_arch': 'x86_64', 'os_type': 'centos6', 'ph_cpu_count': 1, 'public_host_name': 'c6401.ambari.apache.org', 'rack_info': '/default-rack', 'total_mem': 1922680, }, }, {'href': '/api/v1/hosts/c6402.ambari.apache.org', 'Hosts': {'cpu_count': 1, 'host_name': 'c6402.ambari.apache.org', 'os_arch': 'x86_64', 'os_type': 'centos6', 'ph_cpu_count': 1, 'public_host_name': 'c6402.ambari.apache.org', 'rack_info': '/default-rack', 'total_mem': 1922680, }, }, {'href': '/api/v1/hosts/c6403.ambari.apache.org', 'Hosts': {'cpu_count': 1, 'host_name': 'c6403.ambari.apache.org', 'os_arch': 'x86_64', 'os_type': 'centos6', 'ph_cpu_count': 1, 'public_host_name': 'c6403.ambari.apache.org', 'rack_info': '/default-rack', 'total_mem': 1922680, }, }], }
    self.assertEquals(self.stackAdvisor.get_phoenix_query_server_hosts(services, hosts), phoenix_query_server_hosts)
    phoenix_query_server_hosts = []
    services['services'][0]['components'][0]['StackServiceComponents']['hostnames'] = phoenix_query_server_hosts
    self.assertEquals(self.stackAdvisor.get_phoenix_query_server_hosts(services, hosts), phoenix_query_server_hosts)
