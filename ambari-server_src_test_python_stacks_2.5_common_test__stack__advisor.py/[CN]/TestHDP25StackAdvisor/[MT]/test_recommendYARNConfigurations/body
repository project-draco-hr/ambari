def test_recommendYARNConfigurations(self):
    hosts = {'items': [{'Hosts': {'cpu_count': 6, 'total_mem': 50331648, 'disk_info': [{'mountpoint': '/', }, {'mountpoint': '/dev/shm', }, {'mountpoint': '/vagrant', }, {'mountpoint': '/', }, {'mountpoint': '/dev/shm', }, {'mountpoint': '/vagrant', }], 'public_host_name': 'c6401.ambari.apache.org', 'host_name': 'c6401.ambari.apache.org', }, }], }
    clusterData = {'cpu': 4, 'mapMemory': 3000, 'amMemory': 2000, 'reduceMemory': 2056, 'containers': 3, 'ramPerContainer': 256, }
    services_1 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.queues=default\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.queue-mappings-override.enable=false\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '0', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '682', 'yarn.nodemanager.resource.memory-mb': '10240', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'default', 'hive.tez.container.size': '341', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_2 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.queues=default\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.queue-mappings-override.enable=false\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', 'llap_queue_capacity': '0', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '682', 'yarn.nodemanager.resource.memory-mb': '2048', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_3 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.queues=default\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.queue-mappings-override.enable=false\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '40', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '682', 'yarn.nodemanager.resource.memory-mb': '2048', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'default', 'hive.tez.container.size': '341', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_4 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=80\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=20\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.llap.capacity=20\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'default', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '682', 'yarn.nodemanager.resource.memory-mb': '2048', }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_5 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'0', u'type': u'hive-interactive-env', u'name': u'llap_queue_capacity', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '0', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '682', 'yarn.nodemanager.resource.memory-mb': '2048', }, }, }, }
    services_6 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.maximum-am-resource-percent=0.2\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.resource-calculator=org.apache.hadoop.yarn.util.resource.DefaultResourceCalculator\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.default.a.a1.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.a1.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.a1.capacity=75\nyarn.scheduler.capacity.root.default.a.a1.maximum-capacity=100\nyarn.scheduler.capacity.root.default.a.a1.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.a1.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.a1.state=RUNNING\nyarn.scheduler.capacity.root.default.a.a1.user-limit-factor=1\nyarn.scheduler.capacity.root.default.a.a2.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.a2.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.a2.capacity=25\nyarn.scheduler.capacity.root.default.a.a2.maximum-capacity=25\nyarn.scheduler.capacity.root.default.a.a2.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.a2.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.a2.state=RUNNING\nyarn.scheduler.capacity.root.default.a.a2.user-limit-factor=1\nyarn.scheduler.capacity.root.default.a.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.capacity=50\nyarn.scheduler.capacity.root.default.a.maximum-capacity=100\nyarn.scheduler.capacity.root.default.a.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.queues=a1,a2\nyarn.scheduler.capacity.root.default.a.state=RUNNING\nyarn.scheduler.capacity.root.default.a.user-limit-factor=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.b.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.b.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.b.capacity=50\nyarn.scheduler.capacity.root.default.b.maximum-capacity=50\nyarn.scheduler.capacity.root.default.b.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.b.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.b.state=RUNNING\nyarn.scheduler.capacity.root.default.b.user-limit-factor=1\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.default.queues=a,b\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.queues=default', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', 'llap_queue_capacity': '0', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_7 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {}, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', 'llap_queue_capacity': '0', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_8 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.a.a1.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.a1.capacity=75\nyarn.scheduler.capacity.root.default.a.a1.maximum-capacity=100\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', 'llap_queue_capacity': '0', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_9 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=STOPPED\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=0\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.llap.capacity=0\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_10 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'off', u'type': u'hive-interactive-env', u'name': u'enable_hive_interactive', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=STOPPED\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=0\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.llap.capacity=0\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '0', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '20000', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_11 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=80\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=20\nyarn.scheduler.capacity.root.default.maximum-capacity=80\nyarn.scheduler.capacity.root.llap.capacity=20\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1\n', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '40', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.tez.container.size': '341', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '20000', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_12 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'', u'type': u'', u'name': u'', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.maximum-am-resource-percent=0.2\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.resource-calculator=org.apache.hadoop.yarn.util.resource.DefaultResourceCalculator\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.default.a.a1.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.a1.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.a1.capacity=75\nyarn.scheduler.capacity.root.default.a.a1.maximum-capacity=100\nyarn.scheduler.capacity.root.default.a.a1.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.a1.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.a1.state=RUNNING\nyarn.scheduler.capacity.root.default.a.a1.user-limit-factor=1\nyarn.scheduler.capacity.root.default.a.llap.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.llap.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.llap.capacity=25\nyarn.scheduler.capacity.root.default.a.llap.maximum-capacity=25\nyarn.scheduler.capacity.root.default.a.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.llap.state=RUNNING\nyarn.scheduler.capacity.root.default.a.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.default.a.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.capacity=50\nyarn.scheduler.capacity.root.default.a.maximum-capacity=100\nyarn.scheduler.capacity.root.default.a.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.queues=a1,llap\nyarn.scheduler.capacity.root.default.a.state=RUNNING\nyarn.scheduler.capacity.root.default.a.user-limit-factor=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.b.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.b.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.b.capacity=50\nyarn.scheduler.capacity.root.default.b.maximum-capacity=50\nyarn.scheduler.capacity.root.default.b.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.b.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.b.state=RUNNING\nyarn.scheduler.capacity.root.default.b.user-limit-factor=1\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.default.queues=a,b\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.queues=default', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', 'llap_queue_capacity': '0', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, }, }
    services_13 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'0', u'type': u'hive-interactive-env', u'name': u'llap_queue_capacity', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '41', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '4096', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    services_14 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'0', u'type': u'hive-interactive-env', u'name': u'llap_queue_capacity', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.maximum-am-resource-percent=0.2\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.resource-calculator=org.apache.hadoop.yarn.util.resource.DefaultResourceCalculator\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.default.a.a1.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.a1.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.a1.capacity=75\nyarn.scheduler.capacity.root.default.a.a1.maximum-capacity=100\nyarn.scheduler.capacity.root.default.a.a1.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.a1.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.a1.state=RUNNING\nyarn.scheduler.capacity.root.default.a.a1.user-limit-factor=1\nyarn.scheduler.capacity.root.default.a.llap.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.llap.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.llap.capacity=25\nyarn.scheduler.capacity.root.default.a.llap.maximum-capacity=25\nyarn.scheduler.capacity.root.default.a.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.llap.state=RUNNING\nyarn.scheduler.capacity.root.default.a.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.default.a.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.a.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.a.capacity=50\nyarn.scheduler.capacity.root.default.a.maximum-capacity=100\nyarn.scheduler.capacity.root.default.a.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.a.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.a.queues=a1,llap\nyarn.scheduler.capacity.root.default.a.state=RUNNING\nyarn.scheduler.capacity.root.default.a.user-limit-factor=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.b.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.b.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.b.capacity=50\nyarn.scheduler.capacity.root.default.b.maximum-capacity=50\nyarn.scheduler.capacity.root.default.b.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.default.b.ordering-policy=fifo\nyarn.scheduler.capacity.root.default.b.state=RUNNING\nyarn.scheduler.capacity.root.default.b.user-limit-factor=1\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.default.queues=a,b\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.queues=default', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '40', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '4096', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    services_15 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'0', u'type': u'hive-interactive-env', u'name': u'llap_queue_capacity', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=STOPPED\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '40', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'default', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '4096', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    services_16 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'true', u'type': u'hive-interactive-env', u'name': u'enable_hive_interactive', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '41', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '4096', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    services_17 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'false', u'type': u'hive-interactive-env', u'name': u'enable_hive_interactive', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', 'llap_queue_capacity': '40', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '4096', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    services_18 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=STOPPED\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'false', 'llap_queue_capacity': '40', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '4096', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    services_19 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'2', u'type': u'hive-interactive-env', u'name': u'num_llap_nodes', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '41', 'num_llap_nodes': 1, }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '341', 'yarn.nodemanager.resource.memory-mb': '4096', 'yarn.nodemanager.resource.cpu-vcores': '1', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    services_20 = {'services': [{'StackServices': {'service_name': 'YARN', }, 'Versions': {'stack_version': '2.5', }, 'components': [{'StackServiceComponents': {'component_name': 'NODEMANAGER', 'hostnames': ['c6401.ambari.apache.org'], }, }], }, {'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE', 'StackServices': {'service_name': 'HIVE', 'service_version': '1.2.1.2.5', 'stack_name': 'HDP', 'stack_version': '2.5', }, 'components': [{'href': '/api/v1/stacks/HDP/versions/2.5/services/HIVE/components/HIVE_SERVER_INTERACTIVE', 'StackServiceComponents': {'advertise_version': 'true', 'bulk_commands_display_name': '', 'bulk_commands_master_component_name': '', 'cardinality': '0-1', 'component_category': 'MASTER', 'component_name': 'HIVE_SERVER_INTERACTIVE', 'custom_commands': ['RESTART_LLAP'], 'decommission_allowed': 'false', 'display_name': 'HiveServer2 Interactive', 'has_bulk_commands_definition': 'false', 'is_client': 'false', 'is_master': 'true', 'reassign_allowed': 'false', 'recovery_enabled': 'false', 'service_name': 'HIVE', 'stack_name': 'HDP', 'stack_version': '2.5', 'hostnames': ['c6401.ambari.apache.org'], }, 'dependencies': [], }, {'StackServiceComponents': {'advertise_version': 'true', 'cardinality': '1+', 'component_category': 'SLAVE', 'component_name': 'NODEMANAGER', 'display_name': 'NodeManager', 'is_client': 'false', 'is_master': 'false', 'hostnames': ['c6403.ambari.apache.org'], }, 'dependencies': [], }], }], 'changed-configurations': [{u'old_value': u'25', u'type': u'hive-interactive-env', u'name': u'llap_queue_capacity', }], 'configurations': {'capacity-scheduler': {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }, 'hive-interactive-env': {'properties': {'enable_hive_interactive': 'true', 'llap_queue_capacity': '60', }, }, 'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', 'hive.server2.tez.sessions.per.default.queue': '1', 'hive.tez.container.size': '341', }, }, 'hive-env': {'properties': {'hive_user': 'hive', }, }, 'yarn-site': {'properties': {'yarn.scheduler.minimum-allocation-mb': '682', 'yarn.nodemanager.resource.memory-mb': '24576', 'yarn.nodemanager.resource.cpu-vcores': '2', }, }, 'tez-interactive-site': {'properties': {'tez.am.resource.memory.mb': '341', }, }, }, }
    expected_capacity_scheduler_llap_queue_size_20 = {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=80\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=80\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=20\nyarn.scheduler.capacity.root.llap.capacity=20\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }
    expected_capacity_scheduler_llap_queue_size_40 = {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=60\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=60\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=RUNNING\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=40\nyarn.scheduler.capacity.root.llap.capacity=40\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }
    expected_capacity_scheduler_llap_Stopped_size_0 = {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.queues=default,llap\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.queue-mappings-override.enable=false\nyarn.scheduler.capacity.root.llap.user-limit-factor=1\nyarn.scheduler.capacity.root.llap.state=STOPPED\nyarn.scheduler.capacity.root.llap.ordering-policy=fifo\nyarn.scheduler.capacity.root.llap.minimum-user-limit-percent=100\nyarn.scheduler.capacity.root.llap.maximum-capacity=0\nyarn.scheduler.capacity.root.llap.capacity=0\nyarn.scheduler.capacity.root.llap.acl_submit_applications=hive\nyarn.scheduler.capacity.root.llap.acl_administer_queue=hive\nyarn.scheduler.capacity.root.llap.maximum-am-resource-percent=1', }, }
    expected_capacity_scheduler_with_default_queue_only = {'properties': {'capacity-scheduler': 'yarn.scheduler.capacity.root.accessible-node-labels=*\nyarn.scheduler.capacity.maximum-am-resource-percent=1\nyarn.scheduler.capacity.root.capacity=100\nyarn.scheduler.capacity.root.default.state=RUNNING\nyarn.scheduler.capacity.node-locality-delay=40\nyarn.scheduler.capacity.root.queues=default\nyarn.scheduler.capacity.maximum-applications=10000\nyarn.scheduler.capacity.root.default.user-limit-factor=1\nyarn.scheduler.capacity.root.acl_administer_queue=*\nyarn.scheduler.capacity.root.default.acl_submit_applications=*\nyarn.scheduler.capacity.root.default.capacity=100\nyarn.scheduler.capacity.root.default.maximum-capacity=100\nyarn.scheduler.capacity.queue-mappings-override.enable=false\n', }, }
    expected_capacity_scheduler_empty = {'properties': {}, }
    expected_hive_interactive_site_llap = {'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'llap', }, 'property_attributes': {'hive.llap.daemon.queue.name': {'entries': [{'value': 'default', 'label': 'default', }, {'value': 'llap', 'label': 'llap', }], }, }, }, }
    expected_hive_interactive_site_default = {'hive-interactive-site': {'properties': {'hive.llap.daemon.queue.name': 'default', }, 'property_attributes': {'hive.llap.daemon.queue.name': {'entries': [{'value': 'default', 'label': 'default', }], }, }, }, }
    expected_hive_interactive_site_empty = {'hive-interactive-site': {'properties': {}, }, }
    expected_hive_interactive_env_empty = {'hive-interactive-env': {'properties': {}, }, }
    expected_llap_queue_capacity_20 = '20'
    expected_llap_queue_capacity_40 = '40'
    expected_visibility_false = {'visible': 'false', }
    expected_visibility_true = {'visible': 'true', }
    expected_llap_queue_attributes_min_25_visible_true = {'minimum': '25', 'visible': 'true', }
    expected_llap_queue_attributes_min_21_visible_true = {'minimum': '21', 'visible': 'true', }
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_1, hosts)
    print '\n\n\n\n conf = ', configurations
    self.assertEquals(configurations['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'])
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'])
    self.assertEquals(configurations['hive-interactive-env']['properties']['llap_queue_capacity'], expected_llap_queue_capacity_20)
    cap_sched_output_dict = convertToDict(configurations['capacity-scheduler']['properties']['capacity-scheduler'])
    cap_sched_expected_dict = convertToDict(expected_capacity_scheduler_llap_queue_size_20['properties']['capacity-scheduler'])
    self.assertEqual(cap_sched_output_dict, cap_sched_expected_dict)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_3, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'])
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'])
    self.assertTrue(('llap_queue_capacity' not in configurations['hive-interactive-env']['properties']))
    cap_sched_output_dict = convertToDict(configurations['capacity-scheduler']['properties']['capacity-scheduler'])
    cap_sched_expected_dict = convertToDict(expected_capacity_scheduler_llap_queue_size_40['properties']['capacity-scheduler'])
    self.assertEqual(cap_sched_output_dict, cap_sched_expected_dict)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_10, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'])
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'])
    self.assertEquals(configurations['hive-interactive-env']['properties']['llap_queue_capacity'], expected_llap_queue_capacity_20)
    cap_sched_output_dict = convertToDict(configurations['capacity-scheduler']['properties']['capacity-scheduler'])
    cap_sched_expected_dict = convertToDict(expected_capacity_scheduler_llap_queue_size_20['properties']['capacity-scheduler'])
    self.assertEqual(cap_sched_output_dict, cap_sched_expected_dict)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_11, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'])
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'])
    self.assertTrue(('llap_queue_capacity' not in configurations['hive-interactive-env']['properties']))
    cap_sched_output_dict = convertToDict(configurations['capacity-scheduler']['properties']['capacity-scheduler'])
    cap_sched_expected_dict = convertToDict(expected_capacity_scheduler_llap_queue_size_40['properties']['capacity-scheduler'])
    self.assertEqual(cap_sched_output_dict, cap_sched_expected_dict)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_11, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'])
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_llap['hive-interactive-site']['property_attributes']['hive.llap.daemon.queue.name'])
    self.assertTrue(('llap_queue_capacity' not in configurations['hive-interactive-env']['properties']))
    cap_sched_output_dict = convertToDict(configurations['capacity-scheduler']['properties']['capacity-scheduler'])
    cap_sched_expected_dict = convertToDict(expected_capacity_scheduler_llap_queue_size_40['properties']['capacity-scheduler'])
    self.assertEqual(cap_sched_output_dict, cap_sched_expected_dict)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_2, hosts)
    self.assertTrue(('hive.llap.daemon.queue.name' not in configurations['hive-interactive-site']['properties']))
    self.assertTrue(('property_attributes' not in configurations['hive-interactive-site']))
    self.assertTrue(('hive-interactive-env' not in configurations))
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_4, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'], expected_hive_interactive_site_default['hive-interactive-site']['properties']['hive.llap.daemon.queue.name'])
    self.assertFalse(('property_attributes' in configurations['hive-interactive-site']))
    self.assertFalse(('hive-interactive-env' in configurations))
    cap_sched_output_dict = convertToDict(configurations['capacity-scheduler']['properties']['capacity-scheduler'])
    cap_sched_expected_dict = convertToDict(expected_capacity_scheduler_llap_Stopped_size_0['properties']['capacity-scheduler'])
    self.assertEqual(cap_sched_output_dict, cap_sched_expected_dict)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_6, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertFalse(('hive-interactive-env' in configurations))
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_12, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertFalse(('hive-interactive-env' in configurations))
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_9, hosts)
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertFalse(('hive-interactive-env' in configurations))
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_7, hosts)
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertFalse(('hive-interactive-env' in configurations))
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_8, hosts)
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertFalse(('hive-interactive-env' in configurations))
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    configurations = {}
    print '\n\n\n\n\n\n\n\n\n\n\n'
    yarn_cont_mb_attributes = {'minimum': '682', 'maximum': '682', }
    llap_io_mem_size_attributes = {'minimum': '0', 'maximum': '341', }
    llap_num_executors_attributes = {'minimum': '1', 'maximum': '1', }
    num_llap_nodes_attributes = {'minimum': '1', 'maximum': '1', }
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_13, hosts)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.yarn.container.mb'], '682')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.yarn.container.mb'], yarn_cont_mb_attributes)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.num.executors'], '1')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.num.executors'], llap_num_executors_attributes)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.io.memory.size'], '341')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.io.memory.size'], llap_io_mem_size_attributes)
    self.assertEqual(configurations['hive-interactive-env']['properties']['num_llap_nodes'], '1')
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['num_llap_nodes'], num_llap_nodes_attributes)
    self.assertEqual(configurations['hive-interactive-env']['properties']['llap_heap_size'], '272')
    self.assertEqual(configurations['hive-interactive-env']['properties']['slider_am_container_mb'], '341')
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['llap_queue_capacity'], expected_llap_queue_attributes_min_25_visible_true)
    configurations = {}
    yarn_cont_mb_attributes = {'minimum': '682', 'maximum': '682', }
    llap_io_mem_size_attributes = {'minimum': '0', 'maximum': '341', }
    llap_num_executors_attributes = {'minimum': '1', 'maximum': '1', }
    num_llap_nodes_attributes = {'minimum': '1', 'maximum': '1', }
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_16, hosts)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.yarn.container.mb'], '682')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.yarn.container.mb'], yarn_cont_mb_attributes)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.num.executors'], '1')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.num.executors'], llap_num_executors_attributes)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.io.memory.size'], '341')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.io.memory.size'], llap_io_mem_size_attributes)
    self.assertEqual(configurations['hive-interactive-env']['properties']['num_llap_nodes'], '1')
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['num_llap_nodes'], num_llap_nodes_attributes)
    self.assertEqual(configurations['hive-interactive-env']['properties']['llap_heap_size'], '272')
    self.assertEqual(configurations['hive-interactive-env']['properties']['slider_am_container_mb'], '341')
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['llap_queue_capacity'], expected_llap_queue_attributes_min_25_visible_true)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_17, hosts)
    cap_sched_output_dict = convertToDict(configurations['capacity-scheduler']['properties']['capacity-scheduler'])
    cap_sched_expected_dict = convertToDict(expected_capacity_scheduler_llap_Stopped_size_0['properties']['capacity-scheduler'])
    self.assertEqual(cap_sched_output_dict, cap_sched_expected_dict)
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_default['hive-interactive-site']['properties'])
    self.assertTrue(('hive-interactive-env' not in configurations))
    self.assertTrue(('property_attributes' not in configurations))
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_18, hosts)
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    self.assertTrue(('hive-interactive-env' not in configurations))
    self.assertTrue(('property_attributes' not in configurations))
    configurations = {}
    yarn_cont_mb_visibility = {'minimum': '682', 'maximum': '682', }
    llap_io_mem_size_visibility = {'minimum': '0', 'maximum': '341', }
    llap_num_executors_visibility = {'minimum': '1', 'maximum': '1', }
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_19, hosts)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.yarn.container.mb'], '682')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.yarn.container.mb'], yarn_cont_mb_visibility)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.num.executors'], '1')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.num.executors'], llap_num_executors_visibility)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.io.memory.size'], '341')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.io.memory.size'], llap_io_mem_size_visibility)
    self.assertTrue(('num_llap_nodes' not in configurations['hive-interactive-env']['properties']))
    self.assertEqual(configurations['hive-interactive-env']['properties']['llap_heap_size'], '272')
    self.assertEqual(configurations['hive-interactive-env']['properties']['slider_am_container_mb'], '341')
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['llap_queue_capacity'], expected_llap_queue_attributes_min_25_visible_true)
    configurations = {}
    yarn_cont_mb_visibility = {'minimum': '12958', 'maximum': '12958', }
    llap_io_mem_size_visibility = {'minimum': '0', 'maximum': '12617', }
    llap_num_executors_visibility = {'minimum': '1', 'maximum': '8', }
    num_llap_nodes_visibility = {'minimum': '1', 'maximum': '1', }
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_20, hosts)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.yarn.container.mb'], '12958')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.yarn.container.mb'], yarn_cont_mb_visibility)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.daemon.num.executors'], '2')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.daemon.num.executors'], llap_num_executors_visibility)
    self.assertEqual(configurations['hive-interactive-site']['properties']['hive.llap.io.memory.size'], '12276')
    self.assertEquals(configurations['hive-interactive-site']['property_attributes']['hive.llap.io.memory.size'], llap_io_mem_size_visibility)
    self.assertEqual(configurations['hive-interactive-env']['properties']['num_llap_nodes'], '1')
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['num_llap_nodes'], num_llap_nodes_visibility)
    self.assertEqual(configurations['hive-interactive-env']['properties']['llap_heap_size'], '545')
    self.assertEqual(configurations['hive-interactive-env']['properties']['slider_am_container_mb'], '682')
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['llap_queue_capacity'], expected_llap_queue_attributes_min_21_visible_true)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_14, hosts)
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    self.assertEquals(configurations['hive-interactive-env']['properties'], expected_hive_interactive_env_empty['hive-interactive-env']['properties'])
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['llap_queue_capacity'], expected_visibility_true)
    configurations = {}
    self.stackAdvisor.recommendYARNConfigurations(configurations, clusterData, services_15, hosts)
    self.assertEquals(configurations['capacity-scheduler']['properties'], expected_capacity_scheduler_empty['properties'])
    self.assertEquals(configurations['hive-interactive-site']['properties'], expected_hive_interactive_site_empty['hive-interactive-site']['properties'])
    self.assertEquals(configurations['hive-interactive-env']['properties'], expected_hive_interactive_env_empty['hive-interactive-env']['properties'])
    self.assertEquals(configurations['hive-interactive-env']['property_attributes']['llap_queue_capacity'], expected_visibility_false)
