{
  if (!super.isApplicable(request)) {
    return false;
  }
  final Cluster cluster=clustersProvider.get().getCluster(request.getClusterName());
  Map<String,Service> services=cluster.getServices();
  if (!services.containsKey("MAPREDUCE2")) {
    return false;
  }
  for (  MinimumApplicableStackVersion minimumStackVersion : MinimumApplicableStackVersion.values()) {
    String stackName=cluster.getCurrentStackVersion().getStackName();
    if (minimumStackVersion.getStackName().equals(stackName)) {
      String targetVersion=request.getTargetStackId().getStackVersion();
      String sourceVersion=request.getSourceStackId().getStackVersion();
      return VersionUtils.compareVersions(targetVersion,minimumStackVersion.getStackVersion()) >= 0 && VersionUtils.compareVersions(sourceVersion,minimumStackVersion.getStackVersion()) >= 0;
    }
  }
  return true;
}
