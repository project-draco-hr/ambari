{
  Collection<HostRoleCommandEntity> tasks=entity.getHostRoleCommands();
  Map<HostRoleStatus,Integer> taskStatusCounts=calculateTaskStatusCounts(tasks);
  StageStatus currentStatus=calculateSummaryStatus(taskStatusCounts,tasks.size());
  if (!currentStatus.isValidManualTransition(desiredStatus)) {
    throw new IllegalArgumentException("Can not transition a stage from " + currentStatus + " to "+ desiredStatus);
  }
}
