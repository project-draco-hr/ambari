{
  File file=File.createTempFile("ambari_ut_",".dat");
  final String principal1="principal1@REALM.COM";
  final String principal2="principal2@REALM.COM";
  try {
    Assert.assertTrue(handler.createKeytabFile(new HashMap<String,String>(){
{
        put(principal1,handler.createSecurePassword());
      }
    }
,file));
    Keytab keytab=Keytab.read(file);
    Assert.assertNotNull(keytab);
    List<KeytabEntry> entries=keytab.getEntries();
    Assert.assertNotNull(entries);
    Assert.assertFalse(entries.isEmpty());
    for (    KeytabEntry entry : entries) {
      Assert.assertEquals(principal1,entry.getPrincipalName());
    }
    Assert.assertTrue(handler.createKeytabFile(new HashMap<String,String>(){
{
        put(principal1,handler.createSecurePassword());
        put(principal2,handler.createSecurePassword());
      }
    }
,file));
    keytab=Keytab.read(file);
    Assert.assertNotNull(keytab);
    entries=keytab.getEntries();
    Assert.assertNotNull(entries);
    Assert.assertFalse(entries.isEmpty());
  }
  finally {
    if (!file.delete()) {
      file.deleteOnExit();
    }
  }
}
