{
  File file=File.createTempFile("ambari_ut_",".dat");
  final String principal="principal@REALM.COM";
  try {
    Assert.assertTrue(handler.createKeytabFile(principal,handler.createSecurePassword(),file));
    FileInputStream fis=new FileInputStream(file);
    byte[] data=new byte[(int)file.length()];
    Assert.assertEquals(data.length,fis.read(data));
    fis.close();
    File f=handler.createKeytabFile(Base64.encodeBase64String(data));
    try {
      Keytab keytab=Keytab.read(f);
      Assert.assertNotNull(keytab);
      List<KeytabEntry> entries=keytab.getEntries();
      Assert.assertNotNull(entries);
      Assert.assertFalse(entries.isEmpty());
      for (      KeytabEntry entry : entries) {
        Assert.assertEquals(principal,entry.getPrincipalName());
      }
    }
  finally {
      if (!f.delete()) {
        f.deleteOnExit();
      }
    }
  }
  finally {
    if (!file.delete()) {
      file.deleteOnExit();
    }
  }
}
