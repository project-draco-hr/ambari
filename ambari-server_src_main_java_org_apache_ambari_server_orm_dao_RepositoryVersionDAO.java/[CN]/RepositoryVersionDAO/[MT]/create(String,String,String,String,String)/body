{
  if (stack == null || stack.isEmpty() || version == null || version.isEmpty() || displayName == null || displayName.isEmpty()) {
    throw new AmbariException("At least one of the required properties is null or empty");
  }
  RepositoryVersionEntity existingByDisplayName=this.findByDisplayName(displayName);
  if (existingByDisplayName != null) {
    throw new AmbariException("Repository version with display name '" + displayName + "' already exists");
  }
  RepositoryVersionEntity existingByStackAndVersion=this.findByStackAndVersion(stack,version);
  if (existingByStackAndVersion != null) {
    throw new AmbariException("Repository version for stack " + stack + " and version "+ version+ " already exists");
  }
  RepositoryVersionEntity newEntity=new RepositoryVersionEntity(stack,version,displayName,upgradePack,operatingSystems);
  this.create(newEntity);
  return newEntity;
}
