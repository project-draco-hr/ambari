def service_check(self, env):
    import params
    env.set_params(params)
    kafka_config = self.read_kafka_config()
    create_topic_cmd_created_output = 'Created topic "ambari_kafka_service_check".'
    create_topic_cmd_exists_output = 'Topic "ambari_kafka_service_check" already exists.'
    source_cmd = format('source {conf_dir}/kafka-env.sh')
    create_topic_cmd = format('{kafka_home}/bin/kafka-topics.sh --zookeeper {kafka_config[zookeeper.connect]} --create --topic ambari_kafka_service_check --partitions 1 --replication-factor 1')
    print 'Running kafka create topic command'
    Execute(format("{source_cmd} ; {create_topic_cmd} | grep '{create_topic_cmd_created_output}\\|{create_topic_cmd_exists_output}'"), logoutput=True)
