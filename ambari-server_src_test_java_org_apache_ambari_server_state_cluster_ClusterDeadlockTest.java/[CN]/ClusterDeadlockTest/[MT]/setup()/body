{
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  injector.injectMembers(this);
  clusters.addCluster("c1");
  cluster=clusters.getCluster("c1");
  cluster.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId.getStackName(),stackId.getStackVersion());
  cluster.createClusterVersion(stackId.getStackName(),stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  metaInfo.init();
  for (int i=0; i < NUMBER_OF_HOSTS; i++) {
    String hostName="c64-" + i;
    hostNames.add(hostName);
    clusters.addHost(hostName);
    setOsFamily(clusters.getHost(hostName),"redhat","6.4");
    clusters.getHost(hostName).persist();
    clusters.mapHostToCluster(hostName,"c1");
  }
  Service service=installService("HDFS");
  addServiceComponent(service,"NAMENODE");
  addServiceComponent(service,"DATANODE");
}
