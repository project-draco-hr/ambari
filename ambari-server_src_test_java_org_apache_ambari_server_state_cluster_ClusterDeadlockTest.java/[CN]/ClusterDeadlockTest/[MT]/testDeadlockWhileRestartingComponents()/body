{
  List<ServiceComponentHost> serviceComponentHosts=new ArrayList<ServiceComponentHost>();
  for (  String hostName : hostNames) {
    serviceComponentHosts.add(createNewServiceComponentHost("HDFS","NAMENODE",hostName));
    serviceComponentHosts.add(createNewServiceComponentHost("HDFS","DATANODE",hostName));
  }
  ((ClusterImpl)cluster).loadServiceHostComponents();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < NUMBER_OF_THREADS; i++) {
    ClusterReaderThread clusterReaderThread=new ClusterReaderThread();
    ClusterWriterThread clusterWriterThread=new ClusterWriterThread();
    ServiceComponentRestartThread schWriterThread=new ServiceComponentRestartThread(serviceComponentHosts);
    threads.add(clusterReaderThread);
    threads.add(clusterWriterThread);
    threads.add(schWriterThread);
    clusterReaderThread.start();
    clusterWriterThread.start();
    schWriterThread.start();
  }
  for (  Thread thread : threads) {
    thread.join();
  }
}
