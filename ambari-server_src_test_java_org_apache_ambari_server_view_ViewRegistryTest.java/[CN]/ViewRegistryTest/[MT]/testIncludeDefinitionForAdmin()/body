{
  ViewRegistry registry=ViewRegistry.getInstance();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  AmbariGrantedAuthority adminAuthority=createNiceMock(AmbariGrantedAuthority.class);
  PrivilegeEntity privilegeEntity=createNiceMock(PrivilegeEntity.class);
  PermissionEntity permissionEntity=createNiceMock(PermissionEntity.class);
  Collection<GrantedAuthority> authorities=new ArrayList<GrantedAuthority>();
  authorities.add(adminAuthority);
  securityHelper.getCurrentAuthorities();
  EasyMock.expectLastCall().andReturn(authorities);
  expect(adminAuthority.getPrivilegeEntity()).andReturn(privilegeEntity);
  expect(privilegeEntity.getPermission()).andReturn(permissionEntity);
  expect(permissionEntity.getId()).andReturn(PermissionEntity.AMBARI_ADMINISTRATOR_PERMISSION);
  replay(securityHelper,adminAuthority,privilegeEntity,permissionEntity,configuration);
  Assert.assertTrue(registry.includeDefinition(viewEntity));
  verify(securityHelper,adminAuthority,privilegeEntity,permissionEntity,configuration);
}
