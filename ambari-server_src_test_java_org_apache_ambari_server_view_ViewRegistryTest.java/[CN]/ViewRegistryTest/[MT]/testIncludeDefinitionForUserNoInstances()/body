{
  ViewRegistry viewRegistry=getRegistry();
  ViewEntity viewEntity=createNiceMock(ViewEntity.class);
  Collection<GrantedAuthority> authorities=new ArrayList<GrantedAuthority>();
  Collection<ViewInstanceEntity> instances=new ArrayList<ViewInstanceEntity>();
  securityHelper.getCurrentAuthorities();
  EasyMock.expectLastCall().andReturn(authorities);
  expect(viewEntity.getInstances()).andReturn(instances);
  expect(configuration.getApiAuthentication()).andReturn(true);
  replay(securityHelper,viewEntity,configuration);
  Assert.assertFalse(viewRegistry.includeDefinition(viewEntity));
  verify(securityHelper,viewEntity,configuration);
}
