{
  int triesCount=0;
  String newFilePath;
  boolean isUnallocatedFilenameFound;
  try {
    do {
      newFilePath=String.format(fullPathAndFilename + "%s" + extension,(triesCount == 0) ? "" : "_" + triesCount);
      LOG.debug("Trying to find free filename " + newFilePath);
      isUnallocatedFilenameFound=!hdfs.exists(newFilePath);
      if (isUnallocatedFilenameFound) {
        LOG.debug("File created successfully!");
      }
      triesCount+=1;
    }
 while (!isUnallocatedFilenameFound);
  }
 catch (  IOException e) {
    throw new ServiceFormattedException("Error in creation: " + e.toString(),e);
  }
catch (  InterruptedException e) {
    throw new ServiceFormattedException("Error in creation: " + e.toString(),e);
  }
  return newFilePath;
}
