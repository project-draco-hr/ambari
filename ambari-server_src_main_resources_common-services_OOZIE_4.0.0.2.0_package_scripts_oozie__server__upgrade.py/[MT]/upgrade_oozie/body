def upgrade_oozie():
    '\n  Performs the upgrade of the oozie WAR file and database.\n  :return:\n  '
    import params
    if params.security_enabled:
        oozie_principal_with_host = params.oozie_principal.replace('_HOST', params.hostname)
        command = format('{kinit_path_local} -kt {oozie_keytab} {oozie_principal_with_host}')
        Execute(command, user=params.oozie_user)
    command = format('hdfs dfs -chown oozie:hadoop {oozie_hdfs_user_dir}/share')
    Execute(command, user=params.oozie_user)
    command = format('hdfs dfs -chmod -R 755 {oozie_hdfs_user_dir}/share')
    Execute(command, user=params.oozie_user)
    command = format('{oozie_home}/bin/ooziedb.sh upgrade -run')
    Execute(command, user=params.oozie_user)
    command = format('{oozie_setup_sh} prepare-war {oozie_secure} -d {oozie_libext_customer_dir}')
    (return_code, oozie_output) = shell.call(command)
    if ((return_code != 0) or ('New Oozie WAR file with added' not in oozie_output)):
        message = 'Unexpected Oozie WAR preparation output {0}'.format(oozie_output)
        Logger.error(message)
        raise Fail(message)
    command = format('{oozie_setup_sh} sharelib create -fs {fs_root}')
    Execute(command, user=params.oozie_user)
