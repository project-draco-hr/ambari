{
  Stack flattened=flattener.flattenStack(cluster.getStackName(),Integer.parseInt(cluster.getStackRevision()));
  for (  Component component : flattened.getComponents()) {
    ComponentPlugin plugin=componentPluginFactory.getPlugin(component.getDefinition());
    ComponentInfo info=new ComponentInfo(plugin);
    components.put(component.getName(),info);
    for (    Role role : component.getRoles()) {
      info.roles.put(role.getName(),new RoleInfo(role.getConfiguration()));
    }
  }
}
