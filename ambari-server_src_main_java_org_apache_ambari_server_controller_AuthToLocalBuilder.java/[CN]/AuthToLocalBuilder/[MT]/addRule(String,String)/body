{
  if ((principal != null) && (localUsername != null) && !principal.isEmpty()&& !localUsername.isEmpty()) {
    Principal p=new Principal(principal);
    if (p.getRealm() == null) {
      throw new IllegalArgumentException("Attempted to add a rule for a principal with no realm: " + principal);
    }
    Rule rule=createHostAgnosticRule(p,localUsername);
    setRules.add(rule);
    addDefaultRealmRule(rule.getPrincipal());
  }
}
