{
  Principal thatPrincipal=other.getPrincipal();
  if (expectedComponentCount != other.getExpectedComponentCount()) {
    return rule.compareTo(other.rule);
  }
 else {
    if (matchComponentCount != other.getMatchComponentCount()) {
      return other.getMatchComponentCount() - matchComponentCount;
    }
 else {
      if (principal.equals(thatPrincipal)) {
        return rule.compareTo(other.rule);
      }
 else {
        String realm=principal.getRealm();
        String thatRealm=thatPrincipal.getRealm();
        if (realm == null ? thatRealm != null : !realm.equals(thatRealm)) {
          if (realm != null && realm.equals(".*")) {
            return 1;
          }
 else           if (thatRealm != null && thatRealm.equals(".*")) {
            return -1;
          }
        }
        String component1=principal.getComponent(1);
        String thatComponent1=thatPrincipal.getComponent(1);
        if (component1 != null && component1.equals(".*")) {
          return 1;
        }
 else         if (thatComponent1 != null && thatComponent1.equals(".*")) {
          return -1;
        }
 else {
          return rule.compareTo(other.rule);
        }
      }
    }
  }
}
