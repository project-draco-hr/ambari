@patch.object(StackVersionsFileHandler, 'read_stack_version')
def test_heartbeat_with_status(self, read_stack_version_method):
    actionQueue = ActionQueue(AmbariConfig.AmbariConfig().getConfig())
    read_stack_version_method.return_value = '1.3.0'
    heartbeat = Heartbeat(actionQueue)
    statusCommand = {'serviceName': 'HDFS', 'commandType': 'STATUS_COMMAND', 'clusterName': '', 'componentName': 'DATANODE', 'configurations': {'global': {}, }, }
    actionQueue.put(statusCommand)
    actionQueue.start()
    time.sleep(0.1)
    actionQueue.stop()
    actionQueue.join()
    result = heartbeat.build(101)
    self.assertEquals((len(result['componentStatus']) > 0), True, 'Heartbeat should contain status of HDFS components')
