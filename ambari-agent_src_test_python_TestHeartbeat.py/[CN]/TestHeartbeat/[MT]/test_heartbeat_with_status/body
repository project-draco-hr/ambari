def test_heartbeat_with_status(self):
    actionQueue = ActionQueue(AmbariConfig.AmbariConfig().getConfig())
    heartbeat = Heartbeat(actionQueue)
    statusCommand = {'serviceName': 'HDFS', 'commandType': 'STATUS_COMMAND', 'clusterName': '', 'componentName': 'DATANODE', 'configurations': {'global': {}, }, }
    actionQueue.put(statusCommand)
    actionQueue.start()
    time.sleep(0.1)
    actionQueue.stop()
    actionQueue.join()
    result = heartbeat.build(101)
    self.assertEquals((len(result['componentStatus']) > 0), True, 'Heartbeat should contain status of HDFS components')
