{
  if (null != pc.preTasks && pc.preTasks.size() > 0) {
    StageWrapper stage=new StageWrapper(StageWrapper.Type.RU_TASKS,getStageText("Preparing",pc.name,hosts),new TaskWrapper(service,pc.name,hosts,pc.preTasks));
    stages.add(stage);
  }
  if (null != pc.tasks && 1 == pc.tasks.size()) {
    Task t=pc.tasks.get(0);
    if (RestartTask.class.isInstance(t)) {
      for (      String hostName : hosts) {
        StageWrapper stage=new StageWrapper(StageWrapper.Type.RESTART,getStageText("Restarting",pc.name,Collections.singleton(hostName)),new TaskWrapper(service,pc.name,Collections.singleton(hostName),t));
        stages.add(stage);
      }
    }
  }
  if (null != pc.postTasks && pc.postTasks.size() > 0) {
    StageWrapper stage=new StageWrapper(StageWrapper.Type.RU_TASKS,getStageText("Completing",pc.name,hosts),new TaskWrapper(service,pc.name,hosts,pc.postTasks));
    stages.add(stage);
  }
  serviceChecks.add(service);
}
