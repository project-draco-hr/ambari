{
  if (availableServices.isEmpty()) {
    return Collections.emptyList();
  }
  if (null == availableMap) {
    Map<String,ManifestService> manifests=buildManifest();
    availableMap=new HashMap<>();
    for (    AvailableServiceReference ref : availableServices) {
      ManifestService ms=manifests.get(ref.serviceIdReference);
      ServiceInfo service=stack.getService(ms.serviceName);
      if (!availableMap.containsKey(ms.serviceName)) {
        String display=(null == service) ? ms.serviceName : service.getDisplayName();
        availableMap.put(ms.serviceName,new AvailableService(ms.serviceName,display));
      }
      AvailableService as=availableMap.get(ms.serviceName);
      as.getVersions().add(new AvailableVersion(ms.version,ms.versionId,buildComponents(service,ref.components)));
    }
  }
  return availableMap.values();
}
