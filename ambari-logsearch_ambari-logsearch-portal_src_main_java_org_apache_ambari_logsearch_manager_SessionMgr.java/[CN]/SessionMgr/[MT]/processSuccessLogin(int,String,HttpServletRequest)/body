{
  boolean newSessionCreation=true;
  UserSessionInfo userSession=null;
  LogsearchSecurityContext context=LogsearchContextHolder.getSecurityContext();
  if (context != null) {
    userSession=context.getUserSession();
  }
  Authentication authentication=SecurityContextHolder.getContext().getAuthentication();
  WebAuthenticationDetails details=(WebAuthenticationDetails)authentication.getDetails();
  String currentLoginId=authentication.getName();
  if (userSession != null) {
    if (validateUserSession(userSession,currentLoginId)) {
      newSessionCreation=false;
    }
  }
  if (newSessionCreation) {
    userSession=new UserSessionInfo();
    User user=new User();
    user.setUsername(currentLoginId);
    userSession.setUser(user);
    if (details != null) {
      logger.info("Login Success: loginId=" + currentLoginId + ", sessionId="+ details.getSessionId()+ ", requestId="+ details.getRemoteAddress());
    }
 else {
      logger.info("Login Success: loginId=" + currentLoginId + ", msaSessionId="+ ", details is null");
    }
  }
  return userSession;
}
