{
  for (  HostRoleCommand hostRoleCommand : hostRoleCommands) {
    if (hostRoleCommand.getStatus() == HostRoleStatus.QUEUED) {
      actionQueue.dequeue(hostRoleCommand.getHostName(),hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getCommandId());
    }
    if (hostRoleCommand.getStatus() == HostRoleStatus.QUEUED || hostRoleCommand.getStatus() == HostRoleStatus.IN_PROGRESS) {
      CancelCommand cancelCommand=new CancelCommand();
      cancelCommand.setTargetTaskId(hostRoleCommand.getTaskId());
      cancelCommand.setReason(reason);
      actionQueue.enqueue(hostRoleCommand.getHostName(),cancelCommand);
    }
    if (hostRoleCommand.getStatus().isHoldingState()) {
      db.abortHostRole(hostRoleCommand.getHostName(),hostRoleCommand.getRequestId(),hostRoleCommand.getStageId(),hostRoleCommand.getRole().name());
    }
    if (hostRoleCommand.getRoleCommand().equals(RoleCommand.ACTIONEXECUTE)) {
      String clusterName=hostRoleCommand.getExecutionCommandWrapper().getExecutionCommand().getClusterName();
      try {
        Long clusterId=clusterName != null ? fsmObject.getCluster(clusterName).getClusterId() : null;
        ActionFinalReportReceivedEvent event=new ActionFinalReportReceivedEvent(clusterId,hostRoleCommand.getHostName(),null,hostRoleCommand.getRole().name());
        ambariEventPublisher.publish(event);
      }
 catch (      AmbariException e) {
        LOG.error(String.format("Can not get cluster %s",clusterName),e);
      }
    }
  }
}
