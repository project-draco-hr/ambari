{
  for (  String host : hrcMap.keySet()) {
    HostRoleCommand hrc=hrcMap.get(host);
    long now=System.currentTimeMillis();
    if (now > hrc.getExpiryTime()) {
      if (now > hrc.getStartTime() + actionTimeout * maxAttempts) {
        db.timeoutHostRole(stage.getRequestId(),stage.getStageId(),hrc.getRole());
      }
 else {
        rescheduleHostRole(stage,hrc);
      }
    }
  }
}
