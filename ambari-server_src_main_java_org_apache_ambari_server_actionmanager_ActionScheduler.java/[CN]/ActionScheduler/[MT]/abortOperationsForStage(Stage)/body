{
  long now=System.currentTimeMillis();
  for (  String hostName : stage.getHosts()) {
    List<ExecutionCommandWrapper> commandWrappers=stage.getExecutionCommands(hostName);
    for (    ExecutionCommandWrapper wrapper : commandWrappers) {
      ExecutionCommand c=wrapper.getExecutionCommand();
      transitionToFailedState(stage.getClusterName(),c.getServiceName(),c.getRole(),hostName,now,true);
    }
  }
  db.abortOperation(stage.getRequestId());
}
