def run(self):
    self.locate()
    while True:
        try:
            self.lock.acquire()
            if (self.safeMode == True):
                time.sleep(timeout)
                zookeeper.close(self.zh)
                conn_cv.acquire()
                self.zh = zookeeper.init(self.zkservers, self.conn_callback, session_time)
                conn_cv.wait()
                conn_cv.release()
                self.locate()
            if (self.safeMode == False):
                if (zookeeper.OK != zookeeper.aget_children(self.zh, self.actionNode, self.queue_watcher, None)):
                    logger.error((('Fail to monitor action queue for: ' + self.actionNode) + ', activate safe mode.'))
                    self.safeMode = True
        except Exception as err:
            logger.exception(err)
