{
  if (hdfsCopyThread != null) {
    logger.info("waiting till copy all local files to hdfs.......");
    while (localReadyFiles.size() != 0) {
    }
    logger.info("calling interrupt method for hdfsCopyThread to stop it.");
    hdfsCopyThread.interrupt();
    LogfeederHDFSUtil.INSTANCE.closeFileSystem(fileSystem);
  }
}
