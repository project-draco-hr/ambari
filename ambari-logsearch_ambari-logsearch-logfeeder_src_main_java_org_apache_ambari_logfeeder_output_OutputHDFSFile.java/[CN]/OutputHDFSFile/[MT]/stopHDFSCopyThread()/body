{
  if (hdfsCopyThread != null) {
    logger.info("waiting till copy all local files to hdfs.......");
    while (!localReadyFiles.isEmpty()) {
      try {
        Thread.sleep(1000);
      }
 catch (      InterruptedException e) {
        logger.error(e.getLocalizedMessage(),e);
      }
      logger.debug("still waiting to copy all local files to hdfs.......");
    }
    logger.info("calling interrupt method for hdfsCopyThread to stop it.");
    try {
      hdfsCopyThread.interrupt();
    }
 catch (    SecurityException exception) {
      logger.error(" Current thread : '" + Thread.currentThread().getName() + "' does not have permission to interrupt the Thread: '"+ hdfsCopyThread.getName()+ "'");
    }
    LogfeederHDFSUtil.INSTANCE.closeFileSystem(fileSystem);
  }
}
