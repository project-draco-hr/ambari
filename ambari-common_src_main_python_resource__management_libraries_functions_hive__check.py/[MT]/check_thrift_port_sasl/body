def check_thrift_port_sasl(address, port, timeout=5, security_enabled=False):
    '\n  Hive thrift SASL port check\n  '
    mechanism = 'PLAIN'
    usr = 'ANONYMOUS'
    start_byte = 1
    ok_byte = 2
    bad_byte = 3
    error_byte = 4
    complete_byte = 5
    msg = bytearray()
    msg.append(start_byte)
    msg.append(0)
    msg.append(0)
    msg.append(0)
    msg.append(len(mechanism))
    for elem in mechanism:
        msg.append(ord(elem))
    msg.append(ok_byte)
    msg.append(0)
    msg.append(0)
    msg.append(0)
    msg.append(((len(usr) * 2) + 2))
    msg.append(0)
    for elem in usr:
        msg.append(ord(elem))
    msg.append(0)
    for elem in usr:
        msg.append(ord(elem))
    msg.append(complete_byte)
    msg.append(0)
    msg.append(0)
    msg.append(0)
    msg.append(0)
    is_service_socket_valid = False
    s = socket.socket()
    s.settimeout(timeout)
    try:
        try:
            s.connect((address, port))
            is_service_socket_valid = True
            if (not security_enabled):
                s.send(msg)
        except socket.error as e:
            pass
    finally:
        s.close()
        return is_service_socket_valid
