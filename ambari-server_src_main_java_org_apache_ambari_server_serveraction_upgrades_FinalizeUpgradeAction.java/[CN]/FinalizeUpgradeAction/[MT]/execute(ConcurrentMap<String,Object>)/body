{
  Map<String,String> commandParams=getExecutionCommand().getCommandParams();
  boolean isDowngrade=commandParams.containsKey("upgrade_direction") && "downgrade".equals(commandParams.get("upgrade_direction").toLowerCase());
  String version=commandParams.get("version");
  String clusterName=getExecutionCommand().getClusterName();
  if (isDowngrade) {
    return executeDowngrade(clusterName,version);
  }
 else {
    return executeUpgrade(clusterName,version);
  }
}
