@patch('resource_management.core.providers.system._ensure_metadata')
@patch.object(sudo, 'create_file')
@patch.object(sudo, 'path_exists')
@patch.object(sudo, 'path_isdir')
@patch.object(time, 'asctime')
def test_action_create_simple_xml_config(self, time_asctime_mock, os_path_isdir_mock, os_path_exists_mock, create_file_mock, ensure_mock):
    '\n    Tests if \'create\' action - creates new non existent xml file and write proper data\n    where configurations={"Some conf":"Some value"}\n    '
    os_path_isdir_mock.side_effect = [False, True]
    os_path_exists_mock.return_value = False
    time_asctime_mock.return_value = 'Wed 2014-02'
    with Environment('/') as env:
        XmlConfig('file.xml', conf_dir='/dir/conf', configurations={'property1': 'value1', }, configuration_attributes={'attr': {'property1': 'attr_value', }, })
    create_file_mock.assert_called_with('/dir/conf/file.xml', u'<!--Wed 2014-02-->\n    <configuration>\n    \n    <property>\n      <name>property1</name>\n      <value>value1</value>\n      <attr>attr_value</attr>\n    </property>\n    \n  </configuration>\n', encoding='UTF-8')
