{
  ViewEntity viewEntity=getDefinition(instanceEntity.getViewName());
  if (viewEntity != null) {
    String instanceName=instanceEntity.getName();
    String viewName=viewEntity.getCommonName();
    String version=viewEntity.getVersion();
    ViewInstanceEntity entity=getInstanceDefinition(viewName,version,instanceName);
    if (entity != null) {
      if (entity.isXmlDriven()) {
        throw new IllegalStateException("View instances defined via xml can't be updated through api requests");
      }
      if (LOG.isDebugEnabled()) {
        LOG.debug("Updating view instance " + viewName + "/"+ version+ "/"+ instanceName);
      }
      entity.setLabel(instanceEntity.getLabel());
      entity.setDescription(instanceEntity.getDescription());
      entity.setVisible(instanceEntity.isVisible());
      entity.setProperties(instanceEntity.getProperties());
      entity.setData(instanceEntity.getData());
      instanceEntity.validate(viewEntity);
      instanceDAO.merge(entity);
    }
  }
}
