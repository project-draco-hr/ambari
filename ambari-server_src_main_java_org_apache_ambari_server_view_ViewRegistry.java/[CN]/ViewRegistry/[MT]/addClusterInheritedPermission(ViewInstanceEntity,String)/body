{
  ResourceEntity resource=viewInstanceEntity.getResource();
  List<PrincipalEntity> principals=principalDAO.findByPrincipalType(principalType);
  if (principals.size() == 0) {
    LOG.error("Failed to find principal for principal type '{}'",principalType);
    return;
  }
  PrincipalEntity principal=principals.get(0);
  PermissionEntity permission=permissionDAO.findViewUsePermission();
  if (!privilegeDAO.exists(principal,resource,permission)) {
    PrivilegeEntity privilege=new PrivilegeEntity();
    privilege.setPrincipal(principal);
    privilege.setResource(resource);
    privilege.setPermission(permission);
    privilegeDAO.create(privilege);
  }
}
