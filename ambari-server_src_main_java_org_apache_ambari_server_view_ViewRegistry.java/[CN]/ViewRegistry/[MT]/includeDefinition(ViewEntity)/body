{
  ViewRegistry viewRegistry=ViewRegistry.getInstance();
  for (  GrantedAuthority grantedAuthority : securityHelper.getCurrentAuthorities()) {
    if (grantedAuthority instanceof AmbariGrantedAuthority) {
      AmbariGrantedAuthority authority=(AmbariGrantedAuthority)grantedAuthority;
      PrivilegeEntity privilegeEntity=authority.getPrivilegeEntity();
      Integer permissionId=privilegeEntity.getPermission().getId();
      if (permissionId.equals(PermissionEntity.AMBARI_ADMIN_PERMISSION)) {
        return true;
      }
    }
  }
  boolean allowed=false;
  for (  ViewInstanceEntity instanceEntity : definitionEntity.getInstances()) {
    allowed|=viewRegistry.checkPermission(instanceEntity,true);
  }
  return allowed;
}
