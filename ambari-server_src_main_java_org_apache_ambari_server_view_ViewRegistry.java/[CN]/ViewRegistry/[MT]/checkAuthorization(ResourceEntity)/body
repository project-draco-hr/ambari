{
  for (  GrantedAuthority grantedAuthority : securityHelper.getCurrentAuthorities()) {
    if (grantedAuthority instanceof AmbariGrantedAuthority) {
      AmbariGrantedAuthority authority=(AmbariGrantedAuthority)grantedAuthority;
      PrivilegeEntity privilegeEntity=authority.getPrivilegeEntity();
      Integer permissionId=privilegeEntity.getPermission().getId();
      if (permissionId.equals(PermissionEntity.AMBARI_ADMINISTRATOR_PERMISSION)) {
        return true;
      }
      if (resourceEntity != null) {
        if (privilegeEntity.getResource().equals(resourceEntity)) {
          if (permissionId.equals(PermissionEntity.VIEW_USER_PERMISSION)) {
            return true;
          }
        }
      }
    }
  }
  return false;
}
