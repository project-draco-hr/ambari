def wait_for_safemode_off(self, env):
    '\n    During NonRolling (aka Express Upgrade), after starting NameNode, which is still in safemode, and then starting\n    all of the DataNodes, we need for NameNode to receive all of the block reports and leave safemode.\n    '
    import params
    Logger.info('Wait to leafe safemode since must transition from ON to OFF.')
    try:
        hdfs_binary = self.get_hdfs_binary()
        is_namenode_safe_mode_off = format("{hdfs_binary} dfsadmin -fs {params.namenode_address} -safemode get | grep 'Safe mode is OFF'")
        Execute(is_namenode_safe_mode_off, tries=180, try_sleep=10, user=params.hdfs_user, logoutput=True)
    except Fail:
        Logger.error('NameNode is still in safemode, please be careful with commands that need safemode OFF.')
