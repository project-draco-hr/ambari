def stop(self, env, rolling_restart=False):
    import params
    env.set_params(params)
    if (rolling_restart and params.dfs_ha_enabled):
        if params.dfs_ha_automatic_failover_enabled:
            stop_zkfc_during_ru()
        else:
            raise Fail('Rolling Upgrade - dfs.ha.automatic-failover.enabled must be enabled to perform a rolling restart')
    namenode(action='stop', rolling_restart=rolling_restart, env=env)
