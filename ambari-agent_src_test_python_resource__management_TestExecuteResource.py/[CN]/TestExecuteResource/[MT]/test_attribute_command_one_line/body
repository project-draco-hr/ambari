@patch.object(subprocess, 'Popen')
def test_attribute_command_one_line(self, popen_mock):
    expected_command = 'rm -rf /somedir'
    subproc_mock = MagicMock()
    subproc_mock.returncode = 0
    subproc_mock.stdout.readline = MagicMock(side_effect=['OK'])
    popen_mock.return_value = subproc_mock
    with Environment('/') as env:
        Execute(expected_command)
    self.assertEqual(popen_mock.call_args_list[0][0][0][4], expected_command)
