def pre_rolling_restart(self, env):
    Logger.info('Executing HiveServer2 Rolling Upgrade pre-restart')
    import params
    env.set_params(params)
    if (params.version and (compare_versions(format_hdp_stack_version(params.version), '2.2.0.0') >= 0)):
        conf_select.select(params.stack_name, 'hive', params.version)
        Execute(format('hdp-select set hive-server2 {version}'))
        copy_tarballs_to_hdfs('mapreduce', 'hive-server2', params.tez_user, params.hdfs_user, params.user_group)
        copy_tarballs_to_hdfs('tez', 'hive-server2', params.tez_user, params.hdfs_user, params.user_group)
