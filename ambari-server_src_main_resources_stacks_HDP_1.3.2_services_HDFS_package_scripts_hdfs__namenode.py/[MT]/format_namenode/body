def format_namenode(force=None):
    import params
    mark_dir = params.namenode_formatted_mark_dir
    dfs_name_dir = params.dfs_name_dir
    hdfs_user = params.hdfs_user
    hadoop_conf_dir = params.hadoop_conf_dir
    if True:
        if force:
            ExecuteHadoop('namenode -format', kinit_override=True)
        else:
            File(format('{tmp_dir}/checkForFormat.sh'), content=StaticFile('checkForFormat.sh'), mode=493)
            Execute(format('sh {tmp_dir}/checkForFormat.sh {hdfs_user} {hadoop_conf_dir} {mark_dir} {dfs_name_dir}'), not_if=format('test -d {mark_dir}'), path='/usr/sbin:/sbin:/usr/local/bin:/bin:/usr/bin')
        Execute(format('mkdir -p {mark_dir}'))
