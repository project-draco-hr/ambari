@retry(times=12, sleep_time=10, err_class=Fail)
def _check_datanode_shutdown():
    '\n  Checks that a DataNode is down by running "hdfs dfsamin getDatanodeInfo"\n  several times, pausing in between runs. Once the DataNode stops responding\n  this method will return, otherwise it will raise a Fail(...) and retry\n  automatically.\n  :return:\n  '
    import params
    command = format('hdfs dfsadmin -getDatanodeInfo {dfs_dn_ipc_address}')
    try:
        Execute(command, user=params.hdfs_user, tries=1)
    except:
        Logger.info('DataNode has successfully shutdown for upgrade.')
        return
    Logger.info('DataNode has not shutdown.')
    raise Fail('DataNode has not shutdown.')
