{
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_checks"));
  UpgradePack up=upgrades.get("upgrade_test_checks");
  List<String> expected_up=Arrays.asList("PRE_CLUSTER","ZOOKEEPER","CORE_MASTER","SERVICE_CHECK_1","CORE_SLAVES","SERVICE_CHECK_2","POST_CLUSTER");
  List<String> expected_down=Arrays.asList("PRE_CLUSTER","CORE_SLAVES","SERVICE_CHECK_2","CORE_MASTER","SERVICE_CHECK_1","ZOOKEEPER","POST_CLUSTER");
  int i=0;
  List<Grouping> groups=up.getGroups(Direction.UPGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_up.get(i),g.name);
    i++;
  }
  i=0;
  groups=up.getGroups(Direction.DOWNGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_down.get(i),g.name);
    i++;
  }
}
