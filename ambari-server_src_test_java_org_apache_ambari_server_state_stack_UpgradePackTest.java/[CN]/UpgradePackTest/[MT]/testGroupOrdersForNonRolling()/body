{
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_test_nonrolling"));
  UpgradePack upgrade=upgrades.get("upgrade_test_nonrolling");
  List<String> expected_up=Arrays.asList("PRE_CLUSTER","Stop High-Level Daemons","Backups","Stop Low-Level Daemons","UPDATE_DESIRED_STACK_ID","ALL_HOST_OPS","ZOOKEEPER","HDFS","MR and YARN","POST_CLUSTER");
  int i=0;
  List<Grouping> groups=upgrade.getGroups(Direction.UPGRADE);
  for (  Grouping g : groups) {
    assertEquals(expected_up.get(i),g.name);
    i++;
  }
}
