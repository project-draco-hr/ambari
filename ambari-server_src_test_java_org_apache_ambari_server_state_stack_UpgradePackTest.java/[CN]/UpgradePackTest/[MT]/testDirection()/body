{
  Map<String,UpgradePack> upgrades=ambariMetaInfo.getUpgradePacks("HDP","2.1.1");
  assertTrue(upgrades.size() > 0);
  assertTrue(upgrades.containsKey("upgrade_direction"));
  UpgradePack up=upgrades.get("upgrade_direction");
  List<Grouping> groups=up.getGroups(Direction.UPGRADE);
  assertEquals(3,groups.size());
  Grouping group=groups.get(2);
  assertEquals(ClusterGrouping.class,group.getClass());
  ClusterGrouping cluster_group=(ClusterGrouping)groups.get(2);
  List<ExecuteStage> stages=cluster_group.executionStages;
  assertEquals(2,stages.size());
  assertNotNull(stages.get(0).intendedDirection);
  assertEquals(Direction.DOWNGRADE,stages.get(0).intendedDirection);
  groups=up.getGroups(Direction.DOWNGRADE);
  assertEquals(2,groups.size());
  assertEquals(ClusterGrouping.class,groups.get(1).getClass());
}
