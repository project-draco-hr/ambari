{
  if (json.has("name") && json.has("typeConfigs") && json.has("typeComponents")&& json.has("typeName")) {
    final String appType=json.get("typeName").getAsString();
    final String appName=json.get("name").getAsString();
    JsonObject configs=json.get("typeConfigs").getAsJsonObject();
    JsonArray componentsArray=json.get("typeComponents").getAsJsonArray();
    String appsCreateFolderPath=getAppsCreateFolderPath();
    File appsCreateFolder=new File(appsCreateFolderPath);
    if (!appsCreateFolder.exists()) {
      appsCreateFolder.mkdirs();
    }
    int appCount;
synchronized (createAppCounter) {
      if (createAppCounter < 0) {
        createAppCounter=0;
        String[] apps=appsCreateFolder.list();
        for (        String app : apps) {
          try {
            int count=Integer.parseInt(app);
            if (count > createAppCounter) {
              createAppCounter=count;
            }
          }
 catch (          NumberFormatException e) {
          }
        }
      }
      appCount=++createAppCounter;
    }
    File appCreateFolder=new File(appsCreateFolder,Integer.toString(appCount));
    appCreateFolder.mkdirs();
    File appConfigJsonFile=new File(appCreateFolder,"appConfig.json");
    File resourcesJsonFile=new File(appCreateFolder,"resources.json");
    saveAppConfigs(configs,componentsArray,appConfigJsonFile);
    saveAppResources(componentsArray,resourcesJsonFile);
    final ActionCreateArgs createArgs=new ActionCreateArgs();
    createArgs.template=appConfigJsonFile;
    createArgs.resources=resourcesJsonFile;
    final ActionInstallPackageArgs installArgs=new ActionInstallPackageArgs();
    SliderAppType sliderAppType=getSliderAppType(appType,null);
    String localAppPackageFileName=sliderAppType.getTypePackageFileName();
    installArgs.name=appType;
    installArgs.packageURI=getAppsFolderPath() + "/" + localAppPackageFileName;
    installArgs.replacePkg=true;
    return invokeSliderClientRunnable(new SliderClientContextRunnable<String>(){
      @Override public String run(      SliderClient sliderClient) throws YarnException, IOException, InterruptedException {
        sliderClient.actionInstallPkg(installArgs);
        sliderClient.actionCreate(appName,createArgs);
        ApplicationId applicationId=sliderClient.applicationId;
        if (applicationId != null) {
          return getApplicationIdString(applicationId);
        }
        return null;
      }
    }
);
  }
  return null;
}
