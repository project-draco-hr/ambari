def setup_hdp_install_directory():
    SELECT_ALL_PERFORMED_MARKER = '/var/lib/ambari-agent/data/hdp-select-set-all.performed'
    import params
    if ((params.hdp_stack_version != '') and (compare_versions(params.hdp_stack_version, '2.2') >= 0)):
        Execute(((as_sudo(['touch', SELECT_ALL_PERFORMED_MARKER]) + ' ; ') + format('{sudo} /usr/bin/hdp-select set all `ambari-python-wrap /usr/bin/hdp-select versions | grep ^{stack_version_unformatted} | tail -1`')), only_if=format('ls -d /usr/hdp/{stack_version_unformatted}*'), not_if=format('test -f {SELECT_ALL_PERFORMED_MARKER}'))
