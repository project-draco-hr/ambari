{
  readWriteLock.writeLock().lock();
  try {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Adding a ServiceComponent to Service" + ", clusterName=" + cluster.getClusterName() + ", clusterId="+ cluster.getClusterId()+ ", serviceName="+ getName()+ ", serviceComponentName="+ serviceComponentName);
    }
    if (components.containsKey(serviceComponentName)) {
      throw new AmbariException("Cannot add duplicate ServiceComponent" + ", clusterName=" + cluster.getClusterName() + ", clusterId="+ cluster.getClusterId()+ ", serviceName="+ getName()+ ", serviceComponentName="+ serviceComponentName);
    }
    ServiceComponent component=serviceComponentFactory.createNew(this,serviceComponentName);
    this.components.put(component.getName(),component);
    return component;
  }
  finally {
    readWriteLock.writeLock().unlock();
  }
}
