{
  if ((dn == null) || dn.isEmpty()) {
    return dn;
  }
 else {
    LdapName name=new LdapName(dn);
    List<Rdn> rdns=name.getRdns();
    if ((rdns == null) || rdns.isEmpty()) {
      throw new InvalidNameException(String.format("One or more RDNs are expected for a DN of %s",dn));
    }
    StringBuilder builder=new StringBuilder();
    for (    Rdn rdn : rdns) {
      builder.insert(0,String.format(",%s=%s",rdn.getType(),escapeCharacters((String)rdn.getValue(),SPECIAL_DN_CHARACTERS,DN_ESCAPE_CHARACTER)));
    }
    return builder.substring(1);
  }
}
