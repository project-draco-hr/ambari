{
  LOG.info("Creating ldap context");
  Properties env=new Properties();
  env.put(Context.INITIAL_CONTEXT_FACTORY,LDAP_CONTEXT_FACTORY_CLASS);
  env.put(Context.PROVIDER_URL,ldapUrl);
  env.put(Context.SECURITY_PRINCIPAL,adminPrincipal);
  env.put(Context.SECURITY_CREDENTIALS,adminPassword);
  env.put(Context.SECURITY_AUTHENTICATION,LDAP_ATUH_MECH_SIMPLE);
  env.put(Context.REFERRAL,"follow");
  try {
    ldapContext=new InitialLdapContext(env,null);
  }
 catch (  NamingException ne) {
    LOG.error("Can not created ldapContext",ne);
    throw new AmbariException("Can not created ldapContext",ne);
  }
  searchControls=new SearchControls();
  searchControls.setSearchScope(ONELEVEL_SCOPE);
  Set<String> userSearchAttributes=new HashSet<String>();
  userSearchAttributes.add("cn");
  searchControls.setReturningAttributes(userSearchAttributes.toArray(new String[userSearchAttributes.size()]));
}
