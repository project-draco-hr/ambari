{
  final PrintWriter spoolWriter=mock(PrintWriter.class);
  spoolWriter.println("log event");
  final File spoolFile=new File(spoolDirectory,SOURCE_FILENAME_PREFIX + FILE_SUFFIX);
  LogSpoolerContext logSpoolerContext=new LogSpoolerContext(spoolFile);
  logSpoolerContext.logEventSpooled();
  expect(rolloverCondition.shouldRollover(cmp(logSpoolerContext,new LogSpoolerEventCountComparator(),LogicalOperator.EQUAL))).andReturn(false);
  replay(spoolWriter,rolloverCondition);
  LogSpooler logSpooler=new LogSpooler(spoolDirectory,SOURCE_FILENAME_PREFIX,rolloverCondition,rolloverHandler){
    @Override protected PrintWriter initializeSpoolWriter(    File spoolFile) throws IOException {
      return spoolWriter;
    }
    @Override protected String getCurrentFileName(){
      return SOURCE_FILENAME_PREFIX + FILE_SUFFIX;
    }
  }
;
  logSpooler.add("log event");
  verify(rolloverCondition);
}
