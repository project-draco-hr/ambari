{
  String dataDirectoryPath=getCommandParameterValue(DATA_DIRECTORY);
  Map<String,Host> hosts=getClusters().getHostsForCluster(getClusterName());
  if ((hosts != null) && !hosts.isEmpty()) {
    Cluster cluster=getCluster();
    for (    String hostname : hosts.keySet()) {
      List<ServiceComponentHost> serviceComponentHosts=cluster.getServiceComponentHosts(hostname);
      for (      ServiceComponentHost sch : serviceComponentHosts) {
        SecurityState securityState=sch.getSecurityState();
        if (securityState.isTransitional()) {
          sch.setSecurityState(sch.getDesiredSecurityState());
        }
      }
    }
  }
  if ((dataDirectoryPath != null) && dataDirectoryPath.contains("/" + DATA_DIRECTORY_PREFIX)) {
    File dataDirectory=new File(dataDirectoryPath);
    File dataDirectoryParent=dataDirectory.getParentFile();
    if ((dataDirectoryParent != null) && dataDirectory.isDirectory() && dataDirectoryParent.isDirectory()&& dataDirectoryParent.canWrite()) {
      try {
        FileUtils.deleteDirectory(dataDirectory);
      }
 catch (      IOException e) {
        LOG.warn(String.format("The data directory (%s) was not deleted due to an error condition - {%s}",dataDirectory.getAbsolutePath(),e.getMessage()),e);
      }
    }
  }
  return createCommandReport(0,HostRoleStatus.COMPLETED,"{}",null,null);
}
