{
  RequestBodyParser parser=new JsonRequestBodyParser();
  RequestBody body=parser.parse(queryPostMultipleSubResourcesJson);
  Set<NamedPropertySet> setProperties=body.getPropertySets();
  assertEquals(2,setProperties.size());
  boolean contains1=false;
  boolean contains2=false;
  for (  NamedPropertySet ps : setProperties) {
    Map<String,Object> mapProps=ps.getProperties();
    String serviceName=(String)mapProps.get("ServiceInfo/service_name");
    if (serviceName.equals("unitTestService1")) {
      assertEquals("foo",ps.getName());
      assertEquals(1,mapProps.size());
      contains1=true;
    }
 else     if (serviceName.equals("unitTestService2")) {
      assertEquals("bar",ps.getName());
      assertEquals("prop2Value",mapProps.get("ServiceInfo/Category/property2"));
      assertEquals(2,mapProps.size());
      contains2=true;
    }
 else {
      fail("Unexpected service name");
    }
  }
  assertTrue(contains1);
  assertTrue(contains2);
  String b=body.getBody();
  body=parser.parse(b);
  Set<NamedPropertySet> setProps2=body.getPropertySets();
  assertEquals(2,setProps2.size());
  assertEquals(setProperties,setProps2);
}
