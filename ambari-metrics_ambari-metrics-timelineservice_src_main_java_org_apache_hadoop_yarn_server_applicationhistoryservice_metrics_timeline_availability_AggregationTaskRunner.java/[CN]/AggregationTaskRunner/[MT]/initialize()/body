{
  manager=HelixManagerFactory.getZKHelixManager(CLUSTER_NAME,instanceName,InstanceType.PARTICIPANT,zkAddress);
  OnlineOfflineStateModelFactory stateModelFactory=new OnlineOfflineStateModelFactory(instanceName,this);
  StateMachineEngine stateMach=manager.getStateMachineEngine();
  stateMach.registerStateModelFactory(STATE_MODEL_NAME,stateModelFactory);
  manager.connect();
  checkpointManager=new CheckpointManager(manager.getHelixPropertyStore());
}
