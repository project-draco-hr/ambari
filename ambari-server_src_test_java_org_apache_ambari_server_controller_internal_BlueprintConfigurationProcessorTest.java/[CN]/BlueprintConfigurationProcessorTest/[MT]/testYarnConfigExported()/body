{
  final String expectedHostName="c6401.apache.ambari.org";
  final String expectedPortNum="808080";
  final String expectedHostGroupName="host_group_1";
  Map<String,Map<String,String>> configProperties=new HashMap<String,Map<String,String>>();
  Map<String,String> yarnSiteProperties=new HashMap<String,String>();
  configProperties.put("yarn-site",yarnSiteProperties);
  yarnSiteProperties.put("yarn.log.server.url","http://" + expectedHostName + ":19888/jobhistory/logs");
  yarnSiteProperties.put("yarn.resourcemanager.hostname",expectedHostName);
  yarnSiteProperties.put("yarn.resourcemanager.resource-tracker.address",expectedHostName + ":" + expectedPortNum);
  yarnSiteProperties.put("yarn.resourcemanager.webapp.address",expectedHostName + ":" + expectedPortNum);
  yarnSiteProperties.put("yarn.resourcemanager.scheduler.address",expectedHostName + ":" + expectedPortNum);
  yarnSiteProperties.put("yarn.resourcemanager.address",expectedHostName + ":" + expectedPortNum);
  yarnSiteProperties.put("yarn.resourcemanager.admin.address",expectedHostName + ":" + expectedPortNum);
  yarnSiteProperties.put("yarn.timeline-service.address",expectedHostName + ":" + expectedPortNum);
  yarnSiteProperties.put("yarn.timeline-service.webapp.address",expectedHostName + ":" + expectedPortNum);
  yarnSiteProperties.put("yarn.timeline-service.webapp.https.address",expectedHostName + ":" + expectedPortNum);
  Configuration clusterConfig=new Configuration(configProperties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> groupComponents=new HashSet<String>();
  groupComponents.add("RESOURCEMANAGER");
  Collection<String> hosts=new ArrayList<String>();
  hosts.add(expectedHostName);
  hosts.add("serverTwo");
  TestHostGroup group=new TestHostGroup(expectedHostGroupName,groupComponents,hosts);
  Collection<TestHostGroup> hostGroups=new HashSet<TestHostGroup>();
  hostGroups.add(group);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForBlueprintExport();
  assertEquals("Yarn Log Server URL was incorrectly exported","http://" + "%HOSTGROUP::" + expectedHostGroupName + "%"+ ":19888/jobhistory/logs",yarnSiteProperties.get("yarn.log.server.url"));
  assertEquals("Yarn ResourceManager hostname was incorrectly exported",createExportedHostName(expectedHostGroupName),yarnSiteProperties.get("yarn.resourcemanager.hostname"));
  assertEquals("Yarn ResourceManager tracker address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.resourcemanager.resource-tracker.address"));
  assertEquals("Yarn ResourceManager webapp address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.resourcemanager.webapp.address"));
  assertEquals("Yarn ResourceManager scheduler address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.resourcemanager.scheduler.address"));
  assertEquals("Yarn ResourceManager address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.resourcemanager.address"));
  assertEquals("Yarn ResourceManager admin address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.resourcemanager.admin.address"));
  assertEquals("Yarn ResourceManager timeline-service address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.timeline-service.address"));
  assertEquals("Yarn ResourceManager timeline webapp address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.timeline-service.webapp.address"));
  assertEquals("Yarn ResourceManager timeline webapp HTTPS address was incorrectly exported",createExportedAddress(expectedPortNum,expectedHostGroupName),yarnSiteProperties.get("yarn.timeline-service.webapp.https.address"));
}
