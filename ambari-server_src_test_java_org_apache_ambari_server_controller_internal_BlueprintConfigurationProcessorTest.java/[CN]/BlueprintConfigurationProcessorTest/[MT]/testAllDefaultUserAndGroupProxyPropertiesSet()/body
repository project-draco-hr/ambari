{
  Map<String,Map<String,String>> properties=new HashMap<String,Map<String,String>>();
  Map<String,String> oozieEnvProperties=new HashMap<String,String>();
  Map<String,String> hiveEnvProperties=new HashMap<String,String>();
  Map<String,String> hbaseEnvProperties=new HashMap<String,String>();
  Map<String,String> falconEnvProperties=new HashMap<String,String>();
  properties.put("oozie-env",oozieEnvProperties);
  properties.put("hive-env",hiveEnvProperties);
  properties.put("hbase-env",hbaseEnvProperties);
  properties.put("falcon-env",falconEnvProperties);
  oozieEnvProperties.put("oozie_user","test-oozie-user");
  hiveEnvProperties.put("hive_user","test-hive-user");
  hiveEnvProperties.put("webhcat_user","test-hcat-user");
  hbaseEnvProperties.put("hbase_user","test-hbase-user");
  falconEnvProperties.put("falcon_user","test-falcon-user");
  Configuration clusterConfig=new Configuration(properties,Collections.<String,Map<String,Map<String,String>>>emptyMap());
  Collection<String> hgComponents1=new HashSet<String>();
  hgComponents1.add("OOZIE_SERVER");
  hgComponents1.add("HIVE_SERVER");
  hgComponents1.add("HBASE_MASTER");
  hgComponents1.add("FALCON_SERVER");
  TestHostGroup group1=new TestHostGroup("group1",hgComponents1,Collections.singleton("host1"));
  Collection<TestHostGroup> hostGroups=Collections.singletonList(group1);
  ClusterTopology topology=createClusterTopology(bp,clusterConfig,hostGroups);
  BlueprintConfigurationProcessor configProcessor=new BlueprintConfigurationProcessor(topology);
  configProcessor.doUpdateForClusterCreate();
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-oozie-user.hosts"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-oozie-user.groups"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-hive-user.hosts"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-hive-user.groups"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-hcat-user.hosts"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-hcat-user.groups"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-hbase-user.hosts"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-hbase-user.groups"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-falcon-user.hosts"));
  assertEquals("*",properties.get("core-site").get("hadoop.proxyuser.test-falcon-user.groups"));
}
