{
  AmbariManagementController ambariManagementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=ambariManagementController.getClusters();
  if (clusters != null) {
    Map<String,Cluster> clusterMap=clusters.getClusters();
    if (clusterMap != null) {
      for (      final Cluster cluster : clusterMap.values()) {
        Config configClusterEnv=cluster.getDesiredConfigByType("cluster-env");
        if (configClusterEnv != null) {
          Map<String,String> properties=configClusterEnv.getProperties();
          if (properties != null) {
            String securityEnabled=properties.get("security_enabled");
            if ("true".equalsIgnoreCase(securityEnabled)) {
              cluster.setSecurityType(SecurityType.KERBEROS);
            }
 else {
              cluster.setSecurityType(SecurityType.NONE);
            }
          }
        }
      }
    }
  }
}
