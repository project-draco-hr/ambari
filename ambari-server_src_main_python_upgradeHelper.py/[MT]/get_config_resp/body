def get_config_resp(cfg_type, error_if_na=True, parsed=False, tag=None):
    CONFIG_URL_FORMAT = (Options.CLUSTER_URL + '/configurations?type={0}&tag={1}')
    if (tag is None):
        structured_resp = curl(Options.CLUSTER_URL, validate=True, validate_expect_body=True, parse=True, simulate=False)
        if ('Clusters' in structured_resp):
            if ('desired_configs' in structured_resp['Clusters']):
                if (cfg_type in structured_resp['Clusters']['desired_configs']):
                    tag = structured_resp['Clusters']['desired_configs'][cfg_type]['tag']
    if (tag is not None):
        structured_resp = curl(CONFIG_URL_FORMAT.format(cfg_type, tag), parse=True, simulate=False, validate=True, validate_expect_body=True)
        if parsed:
            return (tag, parse_config_resp(structured_resp))
        else:
            return (tag, structured_resp)
    elif error_if_na:
        raise FatalException((-1), ('Unable to get the current version for config type ' + cfg_type))
    else:
        return (tag, None)
