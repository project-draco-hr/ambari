{
  ClusterServiceDAO clusterServiceDAO=injector.getInstance(ClusterServiceDAO.class);
  ServiceConfigDAO serviceConfigDAO=injector.getInstance(ServiceConfigDAO.class);
  Date currentTime=new Date();
  String serviceName="MapReduce1";
  String clusterName="test_cluster1";
  createServiceAndConfig(currentTime,serviceName,clusterName);
  List<ServiceConfigEntity> result=serviceConfigDAO.findAll();
  assertNotNull("inserted config not found",result);
  assertFalse(result.isEmpty());
  ClusterServiceEntity clusterServiceEntity=clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName);
  result=serviceConfigDAO.findByClusterService(clusterServiceEntity);
  assertNotNull("config by ClusterService not found",result);
  assertEquals("wrong number of configs",1,result.size());
  ServiceConfigEntity serviceConfigEntity=result.iterator().next();
  log.info("config version = " + serviceConfigEntity.getConfigVersion());
  assertNotNull("config version is null",serviceConfigEntity.getConfigVersion());
  serviceConfigDAO.remove(serviceConfigEntity);
  result=serviceConfigDAO.findAll();
  assertTrue(result.isEmpty());
  clusterServiceDAO.remove(clusterServiceEntity);
  assertNull(clusterServiceDAO.findByClusterAndServiceNames(clusterName,serviceName));
}
