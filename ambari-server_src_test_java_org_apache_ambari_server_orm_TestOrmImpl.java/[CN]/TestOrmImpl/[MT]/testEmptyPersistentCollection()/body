{
  String testClusterName="test_cluster2";
  StackDAO stackDAO=injector.getInstance(StackDAO.class);
  ResourceTypeDAO resourceTypeDAO=injector.getInstance(ResourceTypeDAO.class);
  ResourceTypeEntity resourceTypeEntity=resourceTypeDAO.findById(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE);
  if (resourceTypeEntity == null) {
    resourceTypeEntity=new ResourceTypeEntity();
    resourceTypeEntity.setId(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE);
    resourceTypeEntity.setName(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE_NAME);
    resourceTypeEntity=resourceTypeDAO.merge(resourceTypeEntity);
  }
  StackEntity stackEntity=stackDAO.find("HDP","2.2.0");
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setResourceType(resourceTypeEntity);
  ClusterEntity clusterEntity=new ClusterEntity();
  clusterEntity.setClusterName(testClusterName);
  clusterEntity.setResource(resourceEntity);
  clusterEntity.setDesiredStack(stackEntity);
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  clusterDAO.create(clusterEntity);
  clusterEntity=clusterDAO.findByName(clusterEntity.getClusterName());
  assertTrue("empty relation wasn't instantiated",clusterEntity.getHostEntities() != null);
}
