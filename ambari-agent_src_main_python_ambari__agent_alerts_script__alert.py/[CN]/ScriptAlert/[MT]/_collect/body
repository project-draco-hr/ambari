def _collect(self):
    cmd_module = self._load_source()
    if (cmd_module is not None):
        parameters = {}
        for key in self.config_value_dict:
            parameters[(('{{' + key) + '}}')] = self.config_value_dict[key]
        matchObj = re.match('((.*)services\\/(.*)\\/package\\/)', self.path_to_script)
        if matchObj:
            basedir = matchObj.group(1)
            with Environment(basedir, tmp_dir=self.config.get('agent', 'tmp_dir')) as env:
                return cmd_module.execute(parameters, self.host_name)
        else:
            return cmd_module.execute(parameters, self.host_name)
    else:
        return (self.RESULT_UNKNOWN, ['Unable to execute script {0}'.format(self.path)])
