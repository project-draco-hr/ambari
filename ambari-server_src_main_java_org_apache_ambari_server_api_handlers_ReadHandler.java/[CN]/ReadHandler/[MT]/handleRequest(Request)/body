{
  Query query=request.getResourceDefinition().getQuery();
  for (  Map.Entry<PropertyId,TemporalInfo> entry : request.getFields().entrySet()) {
    PropertyId propertyId=entry.getKey();
    query.addProperty(propertyId.getCategory(),propertyId.getName(),entry.getValue());
  }
  query.setUserPredicate(request.getQueryPredicate());
  try {
    return query.execute();
  }
 catch (  AmbariException e) {
    throw new RuntimeException("An exception occurred processing the request: " + e,e);
  }
}
