{
  Query query=request.getResource().getQuery();
  for (  Map.Entry<String,TemporalInfo> entry : request.getFields().entrySet()) {
    String propertyId=entry.getKey();
    query.addProperty(PropertyHelper.getPropertyCategory(propertyId),PropertyHelper.getPropertyName(propertyId),entry.getValue());
  }
  query.setUserPredicate(request.getQueryPredicate());
  try {
    return query.execute();
  }
 catch (  AmbariException e) {
    throw new RuntimeException("An exception occurred processing the request: " + e,e);
  }
}
