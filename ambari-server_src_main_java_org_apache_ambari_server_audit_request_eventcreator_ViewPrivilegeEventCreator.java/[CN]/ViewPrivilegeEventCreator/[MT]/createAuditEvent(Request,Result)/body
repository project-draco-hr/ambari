{
  String username=((User)SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getUsername();
  Map<String,List<String>> users=getEntities(request,"USER");
  Map<String,List<String>> groups=getEntities(request,"GROUP");
  return ViewPrivilegeChangeRequestAuditEvent.builder().withTimestamp(System.currentTimeMillis()).withRequestType(request.getRequestType()).withResultStatus(result.getStatus()).withUrl(request.getURI()).withRemoteIp(request.getRemoteAddress()).withUserName(username).withType(getProperty(request,PropertyHelper.getPropertyId("PrivilegeInfo","view_name"))).withVersion(getProperty(request,PropertyHelper.getPropertyId("PrivilegeInfo","version"))).withName(getProperty(request,PropertyHelper.getPropertyId("PrivilegeInfo","instance_name"))).withUsers(users).withGroups(groups).build();
}
