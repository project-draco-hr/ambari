{
  Boolean hasHCFS=false;
  Boolean isHAEnabled=false;
  try {
    if (cluster != null && cluster.getService("HCFS") != null) {
      hasHCFS=true;
    }
  }
 catch (  AmbariException e) {
  }
  try {
    if (cluster != null && cluster.getService("HDFS") != null && cluster.getService("HDFS").getServiceComponent("JOURNALNODE") != null) {
      isHAEnabled=true;
    }
  }
 catch (  AmbariException e) {
  }
  ObjectMapper mapper=new ObjectMapper();
  StackId currentStackVersion=cluster.getCurrentStackVersion();
  String stackName=currentStackVersion.getStackName();
  String stackVersion=currentStackVersion.getStackVersion();
  File rcoFile=getRCOFile(stackName,stackVersion);
  Map<String,Object> userData=null;
  try {
    TypeReference<Map<String,Object>> rcoElementTypeReference=new TypeReference<Map<String,Object>>(){
    }
;
    if (rcoFile != null) {
      userData=mapper.readValue(rcoFile,rcoElementTypeReference);
      LOG.info("Role command order info was loaded from file: " + rcoFile.getAbsolutePath());
    }
 else {
      InputStream rcoInputStream=ClassLoader.getSystemResourceAsStream(ROLE_COMMAND_ORDER_FILE);
      userData=mapper.readValue(rcoInputStream,rcoElementTypeReference);
      LOG.info("Role command order info was loaded from classpath: " + ClassLoader.getSystemResource(ROLE_COMMAND_ORDER_FILE));
    }
  }
 catch (  IOException e) {
    LOG.error("Can not read role command order info",e);
    return;
  }
  Map<String,Object> generalSection=(Map<String,Object>)userData.get(GENERAL_DEPS_KEY);
  addDependencies(generalSection);
  if (hasHCFS) {
    Map<String,Object> hcfsSection=(Map<String,Object>)userData.get(HCFS_DEPS_KEY);
    addDependencies(hcfsSection);
  }
 else {
    Map<String,Object> noHcfsSection=(Map<String,Object>)userData.get(NO_HCFS_DEPS_KEY);
    addDependencies(noHcfsSection);
  }
  if (isHAEnabled) {
    Map<String,Object> isHASection=(Map<String,Object>)userData.get(HA_DEPS_KEY);
    addDependencies(isHASection);
  }
  extendTransitiveDependency();
}
