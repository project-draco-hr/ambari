{
  Boolean hasGLUSTERFS=false;
  Boolean isNameNodeHAEnabled=false;
  Boolean isResourceManagerHAEnabled=false;
  try {
    if (cluster != null && cluster.getService("GLUSTERFS") != null) {
      hasGLUSTERFS=true;
    }
  }
 catch (  AmbariException e) {
  }
  try {
    if (cluster != null && cluster.getService("HDFS") != null && cluster.getService("HDFS").getServiceComponent("JOURNALNODE") != null) {
      isNameNodeHAEnabled=true;
    }
  }
 catch (  AmbariException e) {
  }
  try {
    if (cluster != null && cluster.getService("YARN") != null && cluster.getService("YARN").getServiceComponent("RESOURCEMANAGER").getServiceComponentHosts().size() > 1) {
      isResourceManagerHAEnabled=true;
    }
  }
 catch (  AmbariException e) {
  }
  ObjectMapper mapper=new ObjectMapper();
  StackId currentStackVersion=cluster.getCurrentStackVersion();
  String stackName=currentStackVersion.getStackName();
  String stackVersion=currentStackVersion.getStackVersion();
  File rcoFile=getRCOFile(stackName,stackVersion);
  Map<String,Object> userData;
  try {
    TypeReference<Map<String,Object>> rcoElementTypeReference=new TypeReference<Map<String,Object>>(){
    }
;
    if (rcoFile != null) {
      userData=mapper.readValue(rcoFile,rcoElementTypeReference);
      LOG.info("Role command order info was loaded from file: " + rcoFile.getAbsolutePath());
    }
 else {
      InputStream rcoInputStream=ClassLoader.getSystemResourceAsStream(ROLE_COMMAND_ORDER_FILE);
      userData=mapper.readValue(rcoInputStream,rcoElementTypeReference);
      LOG.info("Role command order info was loaded from classpath: " + ClassLoader.getSystemResource(ROLE_COMMAND_ORDER_FILE));
    }
  }
 catch (  IOException e) {
    LOG.error("Can not read role command order info",e);
    return;
  }
  Map<String,Object> generalSection=(Map<String,Object>)userData.get(GENERAL_DEPS_KEY);
  addDependencies(generalSection);
  if (hasGLUSTERFS) {
    Map<String,Object> glusterfsSection=(Map<String,Object>)userData.get(GLUSTERFS_DEPS_KEY);
    addDependencies(glusterfsSection);
  }
 else {
    Map<String,Object> noGlusterFSSection=(Map<String,Object>)userData.get(NO_GLUSTERFS_DEPS_KEY);
    addDependencies(noGlusterFSSection);
  }
  if (isNameNodeHAEnabled) {
    Map<String,Object> NAMENODEHASection=(Map<String,Object>)userData.get(NAMENODE_HA_DEPS_KEY);
    addDependencies(NAMENODEHASection);
  }
  if (isResourceManagerHAEnabled) {
    Map<String,Object> ResourceManagerHASection=(Map<String,Object>)userData.get(RESOURCEMANAGER_HA_DEPS_KEY);
    addDependencies(ResourceManagerHASection);
  }
  extendTransitiveDependency();
}
