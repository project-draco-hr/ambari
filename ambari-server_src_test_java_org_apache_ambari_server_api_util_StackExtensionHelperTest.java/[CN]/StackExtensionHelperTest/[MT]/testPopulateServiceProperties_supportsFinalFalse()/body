{
  File stackRoot=new File(stackRootStr);
  StackExtensionHelper helper=createMockBuilder(StackExtensionHelper.class).addMockedMethod("addConfigTypeProperty").withConstructor(injector,stackRoot).createMock();
  File config=new File(stackRootStr + "HDP/2.0.7/services/HDFS/configuration/core-site.xml".replaceAll("/",File.separator));
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  List<PropertyInfo> properties=createNiceMock(List.class);
  expect(serviceInfo.getProperties()).andReturn(properties).times(1);
  expect(properties.addAll((Collection)anyObject())).andReturn(true).times(1);
  helper.addConfigTypeProperty(serviceInfo,"core-site",StackExtensionHelper.Supports.KEYWORD,StackExtensionHelper.Supports.FINAL.getPropertyName(),"false");
  replay(properties);
  replay(serviceInfo);
  replay(helper);
  helper.populateServiceProperties(config,serviceInfo);
  verify(properties,serviceInfo,helper);
}
