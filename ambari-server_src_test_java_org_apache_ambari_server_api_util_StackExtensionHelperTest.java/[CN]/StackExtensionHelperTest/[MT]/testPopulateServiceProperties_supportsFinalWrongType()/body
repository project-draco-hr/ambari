{
  File stackRoot=new File(stackRootStr);
  StackExtensionHelper helper=createMockBuilder(StackExtensionHelper.class).addMockedMethod("addConfigTypeProperty").withConstructor(injector,stackRoot).createMock();
  File config=new File("./src/test/resources/bad-stacks/HDP/0.1/services/YARN/configuration/yarn-site.xml".replaceAll("/",File.separator));
  ServiceInfo serviceInfo=createNiceMock(ServiceInfo.class);
  List<PropertyInfo> properties=createNiceMock(List.class);
  expect(serviceInfo.getConfigTypes()).andReturn(new HashMap<String,Map<String,Map<String,String>>>()).times(2);
  expect(serviceInfo.getProperties()).andReturn(properties).times(1);
  expect(properties.addAll((Collection)anyObject())).andReturn(true).times(1);
  replay(properties,serviceInfo);
  helper.populateServiceProperties(config,serviceInfo);
  verify(properties,serviceInfo);
}
