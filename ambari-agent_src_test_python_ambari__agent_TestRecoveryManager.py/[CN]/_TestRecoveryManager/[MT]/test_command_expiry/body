@patch.object(RecoveryManager, '_now_')
def test_command_expiry(self, time_mock):
    time_mock.side_effect = [1000, 1001, 1002, 1003, 1104, 1105, 1106, 1807, 1808, 1809, 1810, 1811, 1812]
    rm = RecoveryManager(tempfile.mktemp(), True)
    rm.update_config(5, 5, 1, 11, True, False, '', (-1))
    command1 = copy.deepcopy(self.command)
    rm.store_or_update_command(command1)
    rm.update_config(12, 5, 1, 15, True, False, 'NODEMANAGER', (-1))
    rm.update_current_status('NODEMANAGER', 'INSTALLED')
    rm.update_desired_status('NODEMANAGER', 'STARTED')
    commands = rm.get_recovery_commands()
    self.assertEqual(1, len(commands))
    self.assertEqual('START', commands[0]['roleCommand'])
    commands = rm.get_recovery_commands()
    self.assertEqual(1, len(commands))
    self.assertEqual('START', commands[0]['roleCommand'])
    commands = rm.get_recovery_commands()
    self.assertEqual(0, len(commands))
    rm.store_or_update_command(command1)
    commands = rm.get_recovery_commands()
    self.assertEqual(1, len(commands))
    self.assertEqual('START', commands[0]['roleCommand'])
    pass
