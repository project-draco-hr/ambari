{
  if (aggregateClusterMetrics == null) {
    LOG.error("Aggregation requested without init call.");
    return;
  }
  Set<String> apps=hostedAppsMap.get(hostname);
  for (  String appId : apps) {
    TimelineClusterMetric appTimelineClusterMetric=new TimelineClusterMetric(clusterMetric.getMetricName(),appId,clusterMetric.getInstanceId(),clusterMetric.getTimestamp(),clusterMetric.getType());
    MetricClusterAggregate clusterAggregate=aggregateClusterMetrics.get(appTimelineClusterMetric);
    if (clusterAggregate == null) {
      clusterAggregate=new MetricClusterAggregate(metricValue,1,null,metricValue,metricValue);
      aggregateClusterMetrics.put(appTimelineClusterMetric,clusterAggregate);
    }
 else {
      clusterAggregate.updateSum(metricValue);
      clusterAggregate.updateNumberOfHosts(1);
      clusterAggregate.updateMax(metricValue);
      clusterAggregate.updateMin(metricValue);
    }
  }
}
