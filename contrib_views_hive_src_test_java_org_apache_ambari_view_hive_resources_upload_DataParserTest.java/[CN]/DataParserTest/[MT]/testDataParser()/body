{
  String str="1,a\n" + "2,b\n" + "3,c\n";
  StringReader sr=new StringReader(str);
  ParseOptions parseOptions=new ParseOptions();
  parseOptions.setOption(ParseOptions.OPTIONS_FILE_TYPE,ParseOptions.FILE_TYPE_CSV);
  parseOptions.setOption(ParseOptions.OPTIONS_HEADER,ParseOptions.HEADER_FIRST_RECORD);
  DataParser dp=new DataParser(sr,parseOptions);
  dp.parsePreview();
  Assert.assertNotNull(dp.getPreviewRows());
  Assert.assertNotNull(dp.getHeader());
  Assert.assertEquals(3,dp.getPreviewRows().size());
  Assert.assertEquals(2,dp.getHeader().size());
  ColumnDescription[] cd={new ColumnDescriptionImpl("1",ColumnDescriptionShort.DataTypes.INT.toString(),0),new ColumnDescriptionImpl("a",ColumnDescriptionShort.DataTypes.CHAR.toString(),1)};
  Assert.assertArrayEquals("Header Not Correct.",cd,dp.getHeader().toArray());
  sr.close();
}
