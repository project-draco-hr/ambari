def work_in_env_only_mode(hostnames, command_line, custom_env):
    concrete_command_line = []
    for item in command_line:
        if (item == HOSTNAME_PLACEHOLDER):
            concrete_command_line.extend(hostnames)
        else:
            concrete_command_line.append(item)
    try:
        returncode = 0
        message = check_output(concrete_command_line, env=custom_env)
    except subprocess.CalledProcessError as e:
        returncode = e.returncode
        message = e.output
    check_result = {'message': message, 'retcode': returncode, 'real_retcode': None, }
    return check_result
