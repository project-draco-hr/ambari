def test_return_failed_status_for_hanging_ssh_threads_after_timeout(self):
    bootstrap.HOST_BOOTSTRAP_TIMEOUT = 1
    forever_hanging_timeout = 5
    SSH.run = (lambda self: time.sleep(forever_hanging_timeout))
    pssh = PSSH(['hostname'], 'sshKeyFile', 'command', 'bootdir')
    self.assertTrue((pssh.ret == {}))
    starttime = time.time()
    pssh.run()
    self.assertTrue((pssh.ret != {}))
    self.assertTrue(((time.time() - starttime) < forever_hanging_timeout))
    self.assertTrue((pssh.ret['hostname']['log'] == 'FAILED'))
    self.assertTrue((pssh.ret['hostname']['exitstatus'] == (-1)))
