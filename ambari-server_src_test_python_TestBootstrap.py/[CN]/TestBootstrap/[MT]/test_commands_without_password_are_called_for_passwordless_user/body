def test_commands_without_password_are_called_for_passwordless_user(self):
    Popen.communicate = (lambda self: ('', ''))
    SCP.writeLogToFile = (lambda self, logFilePath: None)
    SSH.writeLogToFile = (lambda self, logFilePath: None)
    SSH.writeDoneToFile = (lambda self, doneFilePath, returncode: None)
    BootStrap.createDoneFiles = (lambda self: None)
    getRunSetupWithoutPasswordCommand = MagicMock()
    getRunSetupWithoutPasswordCommand.return_value = ''
    BootStrap.getRunSetupWithoutPasswordCommand = getRunSetupWithoutPasswordCommand
    getMoveRepoFileWithoutPasswordCommand = MagicMock()
    getMoveRepoFileWithoutPasswordCommand.return_value = ''
    BootStrap.getMoveRepoFileWithoutPasswordCommand = getMoveRepoFileWithoutPasswordCommand
    os.environ[AMBARI_PASSPHRASE_VAR_NAME] = ''
    bootstrap = BootStrap(['hostname'], 'user', 'sshKeyFile', 'scriptDir', 'bootdir', 'setupAgentFile', 'ambariServer')
    ret = bootstrap.run()
    self.assertTrue(getRunSetupWithoutPasswordCommand.called)
    self.assertTrue(getMoveRepoFileWithoutPasswordCommand.called)
