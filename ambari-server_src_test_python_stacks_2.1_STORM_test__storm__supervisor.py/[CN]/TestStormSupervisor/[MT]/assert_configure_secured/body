def assert_configure_secured(self):
    self.assertResourceCalled('Directory', '/var/log/storm', owner='storm', group='hadoop', recursive=True)
    self.assertResourceCalled('Directory', '/var/run/storm', owner='storm', group='hadoop', recursive=True)
    self.assertResourceCalled('Directory', '/hadoop/storm', owner='storm', group='hadoop', recursive=True)
    self.assertResourceCalled('Directory', '/etc/storm/conf', owner='storm', group='hadoop', recursive=True)
    self.assertResourceCalled('File', '/etc/storm/conf/config.yaml', owner='storm', content=Template('config.yaml.j2'), group='hadoop')
    self.call_storm_template_and_assert()
    self.assertResourceCalled('File', '/etc/storm/conf/storm-env.sh', owner='storm', content=InlineTemplate(self.getConfig()['configurations']['storm-env']['content']))
    self.assertResourceCalled('TemplateConfig', '/etc/storm/conf/storm_jaas.conf', owner='storm')
