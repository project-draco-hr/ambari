{
  String username=((User)SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getUsername();
switch (request.getRequestType()) {
case POST:
    return AddAlertTargetRequestAuditEvent.builder().withTimestamp(System.currentTimeMillis()).withRequestType(request.getRequestType()).withResultStatus(result.getStatus()).withUrl(request.getURI()).withRemoteIp(request.getRemoteAddress()).withUserName(username).withName(getProperty(request,"name")).withDescription(getProperty(request,"description")).withAlertStates(getPropertyList(request,"alert_states")).withGroupIds(getPropertyList(request,"groups")).withNotificationType(getProperty(request,"notification_type")).withEmailFrom(getProperty(request,"properties/mail.smtp.from")).withEmailRecipients(getPropertyList(request,"properties/ambari.dispatch.recipients")).build();
case PUT:
  return ChangeAlertTargetRequestAuditEvent.builder().withTimestamp(System.currentTimeMillis()).withRequestType(request.getRequestType()).withResultStatus(result.getStatus()).withUrl(request.getURI()).withRemoteIp(request.getRemoteAddress()).withUserName(username).withName(getProperty(request,"name")).withDescription(getProperty(request,"description")).withAlertStates(getPropertyList(request,"alert_states")).withGroupIds(getPropertyList(request,"groups")).withNotificationType(getProperty(request,"notification_type")).withEmailFrom(getProperty(request,"properties/mail.smtp.from")).withEmailRecipients(getPropertyList(request,"properties/ambari.dispatch.recipients")).build();
case DELETE:
return DeleteAlertTargetRequestAuditEvent.builder().withTimestamp(System.currentTimeMillis()).withRequestType(request.getRequestType()).withResultStatus(result.getStatus()).withUrl(request.getURI()).withRemoteIp(request.getRemoteAddress()).withUserName(username).withId(request.getResource().getKeyValueMap().get(Resource.Type.AlertTarget)).build();
default :
return null;
}
}
