{
  HiveStatement statement=message.getStatement();
  String jobId=message.getJobId();
  String yarnAtsGuid=statement.getYarnATSGuid();
  LOG.info("Fetched guid: {}, for job id: {}",yarnAtsGuid,jobId);
  if (yarnAtsGuid == null) {
    LOG.info("Retrying to fetch guid");
    getContext().system().scheduler().scheduleOnce(Duration.create(1,TimeUnit.SECONDS),getSelf(),message,getContext().dispatcher(),null);
  }
 else {
    try {
      JobImpl job=storage.load(JobImpl.class,jobId);
      job.setGuid(yarnAtsGuid);
      storage.store(JobImpl.class,job);
      LOG.info("Stored guid: {} for job id: {} in database",yarnAtsGuid,jobId);
    }
 catch (    ItemNotFound itemNotFound) {
    }
  }
}
