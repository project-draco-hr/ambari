{
  m_configurations=new HashMap<String,Map<String,String>>();
  Map<String,Map<String,String>> allConfigTags=configHelper.getEffectiveDesiredTags(cluster,m_hostName);
  for (  Config clusterConfig : cluster.getAllConfigs()) {
    if (null == clusterConfig) {
      continue;
    }
    Map<String,String> props=new HashMap<String,String>(clusterConfig.getProperties());
    Map<String,Map<String,String>> configTags=new HashMap<String,Map<String,String>>();
    for (    Map.Entry<String,Map<String,String>> entry : allConfigTags.entrySet()) {
      if (entry.getKey().equals(clusterConfig.getType())) {
        configTags.put(clusterConfig.getType(),entry.getValue());
      }
    }
    Map<String,Map<String,String>> properties=configHelper.getEffectiveConfigProperties(cluster,configTags);
    if (!properties.isEmpty()) {
      for (      Map<String,String> propertyMap : properties.values()) {
        props.putAll(propertyMap);
      }
    }
    m_configurations.put(clusterConfig.getType(),props);
  }
}
