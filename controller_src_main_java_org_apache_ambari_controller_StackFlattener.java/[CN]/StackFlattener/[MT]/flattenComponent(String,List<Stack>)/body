{
  Component result=null;
  for (  Stack stack : stacks) {
    for (    Component comp : stack.getComponents()) {
      if (comp.getName().equals(name)) {
        if (result != null) {
          result.mergeInto(comp);
        }
 else {
          result=new Component();
          result.setDefinition(new ComponentDefinition());
          result.mergeInto(comp);
        }
      }
    }
  }
  result.setConfiguration(null);
  List<Role> roles=new ArrayList<Role>();
  result.setRoles(roles);
  ComponentPlugin plugin=plugins.getPlugin(result.getDefinition());
  for (  String roleName : plugin.getActiveRoles()) {
    Role role=new Role();
    roles.add(role);
    role.setName(roleName);
    role.setConfiguration(flattenConfiguration(stacks,name,roleName));
  }
  return result;
}
