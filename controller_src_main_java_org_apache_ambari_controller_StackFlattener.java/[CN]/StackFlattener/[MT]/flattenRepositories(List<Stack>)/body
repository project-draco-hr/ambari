{
  Map<String,List<String>> repositories=new TreeMap<String,List<String>>();
  for (int i=stacks.size() - 1; i >= 0; --i) {
    Stack stack=stacks.get(i);
    List<RepositoryKind> kindList=stack.getPackageRepositories();
    if (kindList != null) {
      for (      RepositoryKind kind : kindList) {
        List<String> list=repositories.get(kind.getKind());
        if (list == null) {
          list=new ArrayList<String>();
          repositories.put(kind.getKind(),list);
        }
        list.addAll(kind.getUrls());
      }
    }
  }
  List<RepositoryKind> result=new ArrayList<RepositoryKind>();
  for (  Map.Entry<String,List<String>> item : repositories.entrySet()) {
    RepositoryKind kind=new RepositoryKind();
    kind.setKind(item.getKey());
    kind.setUrls(item.getValue());
    result.add(kind);
  }
  return result;
}
