{
  String orderByClause=null;
  if (topNFunction != null) {
switch (topNFunction.getReadFunction()) {
case AVG:
      orderByClause="ROUND(AVG(METRIC_SUM),2)";
    break;
case SUM:
  orderByClause="SUM(METRIC_SUM)";
break;
default :
orderByClause="MAX(METRIC_MAX)";
break;
}
}
if (orderByClause == null) {
orderByClause="MAX(METRIC_MAX)";
}
if (!isBottomN) {
orderByClause+=" DESC";
}
return orderByClause;
}
