{
  FlumeTimelineMetricsSink flumeTimelineMetricsSink=new FlumeTimelineMetricsSink();
  TimelineMetricsCache timelineMetricsCache=getTimelineMetricsCache(flumeTimelineMetricsSink);
  flumeTimelineMetricsSink.setPollFrequency(1);
  HttpClient httpClient=EasyMock.createNiceMock(HttpClient.class);
  flumeTimelineMetricsSink.setHttpClient(httpClient);
  mockStatic(JMXPollUtil.class);
  EasyMock.expect(JMXPollUtil.getAllMBeans()).andThrow(new RuntimeException("Failed to retrieve Flume Properties")).once();
  replay(JMXPollUtil.class,timelineMetricsCache,httpClient);
  flumeTimelineMetricsSink.start();
  Thread.sleep(5);
  flumeTimelineMetricsSink.stop();
  verifyAll();
}
