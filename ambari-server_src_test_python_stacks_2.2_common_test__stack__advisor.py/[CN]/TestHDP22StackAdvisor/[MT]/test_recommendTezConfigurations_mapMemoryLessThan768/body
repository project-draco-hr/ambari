def test_recommendTezConfigurations_mapMemoryLessThan768(self):
    configurations = {}
    clusterData = {'mapMemory': 760, 'amMemory': 2000, 'reduceMemory': 760, 'containers': 3, 'ramPerContainer': 256, }
    expected = {'tez-site': {'properties': {'tez.am.resource.memory.mb': '4000', 'tez.am.java.opts': '-server -Xmx1600m -Djava.net.preferIPv4Stack=true -XX:+UseNUMA -XX:+UseParallelGC', 'tez.task.resource.memory.mb': '760', 'tez.runtime.io.sort.mb': '304', 'tez.runtime.unordered.output.buffer.size-mb': '57', }, }, }
    self.stackAdvisor.recommendTezConfigurations(configurations, clusterData)
    self.assertEquals(configurations, expected)
