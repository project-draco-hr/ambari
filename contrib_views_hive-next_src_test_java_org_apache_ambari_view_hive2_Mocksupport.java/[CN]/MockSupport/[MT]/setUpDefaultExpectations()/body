{
  expect(supplier.get(viewContext)).andReturn(new DataStoreStorage(viewContext));
  expect(hdfsSupplier.get(viewContext)).andReturn(Optional.fromNullable(hdfsApi)).anyTimes();
  expect(connection.createStatement()).andReturn(statement);
  expect(connect.getConnectable()).andReturn(connectable);
  expect(connectable.isOpen()).andReturn(false);
  Optional<HiveConnection> connectionOptional=Optional.of(connection);
  expect(connectable.getConnection()).andReturn(connectionOptional).anyTimes();
  expect(connectionSupplier.get(viewContext)).andReturn(connectionDelegate).times(1);
  expect(statement.getResultSet()).andReturn(resultSet);
  expect(resultSet.getMetaData()).andReturn(resultSetMetaData);
  expect(resultSetMetaData.getColumnCount()).andReturn(1);
  expect(resultSetMetaData.getColumnName(1)).andReturn("test");
  expect(resultSet.next()).andReturn(true);
  expect(resultSet.getObject(1)).andReturn("test");
  connectable.connect();
}
