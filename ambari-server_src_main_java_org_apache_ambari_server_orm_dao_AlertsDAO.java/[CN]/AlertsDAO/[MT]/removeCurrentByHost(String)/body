{
  TypedQuery<AlertCurrentEntity> query=m_entityManagerProvider.get().createNamedQuery("AlertCurrentEntity.removeByHost",AlertCurrentEntity.class);
  query.setParameter("hostName",hostName);
  int removedItems=query.executeUpdate();
  if (m_configuration.isAlertCacheEnabled()) {
    m_currentAlertCache.invalidateAll();
  }
  try {
    Map<String,Cluster> clusters=m_clusters.get().getClusters();
    for (    Map.Entry<String,Cluster> entry : clusters.entrySet()) {
      m_alertEventPublisher.publish(new AggregateAlertRecalculateEvent(entry.getValue().getClusterId()));
    }
  }
 catch (  Exception ambariException) {
    LOG.warn("Unable to recalcuate aggregate alerts after removing host {}",hostName);
  }
  return removedItems;
}
