{
  final ClusterEntity clusterEntity=createCluster();
  final ClusterServiceEntity clusterServiceEntityHDFS=addService(clusterEntity,"HDFS");
  final ClusterServiceEntity clusterServiceEntityHIVE=addService(clusterEntity,"HIVE");
  final ClusterServiceEntity clusterServiceEntityHCATALOG=addService(clusterEntity,"HCATALOG");
  final ClusterServiceEntity clusterServiceEntityWEBHCAT=addService(clusterEntity,"WEBHCAT");
  final HostEntity hostEntity=createHost(clusterEntity);
  addComponent(clusterEntity,clusterServiceEntityHDFS,hostEntity,"NAMENODE");
  addComponent(clusterEntity,clusterServiceEntityHIVE,hostEntity,"HIVE_SERVER");
  addComponent(clusterEntity,clusterServiceEntityHCATALOG,hostEntity,"HCAT");
  addComponent(clusterEntity,clusterServiceEntityWEBHCAT,hostEntity,"WEBHCAT_SERVER");
  UpgradeCatalog170 upgradeCatalog170=injector.getInstance(UpgradeCatalog170.class);
  upgradeCatalog170.moveHcatalogIntoHiveService();
}
