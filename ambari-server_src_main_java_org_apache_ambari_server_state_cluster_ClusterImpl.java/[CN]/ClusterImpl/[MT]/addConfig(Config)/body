{
  clusterGlobalLock.writeLock().lock();
  try {
    if (config.getType() == null || config.getType().isEmpty()) {
      throw new IllegalArgumentException("Config type cannot be empty");
    }
    if (!allConfigs.containsKey(config.getType())) {
      allConfigs.put(config.getType(),new HashMap<String,Config>());
    }
    allConfigs.get(config.getType()).put(config.getTag(),config);
  }
  finally {
    clusterGlobalLock.writeLock().unlock();
  }
}
