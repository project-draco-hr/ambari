{
  loadConfigurations();
  clusterGlobalLock.readLock().lock();
  try {
    List<ServiceConfigVersionResponse> serviceConfigVersionResponses=new ArrayList<ServiceConfigVersionResponse>();
    List<ServiceConfigEntity> serviceConfigs=serviceConfigDAO.getServiceConfigs(getClusterId());
    Map<String,ServiceConfigVersionResponse> activeServiceConfigResponses=new HashMap<>();
    for (    ServiceConfigEntity serviceConfigEntity : serviceConfigs) {
      ServiceConfigVersionResponse serviceConfigVersionResponse=convertToServiceConfigVersionResponse(serviceConfigEntity);
      ServiceConfigVersionResponse activeServiceConfigResponse=activeServiceConfigResponses.get(serviceConfigVersionResponse.getServiceName());
      if (activeServiceConfigResponse == null) {
        activeServiceConfigResponse=serviceConfigVersionResponse;
        activeServiceConfigResponses.put(serviceConfigVersionResponse.getServiceName(),serviceConfigVersionResponse);
      }
      serviceConfigVersionResponse.setConfigurations(new ArrayList<ConfigurationResponse>());
      if (serviceConfigEntity.getGroupId() == null) {
        if (serviceConfigVersionResponse.getCreateTime() > activeServiceConfigResponse.getCreateTime())         activeServiceConfigResponses.put(serviceConfigVersionResponse.getServiceName(),serviceConfigVersionResponse);
      }
 else       if (clusterConfigGroups != null && clusterConfigGroups.containsKey(serviceConfigEntity.getGroupId())) {
        if (serviceConfigVersionResponse.getVersion() > activeServiceConfigResponse.getVersion())         activeServiceConfigResponses.put(serviceConfigVersionResponse.getServiceName(),serviceConfigVersionResponse);
      }
      serviceConfigVersionResponse.setIsCurrent(false);
      List<ClusterConfigEntity> clusterConfigEntities=serviceConfigEntity.getClusterConfigEntities();
      for (      ClusterConfigEntity clusterConfigEntity : clusterConfigEntities) {
        Config config=allConfigs.get(clusterConfigEntity.getType()).get(clusterConfigEntity.getTag());
        serviceConfigVersionResponse.getConfigurations().add(new ConfigurationResponse(getClusterName(),config.getStackId(),config.getType(),config.getTag(),config.getVersion(),config.getProperties(),config.getPropertiesAttributes(),config.getPropertiesTypes()));
      }
      serviceConfigVersionResponses.add(serviceConfigVersionResponse);
    }
    for (    ServiceConfigVersionResponse serviceConfigVersionResponse : activeServiceConfigResponses.values()) {
      serviceConfigVersionResponse.setIsCurrent(true);
    }
    return serviceConfigVersionResponses;
  }
  finally {
    clusterGlobalLock.readLock().unlock();
  }
}
