{
  clusterGlobalLock.readLock().lock();
  try {
    readWriteLock.readLock().lock();
    try {
      List<ServiceConfigVersionResponse> serviceConfigVersionResponses=new ArrayList<ServiceConfigVersionResponse>();
      Set<Long> activeIds=getActiveServiceConfigVersionIds();
      for (      ServiceConfigEntity serviceConfigEntity : serviceConfigDAO.getServiceConfigs(getClusterId())) {
        ServiceConfigVersionResponse serviceConfigVersionResponse=convertToServiceConfigVersionResponse(serviceConfigEntity);
        serviceConfigVersionResponse.setHosts(serviceConfigEntity.getHostNames());
        serviceConfigVersionResponse.setConfigurations(new ArrayList<ConfigurationResponse>());
        serviceConfigVersionResponse.setIsCurrent(activeIds.contains(serviceConfigEntity.getServiceConfigId()));
        List<ClusterConfigEntity> clusterConfigEntities=serviceConfigEntity.getClusterConfigEntities();
        for (        ClusterConfigEntity clusterConfigEntity : clusterConfigEntities) {
          Config config=allConfigs.get(clusterConfigEntity.getType()).get(clusterConfigEntity.getTag());
          serviceConfigVersionResponse.getConfigurations().add(new ConfigurationResponse(getClusterName(),config.getType(),config.getTag(),config.getVersion(),config.getProperties(),config.getPropertiesAttributes()));
        }
        serviceConfigVersionResponses.add(serviceConfigVersionResponse);
      }
      return serviceConfigVersionResponses;
    }
  finally {
      readWriteLock.readLock().unlock();
    }
  }
  finally {
    clusterGlobalLock.readLock().unlock();
  }
}
