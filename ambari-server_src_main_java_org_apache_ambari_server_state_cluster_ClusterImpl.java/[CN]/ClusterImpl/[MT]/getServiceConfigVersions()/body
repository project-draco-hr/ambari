{
  clusterGlobalLock.readLock().lock();
  try {
    List<ServiceConfigVersionResponse> serviceConfigVersionResponses=new ArrayList<ServiceConfigVersionResponse>();
    Set<Long> activeIds=getActiveServiceConfigVersionIds();
    for (    ServiceConfigEntity serviceConfigEntity : serviceConfigDAO.getServiceConfigs(getClusterId())) {
      ServiceConfigVersionResponse serviceConfigVersionResponse=convertToServiceConfigVersionResponse(serviceConfigEntity);
      serviceConfigVersionResponse.setConfigurations(new ArrayList<ConfigurationResponse>());
      serviceConfigVersionResponse.setIsCurrent(activeIds.contains(serviceConfigEntity.getServiceConfigId()));
      List<ClusterConfigEntity> clusterConfigEntities=serviceConfigEntity.getClusterConfigEntities();
      for (      ClusterConfigEntity clusterConfigEntity : clusterConfigEntities) {
        Config config=allConfigs.get(clusterConfigEntity.getType()).get(clusterConfigEntity.getTag());
        serviceConfigVersionResponse.getConfigurations().add(new ConfigurationResponse(getClusterName(),config.getStackId(),config.getType(),config.getTag(),config.getVersion(),config.getProperties(),config.getPropertiesAttributes(),config.getPropertiesTypes()));
      }
      serviceConfigVersionResponses.add(serviceConfigVersionResponse);
    }
    return serviceConfigVersionResponses;
  }
  finally {
    clusterGlobalLock.readLock().unlock();
  }
}
