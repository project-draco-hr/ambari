{
  String oldName=null;
  clusterGlobalLock.writeLock().lock();
  try {
    ClusterEntity clusterEntity=getClusterEntity();
    if (clusterEntity != null) {
      oldName=clusterEntity.getClusterName();
      clusterEntity.setClusterName(clusterName);
      clusterDAO.merge(clusterEntity);
      clusters.updateClusterName(oldName,clusterName);
      this.clusterName=clusterName;
    }
  }
  finally {
    clusterGlobalLock.writeLock().unlock();
  }
  if (!StringUtils.equals(oldName,clusterName)) {
    ClusterEvent clusterNameChangedEvent=new ClusterEvent(AmbariEventType.CLUSTER_RENAME,clusterId);
    eventPublisher.publish(clusterNameChangedEvent);
  }
}
