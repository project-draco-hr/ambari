{
  String oldName=clusterEntity.getClusterName();
  clusterGlobalLock.writeLock().lock();
  try {
    clusterEntity.setClusterName(clusterName);
    clusterEntity=clusterDAO.merge(clusterEntity);
    clusters.updateClusterName(oldName,clusterName);
  }
  finally {
    clusterGlobalLock.writeLock().unlock();
  }
  if (!StringUtils.equals(oldName,clusterName)) {
    ClusterEvent clusterNameChangedEvent=new ClusterEvent(AmbariEventType.CLUSTER_RENAME,clusterId);
    eventPublisher.publish(clusterNameChangedEvent);
  }
}
