{
  if (configProperiesTypesCache.containsKey(configType)) {
    return configProperiesTypesCache.get(configType);
  }
 else {
    Map<PropertyInfo.PropertyType,Set<String>> propertiesTypes=new HashMap<>();
    try {
      StackId stackId=this.getCurrentStackVersion();
      StackInfo stackInfo=ambariMetaInfo.getStack(stackId.getStackName(),stackId.getStackVersion());
      Collection<ServiceInfo> services=stackInfo.getServices();
      for (      ServiceInfo serviceInfo : services) {
        for (        PropertyInfo propertyInfo : serviceInfo.getProperties()) {
          if (propertyInfo.getFilename().contains(configType) && !propertyInfo.getPropertyTypes().isEmpty()) {
            Set<PropertyInfo.PropertyType> types=propertyInfo.getPropertyTypes();
            for (            PropertyInfo.PropertyType propertyType : types) {
              if (!propertiesTypes.containsKey(propertyType))               propertiesTypes.put(propertyType,new HashSet<String>());
              propertiesTypes.get(propertyType).add(propertyInfo.getName());
            }
          }
        }
      }
    }
 catch (    Exception e) {
    }
    configProperiesTypesCache.put(configType,propertiesTypes);
    return propertiesTypes;
  }
}
