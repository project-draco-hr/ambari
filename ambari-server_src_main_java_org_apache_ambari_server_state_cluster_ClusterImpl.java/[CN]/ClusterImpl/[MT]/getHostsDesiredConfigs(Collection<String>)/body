{
  if (hostnames == null || hostnames.isEmpty()) {
    return Collections.emptyMap();
  }
  List<HostConfigMappingEntity> mappingEntities=hostConfigMappingDAO.findSelectedByHosts(clusterEntity.getClusterId(),hostnames);
  Map<String,Map<String,DesiredConfig>> desiredConfigsByHost=new HashMap<String,Map<String,DesiredConfig>>();
  for (  String hostname : hostnames) {
    desiredConfigsByHost.put(hostname,new HashMap<String,DesiredConfig>());
  }
  for (  HostConfigMappingEntity mappingEntity : mappingEntities) {
    DesiredConfig desiredConfig=new DesiredConfig();
    desiredConfig.setVersion(mappingEntity.getVersion());
    desiredConfig.setServiceName(mappingEntity.getServiceName());
    desiredConfig.setUser(mappingEntity.getUser());
    desiredConfigsByHost.get(mappingEntity.getHostName()).put(mappingEntity.getType(),desiredConfig);
  }
  return desiredConfigsByHost;
}
