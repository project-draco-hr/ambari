{
  clusterGlobalLock.writeLock().lock();
  try {
    if (LOG.isDebugEnabled()) {
      LOG.debug("Changing DesiredStackVersion of Cluster" + ", clusterName=" + getClusterName() + ", clusterId="+ getClusterId()+ ", currentDesiredStackVersion="+ desiredStackVersion+ ", newDesiredStackVersion="+ stackVersion);
    }
    desiredStackVersion=stackVersion;
    clusterEntity.setDesiredStackVersion(gson.toJson(stackVersion));
    clusterDAO.merge(clusterEntity);
    loadServiceConfigTypes();
  }
  finally {
    clusterGlobalLock.writeLock().unlock();
  }
}
