{
  if (null == user) {
    throw new NullPointerException("User must be specified.");
  }
  clusterGlobalLock.writeLock().lock();
  try {
    cachedDesiredConfigs=null;
    ServiceConfigVersionResponse serviceConfigVersionResponse=applyServiceConfigVersion(serviceName,version,user,note);
    configHelper.invalidateStaleConfigsCache();
    return serviceConfigVersionResponse;
  }
  finally {
    clusterGlobalLock.writeLock().unlock();
  }
}
