{
  Multimap<String,String> serviceConfigTypes=HashMultimap.create();
  Map<String,ServiceInfo> serviceInfoMap=null;
  try {
    serviceInfoMap=ambariMetaInfo.getServices(desiredStackVersion.getStackName(),desiredStackVersion.getStackVersion());
  }
 catch (  ParentObjectNotFoundException e) {
    LOG.error("Service config versioning disabled due to exception: ",e);
    return serviceConfigTypes;
  }
  for (  String serviceName : serviceInfoMap.keySet()) {
    Set<PropertyInfo> properties=ambariMetaInfo.getProperties(desiredStackVersion.getStackName(),desiredStackVersion.getStackVersion(),serviceName);
    for (    PropertyInfo property : properties) {
      int extIndex=property.getFilename().indexOf(AmbariMetaInfo.SERVICE_CONFIG_FILE_NAME_POSTFIX);
      String configType=property.getFilename().substring(0,extIndex);
      serviceConfigTypes.put(serviceName,configType);
    }
  }
  return serviceConfigTypes;
}
