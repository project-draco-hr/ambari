{
  if (desiredStackVersionSet) {
    return;
  }
  clusterGlobalLock.writeLock().lock();
  try {
    if (desiredStackVersionSet) {
      return;
    }
    desiredStackVersion=new StackId(getClusterEntity().getDesiredStack());
    if (!StringUtils.isEmpty(desiredStackVersion.getStackName()) && !StringUtils.isEmpty(desiredStackVersion.getStackVersion())) {
      try {
        loadServiceConfigTypes();
      }
 catch (      AmbariException e) {
        throw new RuntimeException(e);
      }
    }
    desiredStackVersionSet=true;
  }
  finally {
    clusterGlobalLock.writeLock().unlock();
  }
}
