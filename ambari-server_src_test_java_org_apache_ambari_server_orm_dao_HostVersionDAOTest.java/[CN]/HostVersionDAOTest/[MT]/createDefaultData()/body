{
  StackEntity stackEntity=stackDAO.find(HDP_22_STACK.getStackName(),HDP_22_STACK.getStackVersion());
  Assert.assertNotNull(stackEntity);
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE);
  resourceTypeEntity.setName(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE_NAME);
  resourceTypeEntity=resourceTypeDAO.merge(resourceTypeEntity);
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setResourceType(resourceTypeEntity);
  ClusterEntity clusterEntity=new ClusterEntity();
  clusterEntity.setClusterName("test_cluster1");
  clusterEntity.setClusterInfo("test_cluster_info1");
  clusterEntity.setResource(resourceEntity);
  clusterEntity.setDesiredStack(stackEntity);
  clusterDAO.create(clusterEntity);
  ClusterVersionEntity clusterVersionEntity=new ClusterVersionEntity(clusterEntity,helper.getOrCreateRepositoryVersion(HDP_22_STACK,"2.2.0.0-995"),RepositoryVersionState.CURRENT,System.currentTimeMillis(),System.currentTimeMillis(),"admin");
  List<ClusterVersionEntity> clusterVersionEntities=new ArrayList<ClusterVersionEntity>();
  clusterVersionEntities.add(clusterVersionEntity);
  clusterEntity.setClusterVersionEntities(clusterVersionEntities);
  clusterVersionDAO.create(clusterVersionEntity);
  clusterDAO.merge(clusterEntity);
  HostEntity host1=new HostEntity();
  HostEntity host2=new HostEntity();
  HostEntity host3=new HostEntity();
  host1.setHostName("test_host1");
  host2.setHostName("test_host2");
  host3.setHostName("test_host3");
  host1.setIpv4("192.168.0.1");
  host2.setIpv4("192.168.0.2");
  host3.setIpv4("192.168.0.3");
  List<HostEntity> hostEntities=new ArrayList<HostEntity>();
  hostEntities.add(host1);
  hostEntities.add(host2);
  hostEntities.add(host3);
  host1.setClusterEntities(Arrays.asList(clusterEntity));
  host2.setClusterEntities(Arrays.asList(clusterEntity));
  host3.setClusterEntities(Arrays.asList(clusterEntity));
  hostDAO.create(host1);
  hostDAO.create(host2);
  hostDAO.create(host3);
  clusterEntity.setHostEntities(hostEntities);
  clusterDAO.merge(clusterEntity);
  HostVersionEntity hostVersionEntity1=new HostVersionEntity(host1.getHostName(),clusterVersionEntity.getRepositoryVersion(),RepositoryVersionState.CURRENT);
  HostVersionEntity hostVersionEntity2=new HostVersionEntity(host2.getHostName(),clusterVersionEntity.getRepositoryVersion(),RepositoryVersionState.INSTALLED);
  HostVersionEntity hostVersionEntity3=new HostVersionEntity(host3.getHostName(),clusterVersionEntity.getRepositoryVersion(),RepositoryVersionState.INSTALLED);
  hostVersionEntity1.setHostEntity(host1);
  hostVersionEntity2.setHostEntity(host2);
  hostVersionEntity3.setHostEntity(host3);
  hostVersionDAO.create(hostVersionEntity1);
  hostVersionDAO.create(hostVersionEntity2);
  hostVersionDAO.create(hostVersionEntity3);
}
