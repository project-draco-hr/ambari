{
  HdfsApi api=null;
  Thread.currentThread().setContextClassLoader(null);
  String defaultFS=context.getProperties().get("webhdfs.url");
  if (defaultFS == null) {
    String message="webhdfs.url is not configured!";
    LOG.error(message);
    throw new MisconfigurationFormattedException("webhdfs.url");
  }
  try {
    api=new HdfsApi(defaultFS,getHdfsUsername(context));
    LOG.info("HdfsApi connected OK");
  }
 catch (  IOException e) {
    String message="HdfsApi IO error: " + e.getMessage();
    LOG.error(message);
    throw new ServiceFormattedException(message,e);
  }
catch (  InterruptedException e) {
    String message="HdfsApi Interrupted error: " + e.getMessage();
    LOG.error(message);
    throw new ServiceFormattedException(message,e);
  }
  return api;
}
