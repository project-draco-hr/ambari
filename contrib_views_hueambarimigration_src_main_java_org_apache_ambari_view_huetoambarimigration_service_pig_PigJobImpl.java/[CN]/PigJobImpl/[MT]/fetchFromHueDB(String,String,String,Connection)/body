{
  int id=0;
  int i=0;
  String[] query=new String[100];
  ArrayList<PojoPig> pigjobarraylist=new ArrayList<PojoPig>();
  try {
    Statement statement=connection.createStatement();
    ResultSet rs1=null;
    if (username.equals("all")) {
    }
 else {
      ResultSet rs=statement.executeQuery("select id from auth_user where username='" + username + "';");
      while (rs.next()) {
        id=rs.getInt("id");
      }
    }
    if (startdate.equals("") && endtime.equals("")) {
      if (username.equals("all")) {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job;");
      }
 else {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job where user_id =" + id + ";");
      }
    }
 else     if (!(startdate.equals("")) && !(endtime.equals(""))) {
      if (username.equals("all")) {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job where start_time >= date('" + startdate + "') AND start_time <= date('"+ endtime+ "');");
      }
 else {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job where user_id =" + id + " AND start_time >= date('"+ startdate+ "') AND start_time <= date('"+ endtime+ "');");
      }
    }
 else     if (!(startdate.equals("")) && (endtime.equals(""))) {
      if (username.equals("all")) {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job where start_time >= date('" + startdate + "');");
      }
 else {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job where user_id =" + id + " AND start_time >= date('"+ startdate+ "');");
      }
    }
 else     if ((startdate.equals("")) && !(endtime.equals(""))) {
      if (username.equals("all")) {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job where start_time <= date('" + endtime + "');");
      }
 else {
        rs1=statement.executeQuery("select status,start_time,statusdir,script_title,user_id from pig_job where user_id =" + id + " AND start_time <= date('"+ endtime+ "');");
      }
    }
    while (rs1.next()) {
      PojoPig pigjjobobject=new PojoPig();
      int runstatus=rs1.getInt("status");
      if (runstatus == 1) {
        pigjjobobject.setStatus("RUNNING");
      }
 else       if (runstatus == 2) {
        pigjjobobject.setStatus("SUCCEEDED");
      }
 else       if (runstatus == 3) {
        pigjjobobject.setStatus("SUBMIT_FAILED");
      }
 else       if (runstatus == 4) {
        pigjjobobject.setStatus("KILLED");
      }
      String title=rs1.getString("script_title");
      pigjjobobject.setTitle(title);
      String dir=rs1.getString("statusdir");
      pigjjobobject.setDir(dir);
      Date created_data=rs1.getDate("start_time");
      pigjjobobject.setDt(created_data);
      pigjobarraylist.add(pigjjobobject);
      i++;
    }
  }
 catch (  SQLException e) {
    logger.error("Sqlexception: ",e);
  }
 finally {
    try {
      if (connection != null)       connection.close();
    }
 catch (    SQLException e) {
      logger.error("Sqlexception in closing the connection: ",e);
    }
  }
  return pigjobarraylist;
}
