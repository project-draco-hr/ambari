{
  InMemoryDefaultTestModule module=new InMemoryDefaultTestModule();
  injector=Guice.createInjector(module);
  injector.getInstance(GuiceJpaInitializer.class);
  StackDefinedPropertyProvider.init(injector);
  clusters=injector.getInstance(Clusters.class);
  clusters.addCluster("c1");
  Cluster cluster=clusters.getCluster("c1");
  StackId stackId=new StackId("HDP-2.0.5");
  cluster.setDesiredStackVersion(stackId);
  cluster.createClusterVersion(stackId.getStackName(),stackId.getStackVersion(),"admin",RepositoryVersionState.CURRENT);
  clusters.addHost("h1");
  Host host=clusters.getHost("h1");
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.3");
  host.setHostAttributes(hostAttributes);
  host.persist();
  clusters.mapHostToCluster("h1","c1");
}
