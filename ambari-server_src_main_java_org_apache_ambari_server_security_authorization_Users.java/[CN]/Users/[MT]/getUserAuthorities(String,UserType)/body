{
  UserEntity userEntity=userDAO.findUserByNameAndType(userName,userType);
  if (userEntity == null) {
    return Collections.emptyList();
  }
  List<PrincipalEntity> principalEntities=new LinkedList<PrincipalEntity>();
  principalEntities.add(userEntity.getPrincipal());
  List<MemberEntity> memberEntities=memberDAO.findAllMembersByUser(userEntity);
  for (  MemberEntity memberEntity : memberEntities) {
    principalEntities.add(memberEntity.getGroup().getPrincipal());
  }
  List<PrivilegeEntity> privilegeEntities=privilegeDAO.findAllByPrincipal(principalEntities);
  Set<AmbariGrantedAuthority> authorities=new HashSet<>(privilegeEntities.size());
  for (  PrivilegeEntity privilegeEntity : privilegeEntities) {
    authorities.add(new AmbariGrantedAuthority(privilegeEntity));
  }
  return authorities;
}
