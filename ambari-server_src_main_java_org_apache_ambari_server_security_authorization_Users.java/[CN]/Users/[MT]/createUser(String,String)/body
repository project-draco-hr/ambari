{
  UserEntity userEntity=new UserEntity();
  userEntity.setUserName(userName);
  userEntity.setUserPassword(passwordEncoder.encode(password));
  userEntity.setRoleEntities(new HashSet<RoleEntity>());
  RoleEntity roleEntity=roleDAO.findByName(getUserRole());
  if (roleEntity == null) {
    createRole(getUserRole());
  }
  roleEntity=roleDAO.findByName(getUserRole());
  userEntity.getRoleEntities().add(roleEntity);
  userDAO.create(userEntity);
  roleEntity.getUserEntities().add(userEntity);
  roleDAO.merge(roleEntity);
}
