{
  Resource r=node.getObject();
  if (r != null) {
    List<ResourceDefinition.PostProcessor> listProcessors=m_mapPostProcessors.get(r.getType());
    for (    ResourceDefinition.PostProcessor processor : listProcessors) {
      processor.process(m_request,node,href);
    }
    href=node.getProperty("href");
    int i=href.indexOf('?');
    if (i != -1) {
      href=href.substring(0,i);
    }
  }
 else {
    String isItemsCollection=node.getProperty("isCollection");
    if (node.getName() == null && "true".equals(isItemsCollection)) {
      node.setName("items");
      node.setProperty("href",href);
    }
  }
  for (  TreeNode<Resource> child : node.getChildren()) {
    processNode(child,href);
  }
  finalizeNode(node);
}
