{
  String url;
  AmbariApi ambariApi=new AmbariApi(context);
  if (ambariApi.isClusterAssociated()) {
    String httpPolicy=ambariApi.getCluster().getConfigurationValue("yarn-site","yarn.http.policy");
    if (httpPolicy.equals(HTTPS_ONLY)) {
      url=ambariApi.getCluster().getConfigurationValue("yarn-site","yarn.resourcemanager.webapp.https.address");
    }
 else {
      url=ambariApi.getCluster().getConfigurationValue("yarn-site","yarn.resourcemanager.webapp.address");
      if (!httpPolicy.equals(HTTP_ONLY))       LOG.error(String.format("R040 Unknown value %s of yarn-site/yarn.http.policy. HTTP_ONLY assumed.",httpPolicy));
    }
  }
 else {
    url=context.getProperties().get("yarn.resourcemanager.url");
  }
  return addProtocolIfMissing(url);
}
