{
  if (!url.matches("^[^:]+://.*$")) {
    AmbariApi ambariApi=new AmbariApi(context);
    if (!ambariApi.isClusterAssociated()) {
      throw new ServiceFormattedException("R030 View is not cluster associated. Resource Manager URL should contain protocol.");
    }
    String httpPolicy=ambariApi.getCluster().getConfigurationValue(YARN_SITE,YARN_HTTP_POLICY);
    if (httpPolicy.equals(HTTPS_ONLY)) {
      url="https://" + url;
    }
 else {
      url="http://" + url;
      if (!httpPolicy.equals(HTTP_ONLY))       LOG.error(String.format("R050 Unknown value %s of yarn-site/yarn.http.policy. HTTP_ONLY assumed.",httpPolicy));
    }
  }
  return url;
}
