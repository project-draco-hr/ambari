{
  final Configuration configuration=EasyMock.createNiceMock(Configuration.class);
  final Users users=EasyMock.createNiceMock(Users.class);
  final AmbariLdapDataPopulator populator=new AmbariLdapDataPopulatorTestInstance(configuration,users);
  EasyMock.expect(configuration.isLdapConfigured()).andReturn(true);
  EasyMock.expect(populator.loadLdapTemplate().search(EasyMock.<String>anyObject(),EasyMock.<String>anyObject(),EasyMock.<AttributesMapper>anyObject())).andThrow(new NullPointerException()).once();
  EasyMock.replay(populator.loadLdapTemplate(),configuration);
  Assert.assertFalse(populator.isLdapEnabled());
  EasyMock.verify(populator.loadLdapTemplate(),configuration);
}
