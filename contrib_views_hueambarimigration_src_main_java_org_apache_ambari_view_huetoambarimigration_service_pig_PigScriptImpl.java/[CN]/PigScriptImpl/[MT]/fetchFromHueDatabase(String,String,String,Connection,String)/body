{
  int id=0;
  int i=0;
  ResultSet rs1=null;
  String[] query=new String[100];
  ArrayList<PojoPig> pigArrayList=new ArrayList<PojoPig>();
  try {
    Statement statement=connection.createStatement();
    if (username.equals("all")) {
    }
 else {
      ResultSet rs=statement.executeQuery("select id from auth_user where username='" + username + "';");
      while (rs.next()) {
        id=rs.getInt("id");
      }
    }
    if (startdate.equals("") && endtime.equals("")) {
      if (username.equals("all")) {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=true;");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1;");
        }
      }
 else {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved='true' AND user_id =" + id + ";");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1 AND user_id =" + id + ";");
        }
      }
    }
 else     if (!(startdate.equals("")) && !(endtime.equals(""))) {
      if (username.equals("all")) {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved='true' AND date_created >= date('" + startdate + "') AND date_created <= date('"+ endtime+ "');");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1 AND date_created >= date('" + startdate + "') AND date_created <= date('"+ endtime+ "');");
        }
      }
 else {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved='true' AND user_id =" + id + " AND date_created >= date('"+ startdate+ "') AND date_created <= date('"+ endtime+ "');");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1 AND user_id =" + id + " AND date_created >= date('"+ startdate+ "') AND date_created <= date('"+ endtime+ "');");
        }
      }
    }
 else     if (!(startdate.equals("")) && (endtime.equals(""))) {
      if (username.equals("all")) {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved='true' AND date_created >= date('" + startdate + "');");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1 AND date_created >= date('" + startdate + "');");
        }
      }
 else {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved='true' AND user_id =" + id + " AND date_created >= date('"+ startdate+ "');");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1 AND user_id =" + id + " AND date_created >= date('"+ startdate+ "');");
        }
      }
    }
 else     if ((startdate.equals("")) && !(endtime.equals(""))) {
      if (username.equals("all")) {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved='true' AND date_created <= date('" + endtime + "');");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1 AND date_created <= date('" + endtime + "');");
        }
      }
 else {
        if (driverName.contains("postgresql")) {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved='true' AND user_id =" + id + " AND date_created <= date('"+ endtime+ "');");
        }
 else {
          rs1=statement.executeQuery("select pig_script,title,date_created,saved,arguments from pig_pigscript where saved=1 AND user_id =" + id + " AND date_created <= date('"+ endtime+ "');");
        }
      }
    }
    while (rs1.next()) {
      PojoPig pojopig=new PojoPig();
      String script=rs1.getString("pig_script");
      String title=rs1.getString("title");
      Date created_data=rs1.getDate("date_created");
      pojopig.setDt(created_data);
      pojopig.setScript(script);
      pojopig.setTitle(title);
      pigArrayList.add(pojopig);
      i++;
    }
  }
 catch (  SQLException e) {
    logger.error("SQLException",e);
  }
 finally {
    try {
      if (connection != null)       connection.close();
    }
 catch (    SQLException e) {
      logger.error("SQLException",e);
    }
  }
  return pigArrayList;
}
