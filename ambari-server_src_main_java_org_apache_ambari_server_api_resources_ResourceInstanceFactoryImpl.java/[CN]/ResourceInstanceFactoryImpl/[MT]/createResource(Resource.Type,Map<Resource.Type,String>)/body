{
  ResourceDefinition resourceDefinition;
switch (type) {
case Cluster:
    resourceDefinition=new ClusterResourceDefinition();
  break;
case Service:
resourceDefinition=new ServiceResourceDefinition();
break;
case Host:
resourceDefinition=mapIds.containsKey(Resource.Type.Cluster) ? new HostResourceDefinition() : new DetachedHostResourceDefinition();
break;
case Component:
resourceDefinition=new ComponentResourceDefinition();
break;
case HostComponent:
resourceDefinition=new HostComponentResourceDefinition();
break;
case Action:
resourceDefinition=new ActionResourceDefinition();
break;
case Configuration:
resourceDefinition=new ConfigurationResourceDefinition();
break;
case Task:
resourceDefinition=new TaskResourceDefinition();
break;
case User:
resourceDefinition=new UserResourceDefinition();
break;
case Request:
resourceDefinition=new RequestResourceDefinition();
break;
default :
throw new IllegalArgumentException("Unsupported resource type: " + type);
}
return new ResourceInstanceImpl(mapIds,resourceDefinition,this);
}
