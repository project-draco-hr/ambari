{
  Capture<DBAccessor.DBColumnInfo> capturedColumnInfo=newCapture();
  Capture<DBAccessor.DBColumnInfo> capturedScColumnInfo=newCapture();
  final DBAccessor dbAccessor=createStrictMock(DBAccessor.class);
  Configuration configuration=createNiceMock(Configuration.class);
  Connection connection=createNiceMock(Connection.class);
  Statement statement=createNiceMock(Statement.class);
  ResultSet resultSet=createNiceMock(ResultSet.class);
  Capture<List<DBAccessor.DBColumnInfo>> capturedSettingColumns=EasyMock.newCapture();
  dbAccessor.addColumn(eq("adminpermission"),capture(capturedColumnInfo));
  dbAccessor.addColumn(eq(UpgradeCatalog240.SERVICE_COMPONENT_DESIRED_STATE_TABLE),capture(capturedScColumnInfo));
  dbAccessor.createTable(eq("setting"),capture(capturedSettingColumns),eq("id"));
  expect(configuration.getDatabaseUrl()).andReturn(Configuration.JDBC_IN_MEMORY_URL).anyTimes();
  expect(dbAccessor.getConnection()).andReturn(connection);
  expect(connection.createStatement()).andReturn(statement);
  expect(statement.executeQuery(anyObject(String.class))).andReturn(resultSet);
  replay(dbAccessor);
  Module module=new Module(){
    @Override public void configure(    Binder binder){
      binder.bind(DBAccessor.class).toInstance(dbAccessor);
      binder.bind(OsFamily.class).toInstance(createNiceMock(OsFamily.class));
      binder.bind(EntityManager.class).toInstance(entityManager);
    }
  }
;
  Injector injector=Guice.createInjector(module);
  UpgradeCatalog240 upgradeCatalog240=injector.getInstance(UpgradeCatalog240.class);
  upgradeCatalog240.executeDDLUpdates();
  DBAccessor.DBColumnInfo columnInfo=capturedColumnInfo.getValue();
  Assert.assertNotNull(columnInfo);
  Assert.assertEquals(UpgradeCatalog240.SORT_ORDER_COL,columnInfo.getName());
  Assert.assertEquals(null,columnInfo.getLength());
  Assert.assertEquals(Short.class,columnInfo.getType());
  Assert.assertEquals(1,columnInfo.getDefaultValue());
  Assert.assertEquals(false,columnInfo.isNullable());
  DBAccessor.DBColumnInfo columnScInfo=capturedScColumnInfo.getValue();
  Assert.assertNotNull(columnScInfo);
  Assert.assertEquals(UpgradeCatalog240.RECOVERY_ENABLED_COL,columnScInfo.getName());
  Assert.assertEquals(null,columnScInfo.getLength());
  Assert.assertEquals(Short.class,columnScInfo.getType());
  Assert.assertEquals(0,columnScInfo.getDefaultValue());
  Assert.assertEquals(false,columnScInfo.isNullable());
  Map<String,Class> expectedCaptures=new HashMap<>();
  expectedCaptures.put("id",Long.class);
  expectedCaptures.put("name",String.class);
  expectedCaptures.put("setting_type",String.class);
  expectedCaptures.put("content",String.class);
  expectedCaptures.put("updated_by",String.class);
  expectedCaptures.put("update_timestamp",Long.class);
  Map<String,Class> actualCaptures=new HashMap<>();
  for (  DBAccessor.DBColumnInfo settingColumnInfo : capturedSettingColumns.getValue()) {
    actualCaptures.put(settingColumnInfo.getName(),settingColumnInfo.getType());
  }
  assertEquals(expectedCaptures,actualCaptures);
  verify(dbAccessor);
}
