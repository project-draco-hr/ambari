{
  String str="[ " + "{\"col1\": \"d\", \n\"col2\": \"abcd\"  }" + "]";
  StringReader sr=new StringReader(str);
  ParseOptions parseOptions=new ParseOptions();
  parseOptions.setOption(ParseOptions.OPTIONS_FILE_TYPE,ParseOptions.InputFileType.JSON.toString());
  parseOptions.setOption(ParseOptions.OPTIONS_HEADER,ParseOptions.HEADER.EMBEDDED.toString());
  DataParser dp=null;
  try {
    dp=new DataParser(sr,parseOptions);
    PreviewData pd=dp.parsePreview();
    Assert.assertNotNull(pd.getPreviewRows());
    Assert.assertNotNull(pd.getHeader());
    Assert.assertEquals(1,pd.getPreviewRows().size());
    Assert.assertEquals(2,pd.getHeader().size());
    ColumnDescription[] cd={new ColumnDescriptionImpl("col1",ColumnDescriptionShort.DataTypes.CHAR.toString(),0),new ColumnDescriptionImpl("col2",ColumnDescriptionShort.DataTypes.STRING.toString(),1)};
    Object cols1[]=new Object[2];
    cols1[0]="d";
    cols1[1]="abcd";
    Row row1=new Row(cols1);
    Row[] rows={row1};
    Assert.assertArrayEquals("Header Not Correct.",cd,pd.getHeader().toArray());
    Assert.assertArrayEquals("Rows Not Correct.",rows,pd.getPreviewRows().toArray());
  }
  finally {
    if (null != dp)     dp.close();
    sr.close();
  }
}
