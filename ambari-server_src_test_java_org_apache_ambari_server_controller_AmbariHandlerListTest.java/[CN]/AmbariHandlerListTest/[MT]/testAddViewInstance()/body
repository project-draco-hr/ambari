{
  ViewInstanceEntity viewInstanceEntity=ViewInstanceEntityTest.getViewInstanceEntity();
  final Handler handler=createNiceMock(Handler.class);
  Server server=createNiceMock(Server.class);
  expect(handler.getServer()).andReturn(server);
  handler.setServer(null);
  replay(handler,server);
  AmbariHandlerList.HandlerFactory handlerFactory=new AmbariHandlerList.HandlerFactory(){
    @Override public Handler create(    ViewInstanceEntity viewInstanceDefinition,    String webApp,    String contextPath){
      return handler;
    }
  }
;
  AmbariHandlerList handlerList=new AmbariHandlerList(handlerFactory);
  handlerList.addViewInstance(viewInstanceEntity);
  ArrayList<Handler> handlers=new ArrayList<Handler>(Arrays.asList(handlerList.getHandlers()));
  Assert.assertTrue(handlers.contains(handler));
  verify(handler,server);
}
