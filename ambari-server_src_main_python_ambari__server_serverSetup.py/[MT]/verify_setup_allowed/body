def verify_setup_allowed():
    if get_silent():
        properties = get_ambari_properties()
        if (properties == (-1)):
            print_error_msg('Error getting ambari properties')
            return (-1)
        isSecure = get_is_secure(properties)
        if isSecure:
            (isPersisted, masterKeyFile) = get_is_persisted(properties)
            if (not isPersisted):
                print "ERROR: Cannot run silent 'setup' with password encryption enabled and Master Key not persisted."
                print "Ambari Server 'setup' exiting."
                return 1
    return 0
