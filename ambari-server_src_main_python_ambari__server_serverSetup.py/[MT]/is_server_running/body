def is_server_running(serviceClass):
    from ambari_commons.os_windows import SERVICE_STATUS_STARTING, SERVICE_STATUS_RUNNING, SERVICE_STATUS_STOPPING, SERVICE_STATUS_STOPPED, SERVICE_STATUS_NOT_INSTALLED
    statusStr = serviceClass.QueryStatus()
    if (statusStr in (SERVICE_STATUS_STARTING, SERVICE_STATUS_RUNNING, SERVICE_STATUS_STOPPING)):
        return (True, '')
    elif (statusStr == SERVICE_STATUS_STOPPED):
        return (False, SERVICE_STATUS_STOPPED)
    elif (statusStr == SERVICE_STATUS_NOT_INSTALLED):
        return (False, SERVICE_STATUS_NOT_INSTALLED)
    else:
        return (False, None)
