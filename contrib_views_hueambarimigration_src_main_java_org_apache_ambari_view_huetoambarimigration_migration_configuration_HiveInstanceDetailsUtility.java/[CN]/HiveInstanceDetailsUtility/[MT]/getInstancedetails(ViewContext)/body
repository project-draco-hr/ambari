{
  List<InstanceModel> instancelist=new ArrayList<>();
  Connection conn=null;
  conn=DataSourceAmbariDatabase.getInstance(view.getProperties().get("ambaridrivername"),view.getProperties().get("ambarijdbcurl"),view.getProperties().get("ambaridbusername"),view.getProperties().get("ambaridbpassword")).getConnection();
  conn.setAutoCommit(false);
  PreparedStatement prSt;
  QuerySetAmbariDB ambaridatabase=null;
  if (view.getProperties().get("ambaridrivername").contains("mysql")) {
    ambaridatabase=new MysqlQuerySetAmbariDB();
  }
 else   if (view.getProperties().get("ambaridrivername").contains("postgresql")) {
    ambaridatabase=new PostgressQuerySetAmbariDB();
  }
 else   if (view.getProperties().get("ambaridrivername").contains("oracle")) {
    ambaridatabase=new OracleQuerySetAmbariDB();
  }
  ResultSet rs1=null;
  prSt=ambaridatabase.getHiveInstanceDeatil(conn);
  rs1=prSt.executeQuery();
  int i=0;
  while (rs1.next()) {
    InstanceModel I=new InstanceModel();
    I.setInstanceName(rs1.getString(1));
    I.setId(i);
    instancelist.add(I);
    i++;
  }
  return instancelist;
}
