@OsFamilyFuncImpl(os_family=OSConst.WINSRV_FAMILY)
def yarn(name=None):
    import params
    XmlConfig('mapred-site.xml', conf_dir=params.config_dir, configurations=params.config['configurations']['mapred-site'], owner=params.yarn_user, mode='f')
    XmlConfig('yarn-site.xml', conf_dir=params.config_dir, configurations=params.config['configurations']['yarn-site'], owner=params.yarn_user, mode='f', configuration_attributes=params.config['configuration_attributes']['yarn-site'])
    XmlConfig('capacity-scheduler.xml', conf_dir=params.config_dir, configurations=params.config['configurations']['capacity-scheduler'], owner=params.yarn_user, mode='f')
    if params.service_map.has_key(name):
        service_name = params.service_map[name]
        ServiceConfig(service_name, action='change_user', username=params.yarn_user, password=Script.get_password(params.yarn_user))
