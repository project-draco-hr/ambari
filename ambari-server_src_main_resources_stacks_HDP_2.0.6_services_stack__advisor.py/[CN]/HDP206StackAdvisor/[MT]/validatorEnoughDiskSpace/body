def validatorEnoughDiskSpace(self, properties, propertyName, hostInfo, reqiuredDiskSpace):
    if (not (propertyName in properties)):
        return self.getErrorItem('Value should be set')
    dir = properties[propertyName]
    if dir.startswith('hdfs://'):
        return None
    dir = re.sub('^file://', '', dir, count=1)
    mountPoints = {}
    for mountPoint in hostInfo['disk_info']:
        mountPoints[mountPoint['mountpoint']] = to_number(mountPoint['available'])
    mountPoint = getMountPointForDir(dir, mountPoints.keys())
    if (mountPoints[mountPoint] < reqiuredDiskSpace):
        return self.getWarnItem('Recommended disk space for partition {0} is {1}k'.format(mountPoint, reqiuredDiskSpace))
    return None
