{
  TimelineMetrics timelineMetrics=null;
  LOG.debug("Metrics request url = " + spec);
  BufferedReader reader=null;
  try {
    reader=new BufferedReader(new InputStreamReader(streamProvider.readFrom(spec)));
    timelineMetrics=timelineObjectReader.readValue(reader);
    LOG.debug("Timeline metrics response => " + timelineMetrics);
  }
 catch (  IOException io) {
    String errorMsg="Error getting timeline metrics.";
    if (LOG.isDebugEnabled()) {
      LOG.error(errorMsg,io);
    }
 else {
      if (io instanceof SocketTimeoutException) {
        errorMsg+=" Can not connect to collector, socket error.";
      }
      LOG.error(errorMsg);
    }
  }
 finally {
    if (reader != null) {
      try {
        reader.close();
      }
 catch (      IOException e) {
        if (LOG.isWarnEnabled()) {
          if (LOG.isDebugEnabled()) {
            LOG.warn("Unable to close http input stream : spec=" + spec,e);
          }
 else {
            LOG.warn("Unable to close http input stream : spec=" + spec);
          }
        }
      }
    }
  }
  return timelineMetrics;
}
