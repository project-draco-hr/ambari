{
  String metricsParam=getSetString(processRegexps(metrics.keySet()),-1);
  uriBuilder.removeQuery();
  if (metricsParam.length() > 0) {
    uriBuilder.setParameter("metricNames",metricsParam);
  }
  if (hostname != null && !hostname.isEmpty() && !hostname.equals(dummyHostName)) {
    uriBuilder.setParameter("hostname",hostname);
  }
  String componentName=getComponentName(resource);
  if (componentName != null && !componentName.isEmpty()) {
    if (TIMELINE_APPID_MAP.containsKey(componentName)) {
      componentName=TIMELINE_APPID_MAP.get(componentName);
    }
    uriBuilder.setParameter("appId",componentName);
  }
  if (temporalInfo != null) {
    long startTime=temporalInfo.getStartTime();
    if (startTime != -1) {
      uriBuilder.setParameter("startTime",String.valueOf(startTime));
    }
    long endTime=temporalInfo.getEndTime();
    if (endTime != -1) {
      uriBuilder.setParameter("endTime",String.valueOf(endTime));
    }
  }
  return uriBuilder.toString();
}
