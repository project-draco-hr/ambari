{
  if (isCacheInitialized) {
    return;
  }
  System.setProperty("net.sf.ehcache.skipUpdateCheck","true");
  net.sf.ehcache.config.Configuration managerConfig=new net.sf.ehcache.config.Configuration();
  managerConfig.setMaxBytesLocalHeap(configuration.getMetricsCacheManagerHeapPercent());
  CacheManager manager=CacheManager.create(managerConfig);
  LOG.info("Creating Metrics Cache with timeouts => ttl = " + configuration.getMetricCacheTTLSeconds() + ", idle = "+ configuration.getMetricCacheIdleSeconds());
  PersistenceConfiguration persistenceConfiguration=new PersistenceConfiguration();
  persistenceConfiguration.setStrategy(Strategy.NONE.name());
  CacheConfiguration cacheConfiguration=new CacheConfiguration().name(TIMELINE_METRIC_CACHE_INSTANCE_NAME).timeToLiveSeconds(configuration.getMetricCacheTTLSeconds()).timeToIdleSeconds(configuration.getMetricCacheIdleSeconds()).memoryStoreEvictionPolicy(MemoryStoreEvictionPolicy.LRU).eternal(false).persistence(persistenceConfiguration);
  Cache cache=new Cache(cacheConfiguration);
  timelineMetricsCache=new TimelineMetricCache(cache,cacheEntryFactory);
  LOG.info("Registering metrics cache with provider: name = " + cache.getName() + ", guid: "+ cache.getGuid());
  manager.addCache(timelineMetricsCache);
  isCacheInitialized=true;
}
