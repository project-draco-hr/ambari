def prepare_upgrade_enter_safe_mode(hdfs_binary):
    '\n  During a NonRolling (aka Express Upgrade), preparing the NameNode requires first entering Safemode.\n  :param hdfs_binary: name/path of the HDFS binary to use\n  '
    import params
    safe_mode_enter_cmd = format('{hdfs_binary} dfsadmin -safemode enter')
    safe_mode_enter_and_check_for_on = format("{safe_mode_enter_cmd} | grep 'Safe mode is ON'")
    try:
        Logger.info('Enter SafeMode if not already in it.')
        as_user(safe_mode_enter_and_check_for_on, params.hdfs_user, env={'PATH': params.hadoop_bin_dir, })
    except Exception as e:
        message = format('Could not enter safemode. As the HDFS user, call this command: {safe_mode_enter_cmd}')
        Logger.error(message)
        raise Fail(message)
