def prepare_upgrade_enter_safe_mode(hdfs_binary):
    '\n  During a NonRolling (aka Express Upgrade), preparing the NameNode requires first entering Safemode.\n  :param hdfs_binary: name/path of the HDFS binary to use\n  '
    import params
    safe_mode_enter_cmd = format('{hdfs_binary} dfsadmin -safemode enter')
    try:
        desired_state = SafeMode.ON
        (safemode_transition_successful, original_state) = reach_safemode_state(params.hdfs_user, desired_state, params.dfs_ha_enabled, hdfs_binary)
        if (not safemode_transition_successful):
            raise Fail(('Could not transition to safemode state %s. Please check logs to make sure namenode is up.' % str(desired_state)))
    except Exception as e:
        message = format('Could not enter safemode. As the HDFS user, call this command: {safe_mode_enter_cmd}')
        Logger.error(message)
        raise Fail(message)
