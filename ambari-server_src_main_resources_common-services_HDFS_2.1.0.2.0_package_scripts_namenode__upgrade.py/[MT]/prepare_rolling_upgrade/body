def prepare_rolling_upgrade():
    '\n  Rolling Upgrade for HDFS Namenode requires the following.\n  0. Namenode must be up\n  1. Leave safemode if the safemode status is not OFF\n  2. Execute a rolling upgrade "prepare"\n  3. Execute a rolling upgrade "query"\n  '
    Logger.info('Executing Rolling Upgrade prepare')
    import params
    if params.security_enabled:
        Execute(format('{params.kinit_path_local} -kt {params.hdfs_user_keytab} {params.hdfs_principal_name}'))
    (safemode_transition_successful, original_state) = reach_safemode_state(params.hdfs_user, SafeMode.OFF, True)
    if (not safemode_transition_successful):
        raise Fail(('Could not transition to safemode state %s. Please check logs to make sure namenode is up.' % str(SafeMode.OFF)))
    prepare = 'hdfs dfsadmin -rollingUpgrade prepare'
    query = 'hdfs dfsadmin -rollingUpgrade query'
    Execute(prepare, user=params.hdfs_user, logoutput=True)
    Execute(query, user=params.hdfs_user, logoutput=True)
