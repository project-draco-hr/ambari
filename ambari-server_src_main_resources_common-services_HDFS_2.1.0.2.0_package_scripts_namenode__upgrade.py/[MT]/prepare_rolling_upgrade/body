def prepare_rolling_upgrade():
    '\n  Rolling Upgrade for HDFS Namenode requires the following.\n  0. Namenode must be up\n  1. Leave safemode if the safemode status is not OFF\n  2. Execute a rolling upgrade "prepare"\n  3. Execute a rolling upgrade "query"\n  '
    Logger.info('Executing Rolling Upgrade prepare')
    import params
    user = (params.hdfs_principal_name if params.security_enabled else params.hdfs_user)
    if params.security_enabled:
        Execute(format('{kinit_path_local} -kt {hdfs_user_keytab} {hdfs_principal_name}'), user=user)
    safemode_transition_successful = reach_safemode_state(user, SAFEMODE.OFF, True)
    if (not safemode_transition_successful):
        raise Fail(('Could not transition to safemode state %s. Please check logs to make sure namenode is up.' % str(SAFEMODE.OFF)))
    prepare = 'hdfs dfsadmin -rollingUpgrade prepare'
    query = 'hdfs dfsadmin -rollingUpgrade query'
    Execute(prepare, user=user, logoutput=True)
    Execute(query, user=user, logoutput=True)
