def finalize_rolling_upgrade():
    '\n  Finalize the Namenode upgrade, at which point it cannot be downgraded.\n  '
    Logger.info('Executing Rolling Upgrade finalize')
    import params
    if params.security_enabled:
        Execute(format('{params.kinit_path_local} -kt {params.hdfs_user_keytab} {params.hdfs_principal_name}'))
    finalize_cmd = 'hdfs dfsadmin -rollingUpgrade finalize'
    Execute(finalize_cmd, user=params.hdfs_user, logoutput=True)
    safemode_transition_successful = reach_safemode_state(params.hdfs_user, SAFEMODE.OFF, True)
    if (not safemode_transition_successful):
        Logger.warning('Could leave safemode')
