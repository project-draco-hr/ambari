def finalize_rolling_upgrade():
    '\n  Finalize the Namenode upgrade, at which point it cannot be downgraded.\n  '
    Logger.info('Executing Rolling Upgrade finalize')
    import params
    if params.security_enabled:
        kinit_command = format('{params.kinit_path_local} -kt {params.hdfs_user_keytab} {params.hdfs_principal_name}')
        Execute(kinit_command, user=params.hdfs_user, logoutput=True)
    finalize_cmd = 'hdfs dfsadmin -rollingUpgrade finalize'
    query_cmd = 'hdfs dfsadmin -rollingUpgrade query'
    Execute(query_cmd, user=params.hdfs_user, logoutput=True)
    Execute(finalize_cmd, user=params.hdfs_user, logoutput=True)
    Execute(query_cmd, user=params.hdfs_user, logoutput=True)
