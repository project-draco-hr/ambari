def finalize_rolling_upgrade():
    '\n  Finalize the Namenode upgrade, at which point it cannot be downgraded.\n  '
    Logger.info('Executing Rolling Upgrade finalize')
    import params
    secure_user = (params.hdfs_principal_name if params.security_enabled else params.hdfs_user)
    finalize_cmd = 'hdfs dfsadmin -rollingUpgrade finalize'
    Execute(finalize_cmd, user=secure_user, logoutput=True)
    safemode_transition_successful = reach_safemode_state(secure_user, SAFEMODE.OFF, True)
    if (not safemode_transition_successful):
        Logger.warning('Could leave safemode')
