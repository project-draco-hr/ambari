{
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  metaInfo=injector.getInstance(AmbariMetaInfo.class);
  configFactory=injector.getInstance(ConfigFactory.class);
  configGroupFactory=injector.getInstance(ConfigGroupFactory.class);
  hostDAO=injector.getInstance(HostDAO.class);
  configGroupDAO=injector.getInstance(ConfigGroupDAO.class);
  configGroupHostMappingDAO=injector.getInstance(ConfigGroupHostMappingDAO.class);
  metaInfo.init();
  clusterName="foo";
  clusters.addCluster(clusterName);
  cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-0.1"));
  Assert.assertNotNull(cluster);
  clusters.addHost("h1");
  clusters.addHost("h2");
  Assert.assertNotNull(clusters.getHost("h1"));
  Assert.assertNotNull(clusters.getHost("h2"));
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
}
