def install(self, cluster, role, packages, dryRun, result):
    try:
        for package in packages:
            packageName = package['name']
            if (string.find(packageName, '.torrent') > 0):
                self.torrentInstall(cluster, role, packageName, dryRun)
            elif ((string.find(packageName, '.tar.gz') > 0) or (string.find(packageName, '.tgz') > 0)):
                packageName = self.tarballDownload(packageName)
                self.tarballInstall(cluster, role, packageName)
            elif ((string.find(packageName, '.rpm') > 0) and ((string.find(packageName, 'http://') == 0) or (string.find(packageName, 'https://') == 0))):
                rpmName = self.rpmDownload(packageName)
                list = [rpmName]
                test = self.rpmInstall(list)
                if (test['exit_code'] != 0):
                    raise Exception(test['error'])
            elif (string.find(packageName, 'yum:///') == 0):
                packageName = packageName[7:]
                self.yumInstall(packageName, dryRun)
            else:
                raise Exception(('Unknown package hanlding type:' + packageName))
        result['exitCode'] = 0
        result['output'] = 'Install Successfully'
    except Exception as err:
        logger.exception(str(err))
        result['exitCode'] = 0
        result['output'] = (packageName + ' installation failed')
        result['error'] = str(err)
    return result
