{
  String connectUrl=getCollectorUri();
  try {
    String jsonData=mapper.writeValueAsString(metrics);
    SocketAddress socketAddress=getServerSocketAddress();
    if (socketAddress != null) {
      StringRequestEntity requestEntity=new StringRequestEntity(jsonData,"application/json","UTF-8");
      PostMethod postMethod=new PostMethod(connectUrl);
      postMethod.setRequestEntity(requestEntity);
      int statusCode=httpClient.executeMethod(postMethod);
      if (statusCode != 200) {
        LOG.info("Unable to POST metrics to collector, " + connectUrl);
      }
 else {
        LOG.debug("Metrics posted to Collector " + connectUrl);
      }
    }
  }
 catch (  ConnectException e) {
    throw new UnableToConnectException(e).setConnectUrl(connectUrl);
  }
}
