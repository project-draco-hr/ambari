def validateHiveServer2Configurations(self, properties, recommendedDefaults, configurations, services, hosts):
    hive_server2 = properties
    validationItems = []
    ranger_plugin_properties = getSiteProperties(configurations, 'ranger-hive-plugin-properties')
    hive_env_properties = getSiteProperties(configurations, 'hive-env')
    ranger_plugin_enabled = (('hive_security_authorization' in hive_env_properties) and (hive_env_properties['hive_security_authorization'].lower() == 'ranger'))
    servicesList = [service['StackServices']['service_name'] for service in services['services']]
    if ('RANGER' in servicesList):
        if ranger_plugin_enabled:
            prop_name = 'hive.security.authorization.manager'
            prop_val = 'com.xasecure.authorization.hive.authorizer.XaSecureHiveAuthorizerFactory'
            if ((prop_name not in hive_server2) or (hive_server2[prop_name] != prop_val)):
                validationItems.append({'config-name': prop_name, 'item': self.getWarnItem('If Ranger Hive Plugin is enabled. {0} needs to be set to {1}'.format(prop_name, prop_val)), })
            prop_name = 'hive.security.authenticator.manager'
            prop_val = 'org.apache.hadoop.hive.ql.security.SessionStateUserAuthenticator'
            if ((prop_name not in hive_server2) or (hive_server2[prop_name] != prop_val)):
                validationItems.append({'config-name': prop_name, 'item': self.getWarnItem('If Ranger Hive Plugin is enabled. {0} needs to be set to {1}'.format(prop_name, prop_val)), })
        elif (not ranger_plugin_enabled):
            prop_name = 'hive.security.authorization.manager'
            prop_val = 'org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory'
            if ((prop_name in hive_server2) and (hive_server2[prop_name] != prop_val)):
                validationItems.append({'config-name': prop_name, 'item': self.getWarnItem('If Ranger Hive Plugin is disabled. {0} needs to be set to {1}'.format(prop_name, prop_val)), })
            prop_name = 'hive.security.authenticator.manager'
            prop_val = 'org.apache.hadoop.hive.ql.security.SessionStateUserAuthenticator'
            if ((prop_name in hive_server2) and (hive_server2[prop_name] != prop_val)):
                validationItems.append({'config-name': prop_name, 'item': self.getWarnItem('If Ranger Hive Plugin is disabled. {0} needs to be set to {1}'.format(prop_name, prop_val)), })
    return self.toConfigurationValidationProblems(validationItems, 'hiveserver2-site')
