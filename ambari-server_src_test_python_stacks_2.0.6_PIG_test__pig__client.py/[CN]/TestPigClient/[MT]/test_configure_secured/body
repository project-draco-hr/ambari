def test_configure_secured(self):
    self.executeScript('2.0.6/services/PIG/package/scripts/pig_client.py', classname='PigClient', command='configure', config_file='secured.json')
    self.assertResourceCalled('Directory', '/etc/pig/conf', owner='hdfs', group='hadoop')
    self.assertResourceCalled('TemplateConfig', '/etc/pig/conf/pig-env.sh', owner='hdfs')
    self.assertResourceCalled('TemplateConfig', '/etc/pig/conf/pig.properties', owner='hdfs')
    self.assertResourceCalled('PropertiesFile', 'log4j.properties', owner='hdfs', group='hadoop', mode=436, dir='/etc/pig/conf', properties=self.getConfig()['configurations']['pig-log4j'])
    self.assertNoMoreResources()
