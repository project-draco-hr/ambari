{
  ExecutionCommand executionCommand=new ExecutionCommand();
  Map<String,String> hlp=new HashMap<String,String>();
  hlp.put("custom_command","SET_KEYTAB");
  executionCommand.setHostLevelParams(hlp);
  Map<String,String> commandparams=new HashMap<String,String>();
  commandparams.put(KerberosServerAction.DATA_DIRECTORY,dataDir);
  executionCommand.setCommandParams(commandparams);
  HeartBeatHandler.injectKeytab(executionCommand,"c6403.ambari.apache.org");
  List<Map<String,String>> kcp=executionCommand.getKerberosCommandParams();
  Assert.assertEquals("c6403.ambari.apache.org",kcp.get(0).get(KerberosActionDataFile.HOSTNAME));
  Assert.assertEquals("HDFS",kcp.get(0).get(KerberosActionDataFile.SERVICE));
  Assert.assertEquals("DATANODE",kcp.get(0).get(KerberosActionDataFile.COMPONENT));
  Assert.assertEquals("dn/_HOST@_REALM",kcp.get(0).get(KerberosActionDataFile.PRINCIPAL));
  Assert.assertEquals("hdfs-site/dfs.namenode.kerberos.principal",kcp.get(0).get(KerberosActionDataFile.PRINCIPAL_CONFIGURATION));
  Assert.assertEquals("/etc/security/keytabs/dn.service.keytab",kcp.get(0).get(KerberosActionDataFile.KEYTAB_FILE_PATH));
  Assert.assertEquals("hdfs",kcp.get(0).get(KerberosActionDataFile.KEYTAB_FILE_OWNER_NAME));
  Assert.assertEquals("r",kcp.get(0).get(KerberosActionDataFile.KEYTAB_FILE_OWNER_ACCESS));
  Assert.assertEquals("hadoop",kcp.get(0).get(KerberosActionDataFile.KEYTAB_FILE_GROUP_NAME));
  Assert.assertEquals("",kcp.get(0).get(KerberosActionDataFile.KEYTAB_FILE_GROUP_ACCESS));
  Assert.assertEquals("hdfs-site/dfs.namenode.keytab.file",kcp.get(0).get(KerberosActionDataFile.KEYTAB_FILE_CONFIGURATION));
  Assert.assertEquals(Base64.encodeBase64String("hello".getBytes()),kcp.get(0).get(KerberosServerAction.KEYTAB_CONTENT_BASE64));
}
