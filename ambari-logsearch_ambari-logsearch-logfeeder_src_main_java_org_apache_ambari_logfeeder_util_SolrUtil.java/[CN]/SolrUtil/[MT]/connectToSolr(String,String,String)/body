{
  this.collectionName=collection;
  solrDetail="zkHosts=" + zkHosts + ", collection="+ collection+ ", url="+ url;
  logger.info("connectToSolr() " + solrDetail);
  if (collection == null || collection.isEmpty()) {
    throw new Exception("For solr, collection name is mandatory. " + solrDetail);
  }
  if (zkHosts != null && !zkHosts.isEmpty()) {
    solrDetail="zkHosts=" + zkHosts + ", collection="+ collection;
    logger.info("Using zookeepr. " + solrDetail);
    solrClouldClient=new CloudSolrClient(zkHosts);
    solrClouldClient.setDefaultCollection(collection);
    solrClient=solrClouldClient;
    int waitDurationMS=3 * 60 * 1000;
    checkSolrStatus(waitDurationMS);
  }
 else {
    if (url == null || url.trim().isEmpty()) {
      throw new Exception("Both zkHosts and URL are empty. zkHosts=" + zkHosts + ", collection="+ collection+ ", url="+ url);
    }
    solrDetail="collection=" + collection + ", url="+ url;
    String collectionURL=url + "/" + collection;
    logger.info("Connecting to  solr : " + collectionURL);
    solrClient=new HttpSolrClient(collectionURL);
  }
  return solrClient;
}
