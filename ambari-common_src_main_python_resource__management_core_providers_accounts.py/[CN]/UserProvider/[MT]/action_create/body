def action_create(self):
    if (not self.user):
        command = ['useradd', '-m']
        Logger.info(('Adding user %s' % self.resource))
    else:
        command = ['usermod']
        Logger.info(('Modifying user %s' % self.resource.username))
    options = dict(comment='-c', gid='-g', uid='-u', shell='-s', password='-p', home='-d')
    if (self.resource.system and (not self.user)):
        command.append('--system')
    if self.resource.groups:
        groups = self.resource.groups
        if (self.user and self.user_groups):
            groups += self.user_groups
        command += ['-G', ','.join(groups)]
    for (option_name, option_flag) in options.items():
        option_value = getattr(self.resource, option_name)
        if (option_flag and option_value):
            command += [option_flag, str(option_value)]
    if (self.user and (len(command) == 1)):
        return
    command.append(self.resource.username)
    shell.checked_call(command, sudo=True)
