{
  this.stateMachine=stateMachineFactory.make(this);
  rwLock=new ReentrantReadWriteLock();
  this.readLock=rwLock.readLock();
  this.writeLock=rwLock.writeLock();
  this.hostEntity=hostEntity;
  this.injector=injector;
  this.persisted=persisted;
  this.hostDAO=injector.getInstance(HostDAO.class);
  this.hostStateDAO=injector.getInstance(HostStateDAO.class);
  this.gson=injector.getInstance(Gson.class);
  this.clusterDAO=injector.getInstance(ClusterDAO.class);
  this.clusters=injector.getInstance(Clusters.class);
  this.hostConfigMappingDAO=injector.getInstance(HostConfigMappingDAO.class);
  this.configGroupHostMappingDAO=injector.getInstance(ConfigGroupHostMappingDAO.class);
  hostStateEntity=hostEntity.getHostStateEntity();
  if (hostStateEntity == null) {
    hostStateEntity=new HostStateEntity();
    hostStateEntity.setHostEntity(hostEntity);
    hostEntity.setHostStateEntity(hostStateEntity);
    setHealthStatus(new HostHealthStatus(HealthStatus.UNKNOWN,""));
    if (persisted) {
      persist();
    }
  }
 else {
    this.stateMachine.setCurrentState(hostStateEntity.getCurrentState());
  }
}
