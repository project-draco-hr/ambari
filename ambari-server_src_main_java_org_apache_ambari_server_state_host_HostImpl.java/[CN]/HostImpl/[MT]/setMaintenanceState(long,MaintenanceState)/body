{
  try {
    writeLock.lock();
    ensureMaintMap();
    maintMap.put(clusterId,state);
    String json=gson.toJson(maintMap,maintMapType);
    HostStateEntity hostStateEntity=getHostStateEntity();
    if (hostStateEntity != null) {
      getHostStateEntity().setMaintenanceState(json);
      saveIfPersisted();
      MaintenanceModeEvent event=new MaintenanceModeEvent(state,this);
      eventPublisher.publish(event);
    }
  }
  finally {
    writeLock.unlock();
  }
}
