{
  try {
    writeLock.lock();
    ensureMaintMap();
    maintMap.put(Long.valueOf(clusterId),state);
    String json=gson.toJson(maintMap,maintMapType);
    hostStateEntity.setMaintenanceState(json);
    saveIfPersisted();
    MaintenanceModeEvent event=new MaintenanceModeEvent(state,this);
    eventPublisher.publish(event);
  }
  finally {
    writeLock.unlock();
  }
}
