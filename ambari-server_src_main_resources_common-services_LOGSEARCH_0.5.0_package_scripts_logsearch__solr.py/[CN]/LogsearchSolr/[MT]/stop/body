def stop(self, env, upgrade_type=None):
    import params
    env.set_params(params)
    try:
        Execute(format('{solr_bindir}/solr stop -all >> {logsearch_solr_log}'), environment={'SOLR_INCLUDE': format('{logsearch_solr_conf}/logsearch-solr-env.sh'), }, user=params.logsearch_solr_user, only_if=format('test -f {logsearch_solr_pidfile}'))
        File(params.logsearch_solr_pidfile, action='delete')
    except:
        Logger.warning((('Could not stop solr:' + str(sys.exc_info()[1])) + '\n Trying to kill it'))
        kill_process(params.logsearch_solr_pidfile, params.logsearch_solr_user, params.logsearch_solr_log_dir)
