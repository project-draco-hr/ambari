{
  injector.injectMembers(this);
  if (serviceComponent.isClientComponent()) {
    stateMachine=clientStateMachineFactory.make(this);
  }
 else {
    stateMachine=daemonStateMachineFactory.make(this);
  }
  this.serviceComponent=serviceComponent;
  clusterGlobalLock=serviceComponent.getClusterGlobalLock();
  stateEntity=new HostComponentStateEntity();
  stateEntity.setClusterId(serviceComponent.getClusterId());
  stateEntity.setComponentName(serviceComponent.getName());
  stateEntity.setServiceName(serviceComponent.getServiceName());
  stateEntity.setVersion("UNKNOWN");
  stateEntity.setHostName(hostName);
  stateEntity.setCurrentState(stateMachine.getCurrentState());
  stateEntity.setUpgradeState(UpgradeState.NONE);
  stateEntity.setCurrentStackVersion(gson.toJson(new StackId()));
  desiredStateEntity=new HostComponentDesiredStateEntity();
  desiredStateEntity.setClusterId(serviceComponent.getClusterId());
  desiredStateEntity.setComponentName(serviceComponent.getName());
  desiredStateEntity.setServiceName(serviceComponent.getServiceName());
  desiredStateEntity.setHostName(hostName);
  desiredStateEntity.setDesiredState(State.INIT);
  desiredStateEntity.setDesiredStackVersion(gson.toJson(serviceComponent.getDesiredStackVersion()));
  if (!serviceComponent.isMasterComponent() && !serviceComponent.isClientComponent()) {
    desiredStateEntity.setAdminState(HostComponentAdminState.INSERVICE);
  }
 else {
    desiredStateEntity.setAdminState(null);
  }
  try {
    host=clusters.getHost(hostName);
  }
 catch (  AmbariException e) {
    LOG.error("Host '{}' was not found" + hostName);
    throw new RuntimeException(e);
  }
  resetLastOpInfo();
}
