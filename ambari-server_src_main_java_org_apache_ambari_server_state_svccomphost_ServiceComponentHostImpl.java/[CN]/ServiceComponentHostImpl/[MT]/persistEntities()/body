{
  ServiceComponentDesiredStateEntity serviceComponentDesiredStateEntity=serviceComponentDesiredStateDAO.findByName(serviceComponent.getClusterId(),serviceComponent.getServiceName(),serviceComponent.getName());
  HostEntity hostEntity=hostDAO.findByName(getHostName());
  hostEntity.addHostComponentStateEntity(stateEntity);
  hostEntity.addHostComponentDesiredStateEntity(desiredStateEntity);
  desiredStateEntity.setServiceComponentDesiredStateEntity(serviceComponentDesiredStateEntity);
  desiredStateEntity.setHostEntity(hostEntity);
  stateEntity.setServiceComponentDesiredStateEntity(serviceComponentDesiredStateEntity);
  stateEntity.setHostEntity(hostEntity);
  hostComponentStateDAO.create(stateEntity);
  hostComponentDesiredStateDAO.create(desiredStateEntity);
  serviceComponentDesiredStateEntity.getHostComponentDesiredStateEntities().add(desiredStateEntity);
  HostComponentStateEntity stateEntity=hostComponentStateDAO.findByIndex(serviceComponent.getClusterId(),serviceComponent.getServiceName(),serviceComponent.getName(),hostEntity.getHostId());
  hostComponentStateId=stateEntity.getId();
  serviceComponentDesiredStateDAO.merge(serviceComponentDesiredStateEntity);
  hostDAO.merge(hostEntity);
}
