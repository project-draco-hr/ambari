{
  clusterGlobalLock.writeLock().lock();
  try {
    writeLock.lock();
    try {
      if (persisted) {
        removeEntities();
        persisted=false;
      }
      clusters.getCluster(getClusterName()).removeServiceComponentHost(this);
    }
 catch (    AmbariException ex) {
      if (LOG.isDebugEnabled()) {
        LOG.error(ex.getMessage());
      }
    }
 finally {
      writeLock.unlock();
    }
  }
  finally {
    clusterGlobalLock.writeLock().unlock();
  }
}
