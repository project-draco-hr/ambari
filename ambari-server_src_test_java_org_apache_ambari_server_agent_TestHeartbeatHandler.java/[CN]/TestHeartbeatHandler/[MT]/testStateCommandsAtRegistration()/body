{
  List<StatusCommand> dummyCmds=new ArrayList<StatusCommand>();
  StatusCommand statusCmd1=new StatusCommand();
  statusCmd1.setClusterName(DummyCluster);
  statusCmd1.setServiceName(HDFS);
  dummyCmds.add(statusCmd1);
  HeartbeatMonitor hm=mock(HeartbeatMonitor.class);
  when(hm.generateStatusCommands(anyString())).thenReturn(dummyCmds);
  ActionManager am=actionManagerTestHelper.getMockActionManager();
  replay(am);
  Clusters fsm=clusters;
  ActionQueue actionQueue=new ActionQueue();
  HeartBeatHandler handler=new HeartBeatHandler(fsm,actionQueue,am,injector);
  handler.setHeartbeatMonitor(hm);
  clusters.addHost(DummyHostname1);
  Host hostObject=clusters.getHost(DummyHostname1);
  hostObject.setIPv4("ipv4");
  hostObject.setIPv6("ipv6");
  Register reg=new Register();
  HostInfo hi=new HostInfo();
  hi.setHostName(DummyHostname1);
  hi.setOS(DummyOsType);
  reg.setHostname(DummyHostname1);
  reg.setHardwareProfile(hi);
  reg.setAgentVersion(metaInfo.getServerVersion());
  RegistrationResponse registrationResponse=handler.handleRegistration(reg);
  registrationResponse.getStatusCommands();
  assertTrue(registrationResponse.getStatusCommands().size() == 1);
  assertTrue(registrationResponse.getStatusCommands().get(0).equals(statusCmd1));
}
