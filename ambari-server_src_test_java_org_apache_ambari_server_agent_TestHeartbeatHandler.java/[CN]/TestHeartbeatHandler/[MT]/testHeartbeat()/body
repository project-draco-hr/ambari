{
  ActionManager am=new ActionManager(0,0,null,null,new ActionDBInMemoryImpl());
  Clusters fsm=mock(Clusters.class);
  String hostname="host1";
  ActionQueue aq=new ActionQueue();
  ExecutionCommand execCmd=new ExecutionCommand();
  execCmd.setCommandId("2-34");
  execCmd.setHostname(hostname);
  aq.enqueue(hostname,new ExecutionCommand());
  HeartBeatHandler handler=new HeartBeatHandler(fsm,aq,am);
  HeartBeat hb=new HeartBeat();
  hb.setNodeStatus(new HostStatus(Status.HEALTHY,"I am ok"));
  hb.setHostname(hostname);
  Host hostObject=new HostImpl(hostname);
  hostObject.setState(HostState.UNHEALTHY);
  when(fsm.getHost(hostname)).thenReturn(hostObject);
  handler.handleHeartBeat(hb);
  assertEquals(HostState.HEALTHY,hostObject.getState());
  assertEquals(0,aq.dequeueAll(hostname).size());
}
