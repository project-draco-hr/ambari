{
  boolean isTopologyResolved=false;
  try {
    Cluster cluster=getController().getClusters().getClusterById(clusterId);
    Collection<DesiredConfig> desiredConfigs=cluster.getDesiredConfigs().values();
    for (    DesiredConfig config : desiredConfigs) {
      if (config.getTag().equals(tag)) {
        isTopologyResolved=true;
        break;
      }
    }
  }
 catch (  ClusterNotFoundException e) {
    LOG.info("Attempted to determine if configuration is topology resolved for a non-existent cluster: {}",clusterId);
  }
catch (  AmbariException e) {
    throw new RuntimeException("Unable to determine if cluster config is topology resolved due to unknown error: " + e,e);
  }
  return isTopologyResolved;
}
