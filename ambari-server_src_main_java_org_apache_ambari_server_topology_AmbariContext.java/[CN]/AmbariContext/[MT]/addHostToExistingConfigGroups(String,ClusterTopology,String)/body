{
  boolean addedHost=false;
  Clusters clusters;
  Cluster cluster;
  try {
    clusters=getController().getClusters();
    cluster=clusters.getCluster(topology.getClusterName());
  }
 catch (  AmbariException e) {
    throw new RuntimeException(String.format("Attempt to add hosts to a non-existent cluster: '%s'",topology.getClusterName()));
  }
  Map<Long,ConfigGroup> configGroups=cluster.getConfigGroups();
  String qualifiedGroupName=getConfigurationGroupName(topology.getBlueprint().getName(),groupName);
  for (  ConfigGroup group : configGroups.values()) {
    if (group.getName().equals(qualifiedGroupName)) {
      try {
        group.addHost(clusters.getHost(hostName));
        group.persist();
        addedHost=true;
      }
 catch (      AmbariException e) {
        throw new RuntimeException(String.format("Unable to obtain newly created host '%s' from cluster '%s'",hostName,topology.getClusterName()));
      }
    }
  }
  return addedHost;
}
