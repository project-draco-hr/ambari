{
  if (!super.isApplicable(request)) {
    return false;
  }
  final Cluster cluster=clustersProvider.get().getCluster(request.getClusterName());
  Map<String,Service> services=cluster.getServices();
  if (!services.containsKey("YARN")) {
    return false;
  }
  for (  MinimumApplicableStackVersion minimumStackVersion : MinimumApplicableStackVersion.values()) {
    String stackName=cluster.getCurrentStackVersion().getStackName();
    if (minimumStackVersion.getStackName().equals(stackName)) {
      String currentClusterRepositoryVersion=cluster.getCurrentClusterVersion().getRepositoryVersion().getVersion();
      return VersionUtils.compareVersions(currentClusterRepositoryVersion,minimumStackVersion.getStackVersion()) >= 0;
    }
  }
  return true;
}
