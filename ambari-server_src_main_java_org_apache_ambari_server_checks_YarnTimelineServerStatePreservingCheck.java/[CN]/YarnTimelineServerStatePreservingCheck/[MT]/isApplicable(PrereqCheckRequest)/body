{
  if (!super.isApplicable(request,Arrays.asList("YARN"),true)) {
    return false;
  }
  final Cluster cluster=clustersProvider.get().getCluster(request.getClusterName());
  for (  MinimumApplicableStackVersion minimumStackVersion : MinimumApplicableStackVersion.values()) {
    String stackName=cluster.getCurrentStackVersion().getStackName();
    if (minimumStackVersion.getStackName().equals(stackName)) {
      String currentClusterRepositoryVersion=cluster.getCurrentClusterVersion().getRepositoryVersion().getVersion();
      return VersionUtils.compareVersions(currentClusterRepositoryVersion,minimumStackVersion.getStackVersion()) >= 0;
    }
  }
  return true;
}
