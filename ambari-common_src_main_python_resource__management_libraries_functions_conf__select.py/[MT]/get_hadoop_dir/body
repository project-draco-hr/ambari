def get_hadoop_dir(target):
    '\n  Return the hadoop shared directory in the following override order\n  1. Use default for 2.1 and lower\n  2. If 2.2 and higher, use /usr/hdp/current/hadoop-client/{target}\n  3. If 2.2 and higher AND for an upgrade, use /usr/hdp/<version>/hadoop/{target}\n  :target: the target directory\n  '
    if (not (target in HADOOP_DIR_DEFAULTS)):
        raise Fail('Target {0} not defined'.format(target))
    hadoop_dir = HADOOP_DIR_DEFAULTS[target]
    if Script.is_hdp_stack_greater_or_equal('2.2'):
        hadoop_dir = HADOOP_DIR_TEMPLATE.format('current', 'hadoop-client', target)
        res = _is_upgrade()
        if (res is not None):
            hadoop_dir = HADOOP_DIR_TEMPLATE.format(res[1], 'hadoop', target)
    return hadoop_dir
