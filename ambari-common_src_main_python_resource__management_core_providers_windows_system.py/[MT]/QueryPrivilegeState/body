def QueryPrivilegeState(hToken, priv):
    privId = LookupPrivilegeValue(None, priv)
    privList = GetTokenInformation(hToken, TokenPrivileges)
    privState = 0
    for (id, attr) in privList:
        if (id == privId):
            privState = attr
    Logger.debug('Privilege state: {}={} ({}) Enabled={}'.format(privId, priv, LookupPrivilegeDisplayName(None, priv), privState))
    return privState
