{
  if (predicate instanceof BasePredicate) {
    StringBuilder whereClause=new StringBuilder();
    BasePredicate basePredicate=(BasePredicate)predicate;
    SQLPredicateVisitor visitor=new SQLPredicateVisitor();
    basePredicate.accept(visitor);
    whereClause.append(visitor.getSQL());
    String table=basePredicate.getPropertyIds().iterator().next().getCategory();
    StringBuilder setClause=new StringBuilder();
    for (    Map.Entry<PropertyId,Object> entry : properties.entrySet()) {
      if (setClause.length() > 0) {
        setClause.append(", ");
      }
      setClause.append(entry.getKey().getName());
      setClause.append(" = ");
      setClause.append("'");
      setClause.append(entry.getValue());
      setClause.append("'");
    }
    return "update " + table + " set "+ setClause+ " where "+ whereClause;
  }
  throw new IllegalStateException("Can't generate SQL.");
}
