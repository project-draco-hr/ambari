{
  while (processingEvents) {
    LdapSyncEventEntity event;
synchronized (eventQueue) {
      event=eventQueue.poll();
      if (event == null) {
        processingEvents=false;
        return;
      }
    }
    event.setStatus(LdapSyncEventEntity.Status.Running);
    event.setStatusDetail("Running LDAP sync.");
    event.setStartTime(System.currentTimeMillis());
    try {
      event.setEndTime(System.currentTimeMillis());
      event.setStatus(LdapSyncEventEntity.Status.Complete);
      event.setStatusDetail("Completed LDAP sync.");
    }
 catch (    Exception e) {
      String msg="Caught exception running LDAP sync. ";
      event.setStatus(LdapSyncEventEntity.Status.Error);
      event.setStatusDetail(msg + e.getMessage());
      LOG.error(msg,e);
    }
  }
}
