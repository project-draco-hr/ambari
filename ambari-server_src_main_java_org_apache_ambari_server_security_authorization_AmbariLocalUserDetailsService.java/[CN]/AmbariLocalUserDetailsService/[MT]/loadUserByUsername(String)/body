{
  log.info("Loading user by name: " + username);
  UserEntity user=userDAO.findLocalUserByName(username);
  if (user == null) {
    log.info("user not found ");
    throw new UsernameNotFoundException("Username " + username + " not found");
  }
 else   if (user.getRoleEntities().isEmpty()) {
    log.info("No authorities for user");
    throw new UsernameNotFoundException("Username " + username + " has no roles");
  }
  return new User(user.getUserName(),user.getUserPassword(),authorizationHelper.convertRolesToAuthorities(user.getRoleEntities()));
}
