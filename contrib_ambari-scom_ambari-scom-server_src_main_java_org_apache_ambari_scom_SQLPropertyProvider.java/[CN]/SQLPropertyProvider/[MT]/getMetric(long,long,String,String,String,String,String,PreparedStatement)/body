{
  if (recordTypeContext == null || recordTypeName == null || nodeName == null) {
    return null;
  }
  int columnId=1;
  List<DataPoint> results;
  try {
    preparedStatement.clearParameters();
    preparedStatement.setLong(columnId++,startTime);
    preparedStatement.setLong(columnId++,endTime);
    preparedStatement.setNString(columnId++,recordTypeContext);
    preparedStatement.setNString(columnId++,recordTypeName);
    preparedStatement.setNString(columnId++,metricName);
    preparedStatement.setNString(columnId++,serviceName);
    preparedStatement.setNString(columnId,nodeName);
    ResultSet rs=preparedStatement.executeQuery();
    results=new LinkedList<DataPoint>();
    if (rs != null) {
      while (rs.next()) {
        ParsePosition parsePosition=new ParsePosition(0);
        NumberFormat numberFormat=NumberFormat.getInstance();
        Number parsedNumber=numberFormat.parse(rs.getNString("MetricValue"),parsePosition);
        results.add(new DataPoint(rs.getLong("RecordTimeStamp"),parsedNumber));
      }
    }
  }
 catch (  SQLException e) {
    throw new SystemException("Error during getMetric call : caught exception - ",e);
  }
  return results;
}
