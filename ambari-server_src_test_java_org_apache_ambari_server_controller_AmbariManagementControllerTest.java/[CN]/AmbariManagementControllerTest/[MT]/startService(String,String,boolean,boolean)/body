{
  ServiceRequest r=new ServiceRequest(clusterName,serviceName,null,State.STARTED.toString());
  Set<ServiceRequest> requests=new HashSet<ServiceRequest>();
  requests.add(r);
  Map<String,String> mapRequestProps=new HashMap<String,String>();
  mapRequestProps.put("context","Called from a test");
  RequestStatusResponse resp=ServiceResourceProviderTest.updateServices(controller,requests,mapRequestProps,runSmokeTests,reconfigureClients);
  Assert.assertEquals(State.STARTED,clusters.getCluster(clusterName).getService(serviceName).getDesiredState());
  if (resp != null) {
    List<HostRoleCommand> commands=actionDB.getRequestTasks(resp.getRequestId());
    for (    HostRoleCommand cmd : commands) {
      if (!cmd.getRole().toString().endsWith("CHECK")) {
        clusters.getCluster(clusterName).getService(serviceName).getServiceComponent(cmd.getRole().name()).getServiceComponentHost(cmd.getHostName()).setState(State.STARTED);
      }
    }
    return resp.getRequestId();
  }
 else {
    return -1;
  }
}
