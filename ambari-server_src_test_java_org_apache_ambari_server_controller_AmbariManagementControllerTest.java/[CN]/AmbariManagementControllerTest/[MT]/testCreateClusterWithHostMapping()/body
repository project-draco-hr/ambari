{
  Set<String> hostNames=new HashSet<String>();
  hostNames.add("h1");
  hostNames.add("h2");
  ClusterRequest r=new ClusterRequest(null,"c1","HDP-0.1",hostNames);
  try {
    controller.createCluster(r);
    fail("Expected create cluster to fail for invalid hosts");
  }
 catch (  Exception e) {
  }
  try {
    clusters.getCluster("c1");
    fail("Expected to fail for non created cluster");
  }
 catch (  ClusterNotFoundException e) {
  }
  clusters.addHost("h1");
  clusters.addHost("h2");
  setOsFamily(clusters.getHost("h1"),"redhat","6.3");
  setOsFamily(clusters.getHost("h2"),"redhat","6.3");
  clusters.getHost("h1").persist();
  clusters.getHost("h2").persist();
  controller.createCluster(r);
  Assert.assertNotNull(clusters.getCluster("c1"));
}
