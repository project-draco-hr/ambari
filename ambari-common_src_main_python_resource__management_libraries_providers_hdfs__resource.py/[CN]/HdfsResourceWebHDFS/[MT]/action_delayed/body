def action_delayed(self, action_name, main_resource):
    main_resource.assert_parameter_is_set('user')
    address = (main_resource.https_nn_address if main_resource.is_https_enabled else main_resource.http_nn_address)
    protocol = ('https' if main_resource.is_https_enabled else 'http')
    self.util = WebHDFSUtil(format('{protocol}://{address}'), main_resource.resource.user, main_resource.resource.logoutput, main_resource.resource.security_enabled, main_resource.kinit)
    self.mode = (oct(main_resource.resource.mode)[1:] if main_resource.resource.mode else main_resource.resource.mode)
    self.mode_set = False
    self.main_resource = main_resource
    self._assert_valid()
    if (action_name == 'create'):
        self._create_resource()
        self._set_mode(self.target_status)
        self._set_owner(self.target_status)
    else:
        self._delete_resource()
