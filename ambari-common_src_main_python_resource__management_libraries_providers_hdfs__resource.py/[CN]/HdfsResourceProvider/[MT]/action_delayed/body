def action_delayed(self, action_name):
    resource = {}
    env = Environment.get_instance()
    if (not ('hdfs_files' in env.config)):
        env.config['hdfs_files'] = []
    if ((not self.resource.type) or (not self.resource.action)):
        raise Fail('Resource parameter type or action is not set.')
    for (field_name, json_field_name) in RESOURCE_TO_JSON_FIELDS.iteritems():
        if (field_name == 'action'):
            resource[json_field_name] = action_name
        elif ((field_name == 'mode') and self.resource.mode):
            resource[json_field_name] = oct(self.resource.mode)[1:]
        elif getattr(self.resource, field_name):
            resource[json_field_name] = getattr(self.resource, field_name)
    env.config['hdfs_files'].append(resource)
