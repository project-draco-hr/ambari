def action_execute(self):
    env = Environment.get_instance()
    if ((not self.resource.hadoop_fs) or (not self.resource.user)):
        raise Fail('Resource parameter hadoop_fs or user is not set.')
    if ((not ('hdfs_files' in env.config)) or (not env.config['hdfs_files'])):
        raise Fail('No resources to create. Please perform create_delayed or delete_delayed before doing execute action.')
    hadoop_fs = self.resource.hadoop_fs
    hadoop_bin_dir = self.resource.hadoop_bin_dir
    hadoop_conf_dir = self.resource.hadoop_conf_dir
    user = self.resource.user
    security_enabled = self.resource.security_enabled
    keytab_file = self.resource.keytab
    kinit_path = self.resource.kinit_path_local
    logoutput = self.resource.logoutput
    jar_path = JAR_PATH
    json_path = JSON_PATH
    if security_enabled:
        Execute(format('{kinit_path} -kt {keytab_file} {hdfs_principal_name}'), user=user)
    with open(JSON_PATH, 'w') as f:
        f.write(json.dumps(env.config['hdfs_files']))
    Execute(format('hadoop --config {hadoop_conf_dir} jar {jar_path} {json_path} {hadoop_fs}'), user=user, path=[hadoop_bin_dir], logoutput=logoutput)
    env.config['hdfs_files'] = []
