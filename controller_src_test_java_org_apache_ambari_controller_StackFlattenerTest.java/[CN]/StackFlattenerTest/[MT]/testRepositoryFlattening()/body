{
  parentStack.setPackageRepositories(Arrays.asList(new RepositoryKind("kind1","url1","url2"),new RepositoryKind("kind2","url3","url4")));
  childStack.setPackageRepositories(Arrays.asList(new RepositoryKind("kind3","url5")));
  grandchildStack.setPackageRepositories(Arrays.asList(new RepositoryKind("kind1","url7","url8"),new RepositoryKind("kind3","url9","url10")));
  grandchildStack.setRevision("123");
  Stack flat=flattener.flattenStack("grandchild",0);
  List<RepositoryKind> answer=flat.getPackageRepositories();
  assertEquals(new RepositoryKind("kind1","url7","url8","url1","url2"),answer.get(0));
  assertEquals(new RepositoryKind("kind2","url3","url4"),answer.get(1));
  assertEquals(new RepositoryKind("kind3","url9","url10","url5"),answer.get(2));
  assertEquals("grandchild",flat.getName());
  assertEquals("123",flat.getRevision());
  assertEquals(null,flat.getParentName());
  assertEquals(0,flat.getParentRevision());
}
