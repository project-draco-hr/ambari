@patch('resource_management.libraries.script.Script.put_structured_out')
def test_normal_flow(self, put_structured_out):
    self.executeScript('scripts/install_packages.py', classname='InstallPackages', command='actionexecute', config_file='install_packages_config.json', target=RMFTestCase.TARGET_CUSTOM_ACTIONS, os_type=('Suse', '11', 'Final'))
    self.assertTrue(put_structured_out.called)
    self.assertEquals(put_structured_out.call_args[0][0], {'package_installation_result': 'SUCCESS', 'ambari_repositories': [], })
    self.assertResourceCalled('Repository', 'HDP-2.2.0.0-885', base_url=u'http://host1/hdp', action=['create'], components=[u'HDP-2.2.0.0-885', 'main'], repo_template='repo_suse_rhel.j2', repo_file_name=u'HDP-2.2.0.0-885', mirror_list=None)
    self.assertResourceCalled('Repository', 'HDP-UTILS-1.0.0.20', base_url=u'http://host1/hdp-utils', action=['create'], components=[u'HDP-UTILS-1.0.0.20', 'main'], repo_template='repo_suse_rhel.j2', repo_file_name=u'HDP-UTILS-1.0.0.20', mirror_list=None)
    self.assertResourceCalled('Package', 'python-rrdtool-1.4.5')
    self.assertResourceCalled('Package', 'libganglia-3.5.0-99')
    self.assertResourceCalled('Package', 'ganglia-*')
    self.assertNoMoreResources()
