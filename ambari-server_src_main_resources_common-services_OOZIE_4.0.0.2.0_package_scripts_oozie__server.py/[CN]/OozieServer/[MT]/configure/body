def configure(self, env, upgrade_type=None):
    import params
    if (upgrade_type is None):
        restart_type = default('/commandParams/restart_type', '')
        if (restart_type.lower() == 'rolling_upgrade'):
            upgrade_type = UPGRADE_TYPE_ROLLING
        elif (restart_type.lower() == 'nonrolling_upgrade'):
            upgrade_type = UPGRADE_TYPE_NON_ROLLING
    if ((upgrade_type is not None) and (params.upgrade_direction == Direction.UPGRADE) and (params.version is not None)):
        Logger.info(format('Configuring Oozie during upgrade type: {upgrade_type}, direction: {params.upgrade_direction}, and version {params.version}'))
        if (params.version and check_stack_feature(StackFeature.ROLLING_UPGRADE, params.version)):
            stack_select.select('oozie-client', params.version)
            stack_select.select('oozie-server', params.version)
        if (params.version and check_stack_feature(StackFeature.CONFIG_VERSIONING, params.version)):
            conf_select.select(params.stack_name, 'oozie', params.version)
    env.set_params(params)
    oozie(is_server=True)
