{
  HttpServletRequest request=(HttpServletRequest)req;
  String header=request.getHeader("Authorization");
  if (AuthorizationHelper.getAuthenticatedName() == null && (header == null || !header.startsWith("Basic "))) {
    AuditEvent loginFailedAuditEvent=LoginAuditEvent.builder().withRemoteIp(RequestUtils.getRemoteAddress(request)).withTimestamp(System.currentTimeMillis()).withReasonOfFailure("Authentication required").withUserName(null).build();
    auditLogger.log(loginFailedAuditEvent);
  }
  super.doFilter(req,res,chain);
}
