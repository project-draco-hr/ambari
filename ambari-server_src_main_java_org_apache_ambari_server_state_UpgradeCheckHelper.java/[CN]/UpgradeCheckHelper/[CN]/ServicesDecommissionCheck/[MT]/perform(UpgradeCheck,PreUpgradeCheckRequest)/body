{
  final String clusterName=request.getClusterName();
  final Cluster cluster=clustersProvider.get().getCluster(clusterName);
  for (  Entry<String,Service> serviceEntry : cluster.getServices().entrySet()) {
    final Service service=serviceEntry.getValue();
    for (    Entry<String,ServiceComponent> serviceComponentEntry : service.getServiceComponents().entrySet()) {
      final ServiceComponent serviceComponent=serviceComponentEntry.getValue();
      for (      String hostName : serviceComponent.getServiceComponentHosts().keySet()) {
        final ServiceComponentHost scHost=serviceComponent.getServiceComponentHost(hostName);
        if (scHost.getComponentAdminState() == HostComponentAdminState.DECOMMISSIONED || scHost.getComponentAdminState() == HostComponentAdminState.DECOMMISSIONING) {
          upgradeCheck.getFailedOn().add(serviceComponent.getName());
        }
      }
    }
  }
  if (!upgradeCheck.getFailedOn().isEmpty()) {
    upgradeCheck.setStatus(UpgradeCheckStatus.FAIL);
    upgradeCheck.setFailReason("There are services in decommission or decommissioning state");
  }
}
