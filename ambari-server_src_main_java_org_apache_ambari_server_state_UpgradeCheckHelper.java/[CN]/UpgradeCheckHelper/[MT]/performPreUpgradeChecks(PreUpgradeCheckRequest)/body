{
  final String clusterName=request.getClusterName();
  final List<UpgradeCheck> upgradeCheckResults=new ArrayList<UpgradeCheck>();
  for (  UpgradeCheckDescriptor upgradeCheckDescriptor : registry) {
    final UpgradeCheck upgradeCheck=new UpgradeCheck(upgradeCheckDescriptor.id,upgradeCheckDescriptor.description,upgradeCheckDescriptor.type,clusterName);
    try {
      if (upgradeCheckDescriptor.isApplicable(request)) {
        upgradeCheckDescriptor.perform(upgradeCheck,request);
        upgradeCheckResults.add(upgradeCheck);
      }
    }
 catch (    Exception ex) {
      LOG.error("Pre-upgrade check " + upgradeCheckDescriptor.id + " failed",ex);
      upgradeCheck.setStatus(UpgradeCheckStatus.FAIL);
      upgradeCheck.setFailReason("Unexpected server error happened");
      upgradeCheckResults.add(upgradeCheck);
    }
  }
  return upgradeCheckResults;
}
