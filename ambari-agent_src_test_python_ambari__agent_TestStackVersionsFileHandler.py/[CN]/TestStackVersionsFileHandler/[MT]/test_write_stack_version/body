def test_write_stack_version(self):
    oldFilePathValue = stackVersionsFileHandler.versionsFilePath
    oldversionsFileDir = stackVersionsFileHandler.versionsFileDir
    oldVerFile = stackVersionsFileHandler.VER_FILE
    tmpfile = tempfile.mktemp()
    stackVersionsFileHandler.versionsFilePath = tmpfile
    stackVersionsFileHandler.VER_FILE = os.path.basename(tmpfile)
    stackVersionsFileHandler.versionsFileDir = os.path.dirname(tmpfile)
    stackVersionsFileHandler.touch_file()
    stackVersionsFileHandler.write_stack_version('GANGLIA_SERVER', '"stackVersion":"1.3.0"')
    expectedBackupFile = (tmpfile + '.bak')
    self.assertTrue(os.path.isfile(expectedBackupFile))
    os.remove(expectedBackupFile)
    content = stackVersionsFileHandler.read_all_stack_versions()
    self.assertEquals(len(content), 1)
    self.assertEqual(content['GANGLIA_SERVER'], '"stackVersion":"1.3.0"')
    self.assertTrue(os.path.isfile(tmpfile))
    os.remove(tmpfile)
    stackVersionsFileHandler.versionsFilePath = oldFilePathValue
    stackVersionsFileHandler.versionsFileDir = oldversionsFileDir
    stackVersionsFileHandler.VER_FILE = oldVerFile
