{
  JobEvent e=null;
  JobState endState=null;
  if (failJob) {
    e=new JobFailedEvent(job.getId(),endTime);
    endState=JobState.FAILED;
  }
 else {
    e=new JobCompletedEvent(job.getId(),endTime);
    endState=JobState.COMPLETED;
  }
  job.handleEvent(e);
  Assert.assertEquals(endState,job.getState());
  Assert.assertEquals(endTime,job.getLastUpdateTime());
  Assert.assertEquals(endTime,job.getCompletionTime());
}
