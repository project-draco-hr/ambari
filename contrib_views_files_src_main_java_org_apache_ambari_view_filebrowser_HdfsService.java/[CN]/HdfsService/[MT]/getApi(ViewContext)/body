{
  if (_api == null) {
    Thread.currentThread().setContextClassLoader(null);
    String defaultFs=context.getProperties().get("webhdfs.url");
    if (defaultFs == null)     throw new MisconfigurationFormattedException("webhdfs.url");
    try {
      _api=new HdfsApi(defaultFs,getUsername(context));
    }
 catch (    Exception ex) {
      throw new ServiceFormattedException("HdfsApi connection failed. Check \"webhdfs.url\" property",ex);
    }
  }
  return _api;
}
