{
  String url;
  if (ambariApi.isClusterAssociated()) {
    String protocol;
    String haEnabled=ambariApi.getCluster().getConfigurationValue(YARN_SITE,YARN_RESOURCEMANAGER_HA_ENABLED);
    String httpPolicy=ambariApi.getCluster().getConfigurationValue(YARN_SITE,YARN_HTTP_POLICY);
    if (httpPolicy.equals(HTTPS_ONLY)) {
      protocol="https";
      url=ambariApi.getCluster().getConfigurationValue(YARN_SITE,"yarn.resourcemanager.webapp.https.address");
    }
 else {
      protocol="http";
      url=ambariApi.getCluster().getConfigurationValue(YARN_SITE,"yarn.resourcemanager.webapp.address");
      if (!httpPolicy.equals(HTTP_ONLY))       LOG.error(String.format("RA030 Unknown value %s of yarn-site/yarn.http.policy. HTTP_ONLY assumed.",httpPolicy));
    }
    url=addProtocolIfMissing(url,protocol);
    if (haEnabled != null && haEnabled.equals("true")) {
      url=getActiveRMUrl(url);
    }
  }
 else {
    url=context.getProperties().get("yarn.resourcemanager.url");
    if (!hasProtocol(url)) {
      throw new AmbariApiException("RA070 View is not cluster associated. Resource Manager URL should contain protocol.");
    }
  }
  return removeTrailingSlash(url);
}
