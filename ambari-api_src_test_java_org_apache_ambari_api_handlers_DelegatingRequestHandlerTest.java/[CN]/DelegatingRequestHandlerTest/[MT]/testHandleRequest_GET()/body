{
  Request request=createStrictMock(Request.class);
  RequestHandlerFactory factory=createStrictMock(RequestHandlerFactory.class);
  RequestHandler readRequestHandler=createStrictMock(RequestHandler.class);
  Result result=createStrictMock(Result.class);
  expect(request.getRequestType()).andReturn(Request.RequestType.GET);
  expect(factory.getRequestHandler(Request.RequestType.GET)).andReturn(readRequestHandler);
  expect(readRequestHandler.handleRequest(request)).andReturn(result);
  replay(request,factory,readRequestHandler,result);
  RequestHandler delegatingRequestHandler=new TestDelegatingRequestHandler(factory);
  assertSame(result,delegatingRequestHandler.handleRequest(request));
  verify(request,factory,readRequestHandler,result);
}
