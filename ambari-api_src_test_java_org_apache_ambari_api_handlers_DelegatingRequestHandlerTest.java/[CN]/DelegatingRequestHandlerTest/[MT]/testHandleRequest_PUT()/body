{
  Request request=createStrictMock(Request.class);
  RequestHandlerFactory factory=createStrictMock(RequestHandlerFactory.class);
  RequestHandler requestHandler=createStrictMock(RequestHandler.class);
  Result result=createStrictMock(Result.class);
  expect(request.getRequestType()).andReturn(Request.RequestType.PUT);
  expect(factory.getRequestHandler(Request.RequestType.PUT)).andReturn(requestHandler);
  expect(requestHandler.handleRequest(request)).andReturn(result);
  replay(request,factory,requestHandler,result);
  RequestHandler delegatingRequestHandler=new TestDelegatingRequestHandler(factory);
  assertSame(result,delegatingRequestHandler.handleRequest(request));
  verify(request,factory,requestHandler,result);
}
