def recommendHAWQConfigurations(self, configurations, clusterData, services, hosts):
    if ('hawq-site' not in services['configurations']):
        return
    hawq_site = services['configurations']['hawq-site']['properties']
    putHawqSiteProperty = self.putProperty(configurations, 'hawq-site', services)
    componentsListList = [service['components'] for service in services['services']]
    componentsList = [item['StackServiceComponents'] for sublist in componentsListList for item in sublist]
    servicesList = [service['StackServices']['service_name'] for service in services['services']]
    if (self.isHawqMasterComponentOnAmbariServer(services) and ('hawq_master_address_port' in hawq_site)):
        putHawqSiteProperty('hawq_master_address_port', '')
    numSegments = len(self.__getHosts(componentsList, 'HAWQSEGMENT'))
    if (numSegments and ('default_hash_table_bucket_number' in hawq_site)):
        putHawqSiteProperty('default_hash_table_bucket_number', (numSegments * 6))
    if (('YARN' in servicesList) and ('yarn-site' in services['configurations'])):
        yarn_site = services['configurations']['yarn-site']['properties']
        for (hs_prop, ys_prop) in self.getHAWQYARNPropertyMapping().items():
            if ((hs_prop in hawq_site) and (ys_prop in yarn_site)):
                putHawqSiteProperty(hs_prop, yarn_site[ys_prop])
