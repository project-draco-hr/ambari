{
  RoleCommandOrder rco=new RoleCommandOrder();
  ClusterEntity entity=createDummyData();
  ClusterImpl cluster=new ClusterImpl(entity,injector);
  rco.initialize(cluster);
  RoleGraphNode datanode_upgrade=new RoleGraphNode(Role.DATANODE,RoleCommand.UPGRADE);
  RoleGraphNode hdfs_client_upgrade=new RoleGraphNode(Role.HDFS_CLIENT,RoleCommand.UPGRADE);
  Assert.assertEquals(-1,rco.order(datanode_upgrade,hdfs_client_upgrade));
  Assert.assertEquals(1,rco.order(hdfs_client_upgrade,datanode_upgrade));
  RoleGraphNode namenode_upgrade=new RoleGraphNode(Role.NAMENODE,RoleCommand.UPGRADE);
  RoleGraphNode ganglia_server_upgrade=new RoleGraphNode(Role.GANGLIA_SERVER,RoleCommand.UPGRADE);
  Assert.assertEquals(1,rco.order(ganglia_server_upgrade,hdfs_client_upgrade));
  Assert.assertEquals(1,rco.order(ganglia_server_upgrade,datanode_upgrade));
  Assert.assertEquals(-1,rco.order(namenode_upgrade,ganglia_server_upgrade));
  RoleGraphNode datanode_start=new RoleGraphNode(Role.DATANODE,RoleCommand.START);
  RoleGraphNode datanode_install=new RoleGraphNode(Role.DATANODE,RoleCommand.INSTALL);
  RoleGraphNode jobtracker_start=new RoleGraphNode(Role.JOBTRACKER,RoleCommand.START);
  Assert.assertEquals(1,rco.order(datanode_start,datanode_install));
  Assert.assertEquals(1,rco.order(jobtracker_start,datanode_start));
  Assert.assertEquals(0,rco.order(jobtracker_start,jobtracker_start));
  RoleGraphNode hive_client_install=new RoleGraphNode(Role.HIVE_CLIENT,RoleCommand.INSTALL);
  RoleGraphNode mapred_client_install=new RoleGraphNode(Role.MAPREDUCE_CLIENT,RoleCommand.INSTALL);
  RoleGraphNode hcat_client_install=new RoleGraphNode(Role.HCAT,RoleCommand.INSTALL);
  RoleGraphNode nagios_server_install=new RoleGraphNode(Role.NAGIOS_SERVER,RoleCommand.INSTALL);
  RoleGraphNode oozie_client_install=new RoleGraphNode(Role.OOZIE_CLIENT,RoleCommand.INSTALL);
  Assert.assertEquals(1,rco.order(nagios_server_install,hive_client_install));
  Assert.assertEquals(1,rco.order(nagios_server_install,mapred_client_install));
  Assert.assertEquals(1,rco.order(nagios_server_install,hcat_client_install));
  Assert.assertEquals(1,rco.order(nagios_server_install,oozie_client_install));
  RoleGraphNode pig_service_check=new RoleGraphNode(Role.PIG_SERVICE_CHECK,RoleCommand.EXECUTE);
  RoleGraphNode resourcemanager_start=new RoleGraphNode(Role.RESOURCEMANAGER,RoleCommand.START);
  Assert.assertEquals(-1,rco.order(resourcemanager_start,pig_service_check));
  RoleGraphNode hdfs_service_check=new RoleGraphNode(Role.HDFS_SERVICE_CHECK,RoleCommand.EXECUTE);
  RoleGraphNode snamenode_start=new RoleGraphNode(Role.SECONDARY_NAMENODE,RoleCommand.START);
  Assert.assertEquals(-1,rco.order(snamenode_start,hdfs_service_check));
  RoleGraphNode mapred2_service_check=new RoleGraphNode(Role.MAPREDUCE2_SERVICE_CHECK,RoleCommand.EXECUTE);
  RoleGraphNode rm_start=new RoleGraphNode(Role.RESOURCEMANAGER,RoleCommand.START);
  RoleGraphNode nm_start=new RoleGraphNode(Role.NODEMANAGER,RoleCommand.START);
  RoleGraphNode hs_start=new RoleGraphNode(Role.HISTORYSERVER,RoleCommand.START);
  Assert.assertEquals(-1,rco.order(rm_start,mapred2_service_check));
  Assert.assertEquals(-1,rco.order(nm_start,mapred2_service_check));
  Assert.assertEquals(-1,rco.order(hs_start,mapred2_service_check));
  Assert.assertEquals(-1,rco.order(hs_start,mapred2_service_check));
  Assert.assertEquals(1,rco.order(nm_start,rm_start));
  RoleGraphNode nn_start=new RoleGraphNode(Role.NAMENODE,RoleCommand.START);
  RoleGraphNode jn_start=new RoleGraphNode(Role.JOURNALNODE,RoleCommand.START);
  RoleGraphNode zk_server_start=new RoleGraphNode(Role.ZOOKEEPER_SERVER,RoleCommand.START);
  RoleGraphNode zkfc_start=new RoleGraphNode(Role.ZKFC,RoleCommand.START);
  Assert.assertEquals(0,rco.order(nn_start,jn_start));
  Assert.assertEquals(0,rco.order(nn_start,zk_server_start));
  Assert.assertEquals(0,rco.order(zkfc_start,nn_start));
  try {
    cluster.getService("HDFS").addServiceComponent("JOURNALNODE");
  }
 catch (  AmbariException e) {
    Assert.fail("Failed to add journal node for cluster.");
  }
  rco.initialize(cluster);
  Assert.assertEquals(1,rco.order(nn_start,jn_start));
  Assert.assertEquals(1,rco.order(nn_start,zk_server_start));
  Assert.assertEquals(1,rco.order(zkfc_start,nn_start));
}
