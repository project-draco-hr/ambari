{
  final String clusterName=request.getClusterName();
  final Cluster cluster=clustersProvider.get().getCluster(clusterName);
  for (  Map.Entry<String,Service> serviceEntry : cluster.getServices().entrySet()) {
    final Service service=serviceEntry.getValue();
    for (    Map.Entry<String,ServiceComponent> serviceComponentEntry : service.getServiceComponents().entrySet()) {
      final ServiceComponent serviceComponent=serviceComponentEntry.getValue();
      for (      String hostName : serviceComponent.getServiceComponentHosts().keySet()) {
        final ServiceComponentHost scHost=serviceComponent.getServiceComponentHost(hostName);
        if (scHost.getComponentAdminState() == HostComponentAdminState.DECOMMISSIONED || scHost.getComponentAdminState() == HostComponentAdminState.DECOMMISSIONING) {
          prerequisiteCheck.getFailedOn().add(serviceComponent.getName());
        }
      }
    }
  }
  if (!prerequisiteCheck.getFailedOn().isEmpty()) {
    prerequisiteCheck.setStatus(PrereqCheckStatus.FAIL);
    prerequisiteCheck.setFailReason(formatEntityList(prerequisiteCheck.getFailedOn()) + " must not be in decommissioned or decommissioning state");
  }
}
