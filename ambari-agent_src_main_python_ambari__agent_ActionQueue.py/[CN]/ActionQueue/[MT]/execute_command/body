def execute_command(self, command):
    '\n    Executes commands of type  EXECUTION_COMMAND\n    '
    clusterName = command['clusterName']
    commandId = command['commandId']
    command_format = self.determine_command_format_version(command)
    message = 'Executing command with id = {commandId} for role = {role} of cluster {cluster}. Command format={command_format}'.format(commandId=str(commandId), role=command['role'], cluster=clusterName, command_format=command_format)
    logger.info(message)
    logger.debug(pprint.pformat(command))
    taskId = command['taskId']
    in_progress_status = self.commandStatuses.generate_report_template(command)
    in_progress_status.update({'tmpout': ((((self.tmpdir + os.sep) + 'output-') + str(taskId)) + '.txt'), 'tmperr': ((((self.tmpdir + os.sep) + 'errors-') + str(taskId)) + '.txt'), 'structuredOut': ((((self.tmpdir + os.sep) + 'structured-out-') + str(taskId)) + '.json'), 'status': self.IN_PROGRESS_STATUS, })
    self.commandStatuses.put_command_status(command, in_progress_status)
    if (command_format == self.COMMAND_FORMAT_V1):
        puppetExecutor = PuppetExecutor.PuppetExecutor(self.config.get('puppet', 'puppetmodules'), self.config.get('puppet', 'puppet_home'), self.config.get('puppet', 'facter_home'), self.config.get('agent', 'prefix'), self.config)
        commandresult = puppetExecutor.runCommand(command, in_progress_status['tmpout'], in_progress_status['tmperr'])
    else:
        commandresult = self.customServiceOrchestrator.runCommand(command, in_progress_status['tmpout'], in_progress_status['tmperr'])
    status = self.COMPLETED_STATUS
    if (commandresult['exitcode'] != 0):
        status = self.FAILED_STATUS
    roleResult = self.commandStatuses.generate_report_template(command)
    roleResult.update({'stdout': commandresult['stdout'], 'stderr': commandresult['stderr'], 'exitCode': commandresult['exitcode'], 'status': status, })
    if (roleResult['stdout'] == ''):
        roleResult['stdout'] = 'None'
    if (roleResult['stderr'] == ''):
        roleResult['stderr'] = 'None'
    if ('structuredOut' in commandresult):
        roleResult['structuredOut'] = str(commandresult['structuredOut'])
    else:
        roleResult['structuredOut'] = ''
    if (status == self.COMPLETED_STATUS):
        configHandler = ActualConfigHandler(self.config, self.configTags)
        if command.has_key('configurationTags'):
            configHandler.write_actual(command['configurationTags'])
            roleResult['configurationTags'] = command['configurationTags']
        component = {'serviceName': command['serviceName'], 'componentName': command['role'], }
        if (command.has_key('roleCommand') and ((command['roleCommand'] == self.ROLE_COMMAND_START) or ((command['roleCommand'] == self.ROLE_COMMAND_INSTALL) and (component in LiveStatus.CLIENT_COMPONENTS)) or ((command['roleCommand'] == self.ROLE_COMMAND_CUSTOM_COMMAND) and command['hostLevelParams'].has_key('custom_command') and (command['hostLevelParams']['custom_command'] == self.CUSTOM_COMMAND_RESTART)))):
            configHandler.write_actual_component(command['role'], command['configurationTags'])
            configHandler.write_client_components(command['serviceName'], command['configurationTags'])
            roleResult['configurationTags'] = configHandler.read_actual_component(command['role'])
    self.commandStatuses.put_command_status(command, roleResult)
