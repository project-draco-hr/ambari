{
  Set<PropertyId> propertyIds=request.getPropertyIds();
  Set<PropertyId> requestPropertyIds=propertyIds == null ? null : new HashSet<PropertyId>(propertyIds);
  providerPropertyIds=new HashSet<PropertyId>(providerPropertyIds);
  if (requestPropertyIds == null || requestPropertyIds.isEmpty()) {
    Iterator<PropertyId> iter=providerPropertyIds.iterator();
    while (iter.hasNext()) {
      PropertyId propertyId=iter.next();
      if (propertyId.isTemporal()) {
        iter.remove();
      }
    }
    return providerPropertyIds;
  }
  if (predicate != null) {
    requestPropertyIds.addAll(PredicateHelper.getPropertyIds(predicate));
  }
  requestPropertyIds.retainAll(providerPropertyIds);
  return requestPropertyIds;
}
