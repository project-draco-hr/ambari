{
  if (metadata != null) {
    if (!output.isKafkaBrokerUp) {
      logger.info("Started writing to kafka. " + output.getShortDescription());
      output.isKafkaBrokerUp=true;
    }
    output.incrementStat(1);
    output.writeBytesMetric.count+=message.length();
  }
 else {
    output.isKafkaBrokerUp=false;
    final String LOG_MESSAGE_KEY=this.getClass().getSimpleName() + "_KAFKA_ASYNC_ERROR";
    LogFeederUtil.logErrorMessageByInterval(LOG_MESSAGE_KEY,"Error sending message to Kafka. Async Callback",exception,logger,Level.ERROR);
    output.failedMessages.add(this);
  }
}
