{
  String jdbcUrl;
  if (context.getCluster() == null) {
    jdbcUrl=getConnectFromCustom(context);
  }
 else {
    if (zookeeperConfigured(context)) {
      jdbcUrl=getFromClusterZookeeperConfig(context);
    }
 else {
      jdbcUrl=getFromHiveConfiguration(context);
    }
  }
  String userName=context.getUsername();
  return new ConnectionConfig(userName,"",jdbcUrl);
}
