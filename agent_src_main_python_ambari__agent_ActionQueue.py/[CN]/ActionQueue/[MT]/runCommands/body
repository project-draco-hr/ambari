def runCommands(self, commands, cleanUps, result):
    failure = False
    cmdResult = []
    for cmd in commands:
        script = cmd['cmd']
        if (script[0] == 'ambari-write-file'):
            response = writeFile(script)
        else:
            response = self.sh.run(script, cmd['user'])
        exitCode = response['exit_code']
        if (exitCode == 0):
            cmdResult.append({'exitCode': exitCode, })
        else:
            failure = True
            cmdResult.append({'exitCode': exitCode, 'stdout': response['stdout'], 'stderr': response['stderr'], })
    result['commandResults'] = cmdResult
    if failure:
        cleanUpResult = []
        for cmd in cleanUps:
            script = cmd['cmd']
            response = self.sh.run(script, cmd['user'])
            exitCode = response['exit_code']
            if (exitCode == 0):
                cleanUpResult.append({'exitCode': exitCode, })
            else:
                cleanUpResult.append({'exitCode': exitCode, 'stdout': response['stdout'], 'stderr': response['stderr'], })
        result['cleanUpCommandResults'] = cleanUpResult
    return result
