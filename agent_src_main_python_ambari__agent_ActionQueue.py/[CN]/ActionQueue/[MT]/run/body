def run(self):
    global clusterId, bluePrintName, bluePrintRevision
    while True:
        while (not q.empty()):
            action = q.get()
            switches = {'START_ACTION': self.startAction, 'STOP_ACTION': self.stopAction, 'RUN_ACTION': self.runAction, }
            result = switches.get(action['kind'], self.unknownAction)(action)
            if ((clusterId != action['clusterId']) or (bluePrintName != action['bluePrintName']) or (bluePrintRevision != action['bluePrintRevision'])):
                clusterId = action['clusterId']
                bluePrintName = action['bluePrintName']
                bluePrintRevision = action['bluePrintRevision']
                output = {'clusterId': clusterId, 'bluePrintName': bluePrintName, 'bluePrintRevision': bluePrintRevision, }
                data = json.dumps(output)
                info = ['ambari-write-file', os.getuid(), os.getgid(), '0700', '/tmp/blueprint', data]
                writeFile(info)
            r.put(result)
