def run(self):
    global clusterId, clusterDefinitionRevision
    while (not self.stopped()):
        while (not q.empty()):
            action = q.get()
            switches = {'START_ACTION': self.startAction, 'RUN_ACTION': self.runAction, 'CREATE_STRUCTURE_ACTION': self.createStructureAction, 'DELETE_STRUCTURE_ACTION': self.deleteStructureAction, 'WRITE_FILE_ACTION': self.writeFileAction, 'INSTALL_AND_CONFIG_ACTION': self.installAndConfigAction, }
            try:
                result = switches.get(action['kind'], self.unknownAction)(action)
            except Exception as err:
                logger.info(err)
                result = self.genResult(action)
                result['exitCode'] = 1
            r.put(result)
        if (not self.stopped()):
            time.sleep(5)
