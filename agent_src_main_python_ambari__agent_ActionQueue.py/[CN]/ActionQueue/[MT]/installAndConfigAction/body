def installAndConfigAction(self, action):
    w = self.writeFileAction(action, self.getInstallFilename(action['id']))
    commandResult = {}
    if (w['exitCode'] != 0):
        commandResult['error'] = w['error']
        commandResult['exitCode'] = w['exitCode']
        r['commandResult'] = commandResult
        return r
    if ('command' not in action):
        filepath = getFilePath(action, self.getInstallFilename(action['id']))
        logger.debug(('FILEPATH : ' + filepath))
        p = self.sh.run(['/bin/cat', AmbariConfig.config.get('puppet', 'driver')])
        if (p['exitCode'] != 0):
            commandResult['error'] = p['error']
            commandResult['exitCode'] = p['exitCode']
            r['commandResult'] = commandResult
            return r
        logger.debug(('The contents of the static file ' + p['output']))
        appendToFile(p['output'], filepath)
        arr = [AmbariConfig.config.get('puppet', 'commandpath'), filepath]
        logger.debug(arr)
        action['command'] = arr
    logger.debug(action['command'])
    r = self.sh.run(action['command'])
    logger.debug(('PUPPET COMMAND OUTPUT: ' + r['output']))
    logger.debug(('PUPPET COMMAND ERROR: ' + r['error']))
    if (r['exitCode'] != 0):
        commandResult['error'] = r['error']
    else:
        installScriptHash = action['id']
    commandResult['exitCode'] = r['exitCode']
    r['commandResult'] = commandResult
    return r
