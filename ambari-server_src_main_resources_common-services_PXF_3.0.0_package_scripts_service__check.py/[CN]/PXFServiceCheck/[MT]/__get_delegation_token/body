def __get_delegation_token(self, user, keytab, principal, kinit_path):
    '\n    Gets the kerberos delegation token from name node\n    '
    import params
    url = (params.namenode_path + '/webhdfs/v1/?op=GETDELEGATIONTOKEN')
    Logger.info('Getting delegation token from {0}'.format(url))
    (response, _, _) = curl_krb_request(Environment.get_instance().tmp_dir, keytab, principal, url, 'get_delegation_token', kinit_path, False, 'Delegation Token', user)
    json_response = json.loads(response)
    if (json_response['Token'] and json_response['Token']['urlString']):
        return json_response['Token']['urlString']
    msg = 'Unable to get delegation token'
    Logger.error(msg)
    raise Fail(msg)
