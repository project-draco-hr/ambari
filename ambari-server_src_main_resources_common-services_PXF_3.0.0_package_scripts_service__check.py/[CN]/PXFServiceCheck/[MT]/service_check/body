def service_check(self, env):
    Logger.info('Starting PXF service checks..')
    import params
    self.pxf_version = self.__get_pxf_protocol_version()
    try:
        try:
            self.cleanup_test_data()
            self.run_hdfs_tests()
            if params.is_hbase_installed:
                self.run_hbase_tests()
        except:
            msg = 'PXF service check failed'
            Logger.error(msg)
            raise Fail(msg)
    finally:
        self.cleanup_test_data()
    Logger.info('Service check completed successfully')
