def pre_upgrade_restart(self, env, upgrade_type=None):
    import params
    env.set_params(params)
    if (params.version and (compare_versions(format_stack_version(params.version), '2.2.0.0') >= 0)):
        Logger.info('Executing Spark Job History Server Stack Upgrade pre-restart')
        conf_select.select(params.stack_name, 'spark', params.version)
        stack_select.select('spark-historyserver', params.version)
        if (params.version and (compare_versions(format_stack_version(params.version), '2.3.0.0') < 0)):
            resource_created = copy_to_hdfs('tez', params.user_group, params.hdfs_user, host_sys_prepped=params.host_sys_prepped)
            if resource_created:
                params.HdfsResource(None, action='execute')
