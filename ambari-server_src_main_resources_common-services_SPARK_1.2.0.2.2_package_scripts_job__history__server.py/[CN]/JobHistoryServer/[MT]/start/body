def start(self, env, rolling_restart=False):
    import params
    env.set_params(params)
    self.configure(env)
    if (not os.path.islink('/usr/hdp/current/spark')):
        hdp_version = get_hdp_version()
        cmd = (('ln -s /usr/hdp/' + hdp_version) + '/spark /usr/hdp/current/spark')
        Execute(cmd)
    daemon_cmd = format('{spark_history_server_start}')
    no_op_test = format('ls {spark_history_server_pid_file} >/dev/null 2>&1 && ps -p `cat {spark_history_server_pid_file}` >/dev/null 2>&1')
    Execute(daemon_cmd, user=params.spark_user, environment={'JAVA_HOME': params.java_home, }, not_if=no_op_test)
