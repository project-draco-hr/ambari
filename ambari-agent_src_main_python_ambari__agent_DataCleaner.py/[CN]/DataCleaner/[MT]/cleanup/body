def cleanup(self):
    for (root, dirs, files) in os.walk(self.data_dir):
        for f in files:
            file_path = os.path.join(root, f)
            if self.compiled_pattern.match(f):
                try:
                    if ((time.time() - os.path.getmtime(file_path)) > self.file_max_age):
                        os.remove(os.path.join(file_path))
                        logger.debug(('Removed file: ' + file_path))
                except Exception:
                    logger.error(('Error when removing file: ' + file_path))
