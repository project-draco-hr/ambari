def test_add_config(self):
    '\n    Set desired configurations\n    '
    http_client_mock = MagicMock()
    propr_dict = {'dfs_name_dir': '/data/1/hadoop/hdfs/namenode,/data/2/hadoop/hdfs/namenode,/data/3/hadoop/hdfs/namenode,/data/4/hadoop/hdfs/namenode,/data/5/hadoop/hdfs/namenode,/data/6/hadoop/hdfs/namenode,/data/7/hadoop/hdfs/namenode,/data/8/hadoop/hdfs/namenode', 'namenode_heapsize': '1024m', 'namenode_opt_newsize': '200m', 'fs_checkpoint_dir': '/data/1/hadoop/hdfs/namesecondary', 'dfs_data_dir': '/data/1/hadoop/hdfs/data,/data/2/hadoop/hdfs/data,/data/3/hadoop/hdfs/data,/data/4/hadoop/hdfs/data,/data/5/hadoop/hdfs/data,/data/6/hadoop/hdfs/data,/data/7/hadoop/hdfs/data,/data/8/hadoop/hdfs/data,/data/9/hadoop/hdfs/data,/data/10/hadoop/hdfs/data', 'dtnode_heapsize': '1024m', 'dfs_datanode_failed_volume_tolerated': '0', 'dfs_webhdfs_enabled': 'true', 'hadoop_heapsize': '1024', 'datanode_du_reserved': '0', 'fs_checkpoint_period': '21600', 'fs_checkpoint_size': '67108864', 'hdfs_log_dir_prefix': '/var/log/hadoop', 'hadoop_pid_dir_prefix': '/var/run/hadoop', 'namenode_opt_maxnewsize': '200m', 'dfs_exclude': 'dfs.exclude', 'dfs_include': 'dfs.include', 'dfs_replication': '3', 'dfs_block_local_path_access_user': 'hbase', 'dfs_datanode_data_dir_perm': '750', 'security_enabled': 'false', 'namenode_formatted_mark_dir': '/var/run/hadoop/hdfs/namenode/formatted/', 'hcat_conf_dir': '', 'jtnode_opt_newsize': '200m', 'jtnode_opt_maxnewsize': '200m', 'jtnode_heapsize': '1024m', 'mapred_local_dir': '/data/1/hadoop/mapred,/data/2/hadoop/mapred,/data/3/hadoop/mapred,/data/4/hadoop/mapred,/data/5/hadoop/mapred,/data/6/hadoop/mapred,/data/7/hadoop/mapred,/data/8/hadoop/mapred,/data/9/hadoop/mapred,/data/10/hadoop/mapred', 'mapred_map_tasks_max': '4', 'mapred_red_tasks_max': '2', 'mapred_child_java_opts_sz': '768', 'scheduler_name': 'org.apache.hadoop.mapred.CapacityTaskScheduler', 'mapred_cluster_map_mem_mb': '1536', 'mapred_cluster_red_mem_mb': '2048', 'mapred_cluster_max_map_mem_mb': '6144', 'mapred_cluster_max_red_mem_mb': '4096', 'mapred_job_map_mem_mb': '1536', 'mapred_job_red_mem_mb': '2048', 'io_sort_mb': '200', 'io_sort_spill_percent': '0.9', 'mapreduce_userlog_retainhours': '24', 'maxtasks_per_job': '-1', 'lzo_enabled': 'true', 'snappy_enabled': 'true', 'rca_enabled': 'true', 'mapred_system_dir': '/mapred/system', 'mapred_hosts_exclude': 'mapred.exclude', 'mapred_hosts_include': 'mapred.include', 'mapred_jobstatus_dir': 'file:////mapred/jobstatus', 'nagios_web_login': 'nagiosadmin', 'nagios_web_password': 'admin', 'nagios_contact': 'admin@admin.com', 'nagios_group': 'nagios', 'hbase_conf_dir': '/etc/hbase', 'proxyuser_group': 'users', 'dfs_datanode_address': '50010', 'dfs_datanode_http_address': '50075', 'gpl_artifacts_download_url': '', 'apache_artifacts_download_url': '', 'ganglia_runtime_dir': '/var/run/ganglia/hdp', 'java64_home': '/usr/jdk/jdk1.6.0_31', 'run_dir': '/var/run/hadoop', 'hadoop_conf_dir': '/etc/hadoop', 'hdfs_user': 'hdfs', 'mapred_user': 'mapred', 'hbase_user': 'hbase', 'hive_user': 'hive', 'hcat_user': 'hcat', 'webhcat_user': 'hcat', 'oozie_user': 'oozie', 'zk_user': 'zookeeper', 'gmetad_user': 'nobody', 'gmond_user': 'nobody', 'nagios_user': 'nagios', 'smokeuser': 'ambari-qa', 'user_group': 'hadoop', 'rrdcached_base_dir': '/var/lib/ganglia/rrds', }
    expected_path = '//clusters/test1'
    expected_request = {'Clusters': {'desired_configs': {'tag': 'version1', 'type': 'global', 'properties': propr_dict, }, }, }
    cluster = self.create_cluster(http_client_mock)
    resp = cluster.add_config('global', 'version1', propr_dict)
    self.assertEqual(cluster.cluster_name, 'test1')
    http_client_mock.invoke.assert_called_with('PUT', expected_path, headers=None, payload=expected_request)
