{
  Collection<Stage> stages;
  CalculatedStatus status;
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.COMPLETED,status.getStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.IN_PROGRESS,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.IN_PROGRESS,status.getStatus());
  assertEquals(48.3,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.PENDING,status.getStatus());
  assertEquals(0.0,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.FAILED,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.FAILED,status.getStatus());
  assertEquals(55.55,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.TIMEDOUT),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.TIMEDOUT,status.getStatus());
  assertEquals(66.66,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.HOLDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.HOLDING,status.getStatus());
  assertNull(status.getDisplayStatus());
  assertEquals(47.5,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.ABORTED),getTaskEntities(HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED),getTaskEntities(HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.ABORTED));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.ABORTED,status.getStatus());
  assertNull(status.getDisplayStatus());
  assertEquals(100.0,status.getPercent(),0.1);
  stages=getStages(getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED,HostRoleStatus.COMPLETED),getTaskEntities(HostRoleStatus.ABORTED,HostRoleStatus.ABORTED,HostRoleStatus.PENDING),getTaskEntities(HostRoleStatus.PENDING,HostRoleStatus.PENDING,HostRoleStatus.PENDING));
  status=CalculatedStatus.statusFromStages(stages);
  assertEquals(HostRoleStatus.IN_PROGRESS,status.getStatus());
  assertNull(status.getDisplayStatus());
  assertEquals(66.6,status.getPercent(),0.1);
}
