{
  ClusterController clusterController=ClusterControllerHelper.getClusterController();
  try {
    Set<Resource> resources=clusterController.getResources(Resource.Type.Cluster,PropertyHelper.getReadRequest(),null);
    if (resources.size() > 0) {
      Resource clusterResource=resources.iterator().next();
      AmbariClusterInfo clusterInfo=new AmbariClusterInfo();
      clusterInfo.setName(clusterResource.getPropertyValue("Clusters/cluster_name").toString());
      clusterInfo.setVersion(clusterResource.getPropertyValue("Clusters/version").toString());
      return clusterInfo;
    }
  }
 catch (  UnsupportedPropertyException e) {
    logger.warn("Unable to determine Ambari cluster",e);
    throw new RuntimeException(e.getMessage(),e);
  }
catch (  NoSuchResourceException e) {
    logger.warn("Unable to determine Ambari cluster",e);
    throw new RuntimeException(e.getMessage(),e);
  }
catch (  NoSuchParentResourceException e) {
    logger.warn("Unable to determine Ambari cluster",e);
    throw new RuntimeException(e.getMessage(),e);
  }
catch (  SystemException e) {
    logger.warn("Unable to determine Ambari cluster",e);
    throw new RuntimeException(e.getMessage(),e);
  }
  return null;
}
