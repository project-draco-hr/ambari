{
  this.configuration=configuration;
  try {
    Class.forName(configuration.getDatabaseDriver());
    connection=DriverManager.getConnection(configuration.getDatabaseUrl(),configuration.getDatabaseUser(),configuration.getDatabasePassword());
    connection.setAutoCommit(true);
    String vendorName=connection.getMetaData().getDatabaseProductName() + connection.getMetaData().getDatabaseMajorVersion();
    String dbPlatform=DBPlatformHelper.getDBPlatform(vendorName,new AbstractSessionLog(){
      @Override public void log(      SessionLogEntry sessionLogEntry){
        LOG.debug(sessionLogEntry.getMessage());
      }
    }
);
    databasePlatform=(DatabasePlatform)Class.forName(dbPlatform).newInstance();
    dbmsHelper=loadHelper(databasePlatform);
    dbSchema=convertObjectName(configuration.getDatabaseSchema());
  }
 catch (  Exception e) {
    String message="Error while creating database accessor ";
    LOG.error(message,e);
    throw new RuntimeException(e);
  }
}
