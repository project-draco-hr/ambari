{
  Map<Status,String> stateToHost=new HashMap<Status,String>();
  if (hosts != null && hosts.size() == 2) {
    for (    String hostname : hosts) {
      String state=queryJmxBeanValue(hostname,50070,"Hadoop:service=NameNode,name=NameNodeStatus","State",true);
      if (null != state && (state.equalsIgnoreCase(Status.ACTIVE.toString()) || state.equalsIgnoreCase(Status.STANDBY.toString()))) {
        Status status=Status.valueOf(state.toUpperCase());
        stateToHost.put(status,hostname);
      }
    }
    if (stateToHost.containsKey(Status.ACTIVE) && stateToHost.containsKey(Status.STANDBY) && !stateToHost.get(Status.ACTIVE).equalsIgnoreCase(stateToHost.get(Status.STANDBY))) {
      return stateToHost;
    }
  }
  return null;
}
