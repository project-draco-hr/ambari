{
  String s="http://" + target + "/jmx?qry="+ (bean == null ? "Hadoop:*" : bean);
  try {
    URLConnection connection=new URL(s).openConnection();
    connection.setDoOutput(true);
    return new ObjectMapper().readValue(connection.getInputStream(),JMXMetrics.class);
  }
 catch (  IOException e) {
    throw new IllegalStateException("Can't get metric " + ".",e);
  }
}
