{
  for (  String clusterName : clustersProvider.get().getClusters().keySet()) {
    final PrereqCheckRequest clusterRequest=new PrereqCheckRequest(clusterName);
    mapReduceCheck.get().perform(prerequisiteCheck,clusterRequest);
    if (prerequisiteCheck.getStatus() == PrereqCheckStatus.FAIL) {
      prerequisiteCheck.getFailedOn().clear();
      prerequisiteCheck.getFailedOn().add("OOZIE");
      prerequisiteCheck.setFailReason("MapReduce on cluster " + clusterName + " should reference hadoop libraries from the distributed cache. "+ "Make sure that mapreduce.application.framework.path and mapreduce.application.classpath properties are present in mapred.site.xml"+ "and point to hdfs:/... urls");
      break;
    }
  }
}
