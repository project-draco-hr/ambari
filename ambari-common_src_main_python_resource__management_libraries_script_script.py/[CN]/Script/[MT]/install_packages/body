def install_packages(self, env, exclude_packages=[]):
    '\n    List of packages that are required< by service is received from the server\n    as a command parameter. The method installs all packages\n    from this list\n    '
    config = self.get_config()
    if ('host_sys_prepped' in config['hostLevelParams']):
        if (config['hostLevelParams']['host_sys_prepped'] == True):
            Logger.info('Node has all packages pre-installed. Skipping.')
            return
        pass
    try:
        package_list_str = config['hostLevelParams']['package_list']
        if (isinstance(package_list_str, basestring) and (len(package_list_str) > 0)):
            package_list = json.loads(package_list_str)
            for package in package_list:
                if (not (package['name'] in exclude_packages)):
                    name = package['name']
                    if OSCheck.is_windows_family():
                        if (name[(-4):] == '.msi'):
                            Msi(name, http_source=os.path.join(config['hostLevelParams']['jdk_location']))
                    else:
                        Package(name)
    except KeyError:
        pass
    if OSCheck.is_windows_family():
        install_windows_msi(os.path.join(config['hostLevelParams']['jdk_location'], 'hdp.msi'), config['hostLevelParams']['agentCacheDir'], 'hdp.msi', self.get_password('hadoop'), str(config['hostLevelParams']['stack_version']))
        reload_windows_env()
    pass
