def service_check(self, env):
    import params
    env.set_params(params)
    prepare_hdfs_file_name = 'prepareOozieHdfsDirectories.sh'
    smoke_test_file_name = 'oozieSmoke2.sh'
    if ('yarn-site' in params.config['configurations']):
        XmlConfig('yarn-site.xml', conf_dir=params.hadoop_conf_dir, configurations=params.config['configurations']['yarn-site'], owner=params.hdfs_user, group=params.user_group, mode=420)
    else:
        raise Fail('yarn-site.xml was not present in config parameters.')
    OozieServiceCheckDefault.oozie_smoke_shell_file(smoke_test_file_name, prepare_hdfs_file_name)
