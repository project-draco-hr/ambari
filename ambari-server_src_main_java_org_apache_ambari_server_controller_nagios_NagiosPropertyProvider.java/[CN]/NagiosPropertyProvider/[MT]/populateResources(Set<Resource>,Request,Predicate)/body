{
  Set<String> propertyIds=getRequestPropertyIds(request,predicate);
  for (  Resource res : resources) {
    String matchValue=res.getPropertyValue(resourceTypeProperty).toString();
    if (null == matchValue)     continue;
    Object clusterPropertyValue=res.getPropertyValue(clusterNameProperty);
    if (null == clusterPropertyValue)     continue;
    String clusterName=clusterPropertyValue.toString();
    if (null == clusterName)     continue;
    if (!CLUSTER_ALERTS.containsKey(clusterName)) {
      CLUSTER_ALERTS.put(clusterName,new AlertState(populateAlerts(clusterName)));
    }
 else     if (CLUSTER_ALERTS.get(clusterName).isReloadNeeded().get()) {
      LOG.debug("Alerts are stale for cluster " + clusterName);
      CLUSTER_ALERTS.get(clusterName).setAlerts(populateAlerts(clusterName));
      CLUSTER_ALERTS.get(clusterName).isReloadNeeded().set(false);
    }
    updateAlerts(res,matchValue,CLUSTER_ALERTS.get(clusterName).getAlerts(),propertyIds);
  }
  return resources;
}
