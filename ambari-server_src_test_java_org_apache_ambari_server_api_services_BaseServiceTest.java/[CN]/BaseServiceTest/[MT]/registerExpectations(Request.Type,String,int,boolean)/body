{
  expect(requestFactory.createRequest(eq(httpHeaders),body == null ? isNull(String.class) : eq(body),eq(uriInfo),eq(type),eq(resourceInstance))).andReturn(request);
  expect(request.getRequestType()).andReturn(type).anyTimes();
  expect(request.getResultSerializer()).andReturn(serializer).anyTimes();
  expect(requestHandler.handleRequest(request)).andReturn(result);
  expect(result.getStatus()).andReturn(status).anyTimes();
  expect(status.isErrorState()).andReturn(isErrorState).anyTimes();
  expect(status.getStatusCode()).andReturn(statusCode);
  if (!isErrorState) {
    expect(request.getResultPostProcessor()).andReturn(resultProcessor);
    resultProcessor.process(result);
  }
  expect(serializer.serialize(result)).andReturn(serializedResult);
}
