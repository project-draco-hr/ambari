{
  String tableName=tableInfo.getTableName();
  List<ColumnDescriptionImpl> cdList=tableInfo.getColumns();
  StringBuilder query=new StringBuilder();
  query.append("create table " + tableName + " (");
  Collections.sort(cdList,new Comparator<ColumnDescription>(){
    @Override public int compare(    ColumnDescription o1,    ColumnDescription o2){
      return o1.getPosition() - o2.getPosition();
    }
  }
);
  boolean first=true;
  for (  ColumnDescriptionImpl cd : cdList) {
    if (first) {
      first=false;
    }
 else {
      query.append(", ");
    }
    query.append(cd.getName() + " " + cd.getType());
    if (cd.getPrecision() != null) {
      query.append("(").append(cd.getPrecision());
      if (cd.getScale() != null) {
        query.append(",").append(cd.getScale());
      }
      query.append(")");
    }
  }
  query.append(")");
  if (tableInfo.getHiveFileType() == HiveFileType.TEXTFILE)   query.append(" ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' STORED AS TEXTFILE;");
 else   query.append(" STORED AS " + tableInfo.getHiveFileType() + ";");
  String queryString=query.toString();
  LOG.info("Query : {}",queryString);
  return queryString;
}
