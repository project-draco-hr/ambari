{
  Set<Resource> resources;
  ResourceProvider provider=ensureResourceProvider(type);
  ResourcePredicateEvaluator evaluator=provider instanceof ResourcePredicateEvaluator ? (ResourcePredicateEvaluator)provider : DEFAULT_RESOURCE_PREDICATE_EVALUATOR;
  if (!providerResources.isEmpty()) {
    Comparator<Resource> resourceComparator=pageRequest == null || pageRequest.getComparator() == null ? comparator : pageRequest.getComparator();
    TreeSet<Resource> sortedResources=new TreeSet<Resource>(resourceComparator);
    sortedResources.addAll(providerResources);
    if (pageRequest != null) {
switch (pageRequest.getStartingPoint()) {
case Beginning:
        return getPageFromOffset(pageRequest.getPageSize(),0,sortedResources,request,predicate,evaluator);
case End:
      return getPageToOffset(pageRequest.getPageSize(),-1,sortedResources,request,predicate,evaluator);
case OffsetStart:
    return getPageFromOffset(pageRequest.getPageSize(),pageRequest.getOffset(),sortedResources,request,predicate,evaluator);
case OffsetEnd:
  return getPageToOffset(pageRequest.getPageSize(),pageRequest.getOffset(),sortedResources,request,predicate,evaluator);
}
}
resources=sortedResources;
}
 else {
resources=providerResources;
}
return new PageResponseImpl(new ResourceIterable(resources,request,predicate,evaluator),0,null,null);
}
