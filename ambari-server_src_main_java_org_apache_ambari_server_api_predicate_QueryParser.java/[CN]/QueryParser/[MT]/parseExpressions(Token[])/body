{
  ParseContext ctx=new ParseContext();
  for (  Token token : tokens) {
    TOKEN_HANDLERS.get(token.getType()).handleToken(token,ctx);
  }
  if (ctx.getPrecedenceLevel() != 0) {
    throw new InvalidQueryException("Invalid query string: mismatched parentheses.");
  }
  return ctx;
}
