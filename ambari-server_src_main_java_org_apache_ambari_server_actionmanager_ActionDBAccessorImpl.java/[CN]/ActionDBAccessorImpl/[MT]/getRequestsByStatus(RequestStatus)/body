{
  boolean match=true;
  Set<HostRoleStatus> statuses=new HashSet<HostRoleStatus>();
  if (status == RequestStatus.IN_PROGRESS) {
    statuses.addAll(Arrays.asList(HostRoleStatus.PENDING,HostRoleStatus.IN_PROGRESS,HostRoleStatus.QUEUED));
  }
 else   if (status == RequestStatus.COMPLETED) {
    match=false;
    statuses.addAll(Arrays.asList(HostRoleStatus.PENDING,HostRoleStatus.IN_PROGRESS,HostRoleStatus.QUEUED,HostRoleStatus.ABORTED,HostRoleStatus.FAILED,HostRoleStatus.FAILED,HostRoleStatus.TIMEDOUT));
  }
 else   if (status == RequestStatus.FAILED) {
    statuses.addAll(Arrays.asList(HostRoleStatus.ABORTED,HostRoleStatus.FAILED,HostRoleStatus.FAILED,HostRoleStatus.TIMEDOUT));
  }
  return hostRoleCommandDAO.getRequestsByTaskStatus(statuses,match);
}
