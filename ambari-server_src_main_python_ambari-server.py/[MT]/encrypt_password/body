def encrypt_password(alias, password):
    properties = get_ambari_properties()
    if (properties == (-1)):
        raise FatalException(1, None)
    isSecure = get_is_secure(properties)
    (isPersisted, masterKeyFile) = get_is_persisted(properties)
    if isSecure:
        masterKey = None
        if (not masterKeyFile):
            masterKey = get_original_master_key(properties)
        retCode = save_passwd_for_alias(alias, password, masterKey)
        if (retCode != 0):
            print 'Failed to save secure password!'
            return password
        else:
            return get_alias_string(alias)
    return password
