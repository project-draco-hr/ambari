def get_truststore_password(properties):
    truststore_password = properties.get_property(SSL_TRUSTSTORE_PASSWORD_PROPERTY)
    if truststore_password:
        truststore_password = decrypt_password_for_alias(SSL_TRUSTSTORE_PASSWORD_ALIAS)
    else:
        truststore_password = read_password('', '.*', 'Password for TrustStore:', 'Invalid characters in password')
        if truststore_password:
            properties.process_pair(SECURITY_IS_ENCRYPTION_ENABLED, 'true')
            encrypted_password = get_encrypted_password(SSL_TRUSTSTORE_PASSWORD_ALIAS, truststore_password, properties)
            properties.process_pair(SSL_TRUSTSTORE_PASSWORD_PROPERTY, encrypted_password)
    return truststore_password
