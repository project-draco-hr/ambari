def wait_popen(popen, timeout=0):
    begin = time.time()
    while ((popen.poll() is None) and (not ((time.time() - begin) > timeout))):
        time.sleep(1)
    return popen.poll()
