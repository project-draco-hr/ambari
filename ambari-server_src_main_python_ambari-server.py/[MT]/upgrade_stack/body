def upgrade_stack(args, stack_id):
    if (not is_root()):
        err = 'Ambari-server upgradestack should be run with root-level privileges'
        raise FatalException(4, err)
    check_database_name_property()
    (stack_name, stack_version) = stack_id.split(STACK_NAME_VER_SEP)
    retcode = run_stack_upgrade(stack_name, stack_version)
    if (not (retcode == 0)):
        raise FatalException(retcode, 'Stack upgrade failed.')
    return retcode
