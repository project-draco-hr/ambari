def service_check(self, env):
    import params
    env.set_params(params)
    kafka_config = self.read_kafka_config(params.conf_dir)
    self.set_env(params.conf_dir)
    create_topic_cmd_created_output = 'Created topic "ambari_kafka_service_check".'
    create_topic_cmd_exists_output = 'Topic "ambari_kafka_service_check" already exists.'
    create_topic_cmd = [(params.kafka_home + '/bin/kafka-topics.sh'), ('--zookeeper ' + kafka_config['zookeeper.connect']), '--create --topic ambari_kafka_service_check', '--partitions 1 --replication-factor 1']
    create_topic_process = subprocess.Popen(create_topic_cmd, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
    (out, err) = create_topic_process.communicate()
    if ((out.find(create_topic_cmd_created_output) != (-1)) or (out.find(create_topic_cmd_exists_output) != (-1))):
        sys.exit(0)
    else:
        sys.exit(1)
