{
  String uri="http://foo.bar.com/api/v1/clusters?foo=bar&orProp1=5|orProp2!=6|orProp3<100&prop!=5&prop2>10&prop3>=20&prop4<500&prop5<=1&fields=field1,category/field2";
  Request request=new TestRequest(null,null,null,Request.Type.GET,null,uri);
  Predicate predicate=request.getQueryPredicate();
  Set<Predicate> setPredicates=new HashSet<Predicate>();
  setPredicates.add(new EqualsPredicate(PropertyHelper.getPropertyId("foo"),"bar"));
  Set<Predicate> setOrPredicates=new HashSet<Predicate>();
  setOrPredicates.add(new EqualsPredicate(PropertyHelper.getPropertyId("orProp1"),"5"));
  setOrPredicates.add(new NotPredicate(new EqualsPredicate(PropertyHelper.getPropertyId("orProp2"),"6")));
  setOrPredicates.add(new LessPredicate(PropertyHelper.getPropertyId("orProp3"),"100"));
  setPredicates.add(new OrPredicate(setOrPredicates.toArray(new BasePredicate[3])));
  setPredicates.add(new NotPredicate(new EqualsPredicate(PropertyHelper.getPropertyId("prop"),"5")));
  setPredicates.add(new GreaterPredicate(PropertyHelper.getPropertyId("prop2"),"10"));
  setPredicates.add(new GreaterEqualsPredicate(PropertyHelper.getPropertyId("prop3"),"20"));
  setPredicates.add(new LessPredicate(PropertyHelper.getPropertyId("prop4"),"500"));
  setPredicates.add(new LessEqualsPredicate(PropertyHelper.getPropertyId("prop5"),"1"));
  Predicate expectedPredicate=new AndPredicate(setPredicates.toArray(new BasePredicate[6]));
  assertEquals(expectedPredicate,predicate);
}
