@OsFamilyFuncImpl(os_family=OsFamilyImpl.DEFAULT)
def pre_rolling_restart(self, env):
    import params
    env.set_params(params)
    if ((not params.version) or Script.is_hdp_stack_less_than('2.2')):
        return
    Logger.info('Executing Flume Rolling Upgrade pre-restart')
    conf_select.select(params.stack_name, 'flume', params.version)
    hdp_select.select('flume-server', params.version)
    if (params.upgrade_direction == Direction.UPGRADE):
        flume_upgrade.pre_start_restore()
