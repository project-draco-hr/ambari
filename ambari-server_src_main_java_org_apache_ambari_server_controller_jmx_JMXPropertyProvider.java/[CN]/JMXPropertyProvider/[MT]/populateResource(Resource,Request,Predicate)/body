{
  if (getPropertyIds().isEmpty()) {
    return true;
  }
  Set<PropertyId> ids=PropertyHelper.getRequestPropertyIds(getPropertyIds(),request,predicate);
  String hostName=hostMapping.get(resource.getPropertyValue(HOST_COMPONENT_HOST_NAME_PROPERTY_ID));
  String componentName=(String)resource.getPropertyValue(HOST_COMPONENT_COMPONENT_NAME_PROPERTY_ID);
  String port=JMX_PORTS.get(componentName);
  Map<PropertyId,String> metrics=componentMetrics.get(componentName);
  if (metrics == null || hostName == null || port == null) {
    return true;
  }
  String spec=getSpec(hostName + ":" + port);
  try {
    JMXMetricHolder metricHolder=new ObjectMapper().readValue(streamProvider.readFrom(spec),JMXMetricHolder.class);
    Map<String,Map<String,Object>> categories=new HashMap<String,Map<String,Object>>();
    for (    Map<String,Object> bean : metricHolder.getBeans()) {
      String category=getCategory(bean);
      if (category != null) {
        categories.put(category,bean);
      }
    }
    for (    PropertyId propertyId : ids) {
      String metricName=metrics.get(propertyId);
      if (metricName != null) {
        String property=metricName;
        String category="";
        int i=property.lastIndexOf('.');
        if (i != -1) {
          category=property.substring(0,i);
          property=property.substring(i + 1);
        }
        Map<String,Object> properties=categories.get(category);
        if (properties != null && properties.containsKey(property)) {
          resource.setProperty(propertyId,properties.get(property));
        }
      }
    }
  }
 catch (  IOException e) {
    throw new AmbariException("Can't get metrics : " + spec,e);
  }
  return true;
}
