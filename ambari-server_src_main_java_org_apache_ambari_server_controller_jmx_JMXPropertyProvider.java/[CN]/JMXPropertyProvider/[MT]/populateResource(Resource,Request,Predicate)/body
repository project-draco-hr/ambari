{
  if (getPropertyIds().isEmpty()) {
    return true;
  }
  Set<PropertyId> ids=PropertyHelper.getRequestPropertyIds(getPropertyIds(),request,predicate);
  String hostName=hostMapping.get(resource.getPropertyValue(HOST_COMPONENT_HOST_NAME_PROPERTY_ID));
  String port=JMX_PORTS.get(resource.getPropertyValue(HOST_COMPONENT_COMPONENT_NAME_PROPERTY_ID));
  if (hostName == null || port == null) {
    return true;
  }
  String spec=getSpec(hostName + ":" + port);
  try {
    JMXMetricHolder metricHolder=new ObjectMapper().readValue(streamProvider.readFrom(spec),JMXMetricHolder.class);
    for (    Map<String,String> propertyMap : metricHolder.getBeans()) {
      String category=propertyMap.get(CATEGORY_KEY);
      if (category != null) {
        for (        Map.Entry<String,String> entry : propertyMap.entrySet()) {
          PropertyId propertyId=PropertyHelper.getPropertyId(entry.getKey(),category);
          if (ids.contains(propertyId)) {
            resource.setProperty(propertyId,entry.getValue());
          }
        }
      }
    }
  }
 catch (  IOException e) {
    throw new AmbariException("Can't get metrics : " + spec,e);
  }
  return true;
}
