@patch('subprocess.Popen')
def test_run_os_command_exception(self, popen_mock):

    def base_test():
        return 'base test'

    def sub_test():
        return ('output 1', 'error 1')
    base_test.communicate = sub_test
    base_test.returncode = 0
    hostInfo = HostInfo()
    for firewallType in hostInfo.getFirewallObjectTypes():
        firewall = firewallType()
        popen_mock.side_effect = None
        popen_mock.return_value = base_test
        self.assertTrue(firewall.check_iptables())
        popen_mock.side_effect = OSError('File not found')
        popen_mock.return_value = None
        self.assertFalse(firewall.check_iptables())
