{
  long submitTimeX=transformX(submitTime);
  long finishTimeX=transformX(finishTime);
  List<TaskAttempt> mapAttempts=conn.fetchTaskAttempts(jobId,"MAP");
  List<TaskAttempt> reduceAttempts=conn.fetchTaskAttempts(jobId,"REDUCE");
  Set<Long> xPoints=getXPoints(mapAttempts,reduceAttempts,submitTimeX,finishTimeX);
  Long[] xList=xPoints.toArray(new Long[xPoints.size()]);
  MinMax io=new MinMax();
  data.setMapNodeLocal(processLocalityData(mapAttempts,"NODE_LOCAL",xList,io));
  data.setMapRackLocal(processLocalityData(mapAttempts,"RACK_LOCAL",xList,io));
  data.setMapOffSwitch(processLocalityData(mapAttempts,"OFF_SWITCH",xList,io));
  data.setReduceOffSwitch(processLocalityData(reduceAttempts,"OFF_SWITCH",xList,io));
  setRValues(data.getMapNodeLocal(),minr,maxr,io.max);
  setRValues(data.getMapRackLocal(),minr,maxr,io.max);
  setRValues(data.getMapOffSwitch(),minr,maxr,io.max);
  setRValues(data.getReduceOffSwitch(),minr,maxr,io.max);
  data.setSubmitTime(submitTimeX);
  data.setFinishTime(finishTimeX);
}
