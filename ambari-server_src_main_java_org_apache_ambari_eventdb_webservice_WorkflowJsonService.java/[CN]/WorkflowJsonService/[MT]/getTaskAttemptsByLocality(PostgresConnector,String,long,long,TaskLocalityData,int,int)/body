{
  long submitTimeX=transformX(submitTime);
  long finishTimeX=transformX(finishTime);
  List<TaskAttempt> taskAttempts=conn.fetchJobTaskAttempts(jobId);
  Set<Long> xPoints=getXPoints(taskAttempts,submitTimeX,finishTimeX);
  Long[] xList=xPoints.toArray(new Long[xPoints.size()]);
  MinMax io=new MinMax();
  data.setMapNodeLocal(processLocalityData(taskAttempts,"MAP","NODE_LOCAL",xList,io));
  data.setMapRackLocal(processLocalityData(taskAttempts,"MAP","RACK_LOCAL",xList,io));
  data.setMapOffSwitch(processLocalityData(taskAttempts,"MAP","OFF_SWITCH",xList,io));
  data.setReduceOffSwitch(processLocalityData(taskAttempts,"REDUCE","OFF_SWITCH",xList,io));
  setRValues(data.getMapNodeLocal(),minr,maxr,io.max);
  setRValues(data.getMapRackLocal(),minr,maxr,io.max);
  setRValues(data.getMapOffSwitch(),minr,maxr,io.max);
  setRValues(data.getReduceOffSwitch(),minr,maxr,io.max);
  data.setSubmitTime(submitTimeX);
  data.setFinishTime(finishTimeX);
}
