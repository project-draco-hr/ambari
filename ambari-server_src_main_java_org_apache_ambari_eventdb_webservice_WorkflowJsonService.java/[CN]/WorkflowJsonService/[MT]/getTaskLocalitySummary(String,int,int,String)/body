{
  if (maxr < minr)   maxr=minr;
  TaskLocalityData data=new TaskLocalityData();
  PostgresConnector conn=null;
  try {
    conn=getConnector();
    if (jobId != null) {
      long[] times=conn.fetchJobStartStopTimes(jobId);
      if (times != null) {
        getApproxTaskAttemptsByLocality(conn.fetchJobTaskAttempts(jobId),times[0],times[1],data,minr,maxr);
      }
    }
 else     if (workflowId != null) {
      getExactTaskAttemptsByLocality(conn.fetchWorkflowTaskAttempts(workflowId),data,minr,maxr);
    }
  }
 catch (  IOException e) {
    LOG.error("Error interacting with RCA database ",e);
  }
 finally {
    if (conn != null) {
      conn.close();
    }
  }
  return data;
}
