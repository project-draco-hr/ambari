{
  Workflows workflows=EMPTY_WORKFLOWS;
  PostgresConnector conn=null;
  try {
    conn=getConnector();
    if (field == null)     workflows=conn.fetchWorkflows();
 else {
      field=field.toUpperCase();
      if ("ELAPSEDTIME".equals(field))       field="DURATION";
      workflows=conn.fetchWorkflows(WorkflowFields.valueOf(field),sortDir.toUpperCase().equals(PostgresConnector.SORT_ASC),offset,limit);
    }
  }
 catch (  IOException e) {
    LOG.error("Error interacting with RCA database ",e);
    workflows=EMPTY_WORKFLOWS;
  }
 finally {
    if (conn != null) {
      conn.close();
    }
  }
  return workflows;
}
