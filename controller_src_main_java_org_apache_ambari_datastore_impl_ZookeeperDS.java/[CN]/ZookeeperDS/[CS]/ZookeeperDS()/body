{
  String zookeeperAddress=DEFAULT_ZOOKEEPER_ADDRESS;
  try {
    zk=new ZooKeeper(zookeeperAddress,600000,this);
    if (credential != null) {
      zk.addAuthInfo("digest",credential.getBytes());
    }
    while (!this.zkCoonected) {
      Thread.sleep(5000);
      System.out.println("Waiting for ZK connection");
    }
    createDirectory(ZOOKEEPER_ROOT_PATH,new byte[0],true);
    createDirectory(ZOOKEEPER_CLUSTERS_ROOT_PATH,new byte[0],true);
    createDirectory(ZOOKEEPER_STACKS_ROOT_PATH,new byte[0],true);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
