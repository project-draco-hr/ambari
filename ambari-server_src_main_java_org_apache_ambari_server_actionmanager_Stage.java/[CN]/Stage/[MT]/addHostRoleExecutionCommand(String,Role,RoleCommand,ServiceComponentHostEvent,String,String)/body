{
  HostRoleCommand hrc=new HostRoleCommand(host,role,event,command);
  ExecutionCommand cmd=new ExecutionCommand();
  ExecutionCommandWrapper wrapper=new ExecutionCommandWrapper(cmd);
  hrc.setExecutionCommandWrapper(wrapper);
  cmd.setHostname(host);
  cmd.setClusterName(clusterName);
  cmd.setServiceName(serviceName);
  cmd.setCommandId(this.getActionId());
  cmd.setRole(role.name());
  cmd.setRoleCommand(command);
  Map<String,HostRoleCommand> hrcMap=this.hostRoleCommands.get(host);
  if (hrcMap == null) {
    hrcMap=new LinkedHashMap<String,HostRoleCommand>();
    this.hostRoleCommands.put(host,hrcMap);
  }
  if (hrcMap.get(role.toString()) != null) {
    throw new RuntimeException("Setting the host role command second time for same stage: stage=" + this.getActionId() + ", host="+ host+ ", role="+ role);
  }
  hrcMap.put(role.toString(),hrc);
  List<ExecutionCommandWrapper> execCmdList=this.commandsToSend.get(host);
  if (execCmdList == null) {
    execCmdList=new ArrayList<ExecutionCommandWrapper>();
    this.commandsToSend.put(host,execCmdList);
  }
  if (execCmdList.contains(wrapper)) {
    throw new RuntimeException("Setting the execution command second time for same stage: stage=" + this.getActionId() + ", host="+ host+ ", role="+ role);
  }
  execCmdList.add(wrapper);
}
