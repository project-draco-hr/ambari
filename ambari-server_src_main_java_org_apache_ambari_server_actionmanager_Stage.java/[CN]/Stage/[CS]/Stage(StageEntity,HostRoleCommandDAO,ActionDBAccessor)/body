{
  requestId=stageEntity.getRequestId();
  stageId=stageEntity.getStageId();
  logDir=stageEntity.getLogInfo();
  clusterName=stageEntity.getCluster().getClusterName();
  requestContext=stageEntity.getRequestContext();
  clusterHostInfo=stageEntity.getClusterHostInfo();
  List<Long> taskIds=hostRoleCommandDAO.findTaskIdsByStage(requestId,stageId);
  Collection<HostRoleCommand> commands=dbAccessor.getTasks(taskIds);
  for (  HostRoleCommand command : commands) {
    String hostname=command.getHostName();
    if (!hostRoleCommands.containsKey(hostname)) {
      commandsToSend.put(hostname,new ArrayList<ExecutionCommandWrapper>());
      hostRoleCommands.put(hostname,new TreeMap<String,HostRoleCommand>());
    }
    hostRoleCommands.get(hostname).put(command.getRole().toString(),command);
    commandsToSend.get(hostname).add(command.getExecutionCommandWrapper());
  }
  for (  RoleSuccessCriteriaEntity successCriteriaEntity : stageEntity.getRoleSuccessCriterias()) {
    successFactors.put(successCriteriaEntity.getRole(),successCriteriaEntity.getSuccessFactor().floatValue());
  }
}
