{
  String checkpointDir=metricsConf.get(TIMELINE_METRICS_AGGREGATOR_CHECKPOINT_DIR,DEFAULT_CHECKPOINT_LOCATION);
  String checkpointLocation=FilenameUtils.concat(checkpointDir,CLUSTER_AGGREGATOR_CHECKPOINT_FILE);
  long sleepIntervalMillis=SECONDS.toMillis(metricsConf.getLong(CLUSTER_AGGREGATOR_SECOND_SLEEP_INTERVAL,120l));
  long timeSliceIntervalMillis=SECONDS.toMillis(metricsConf.getInt(CLUSTER_AGGREGATOR_TIMESLICE_INTERVAL,30));
  int checkpointCutOffMultiplier=metricsConf.getInt(CLUSTER_AGGREGATOR_SECOND_CHECKPOINT_CUTOFF_MULTIPLIER,2);
  String inputTableName=METRICS_RECORD_TABLE_NAME;
  String outputTableName=METRICS_CLUSTER_AGGREGATE_TABLE_NAME;
  String aggregatorDisabledParam=CLUSTER_AGGREGATOR_SECOND_DISABLED;
  return new TimelineMetricClusterAggregatorSecond(METRIC_AGGREGATE_SECOND,metadataManager,hBaseAccessor,metricsConf,checkpointLocation,sleepIntervalMillis,checkpointCutOffMultiplier,aggregatorDisabledParam,inputTableName,outputTableName,120000l,timeSliceIntervalMillis,haController);
}
