{
  try {
    ComponentResourceProvider crp=(ComponentResourceProvider)ClusterControllerHelper.getClusterController().ensureResourceProvider(Resource.Type.Component);
    Set<String> properties=new HashSet<String>();
    properties.add("ServiceComponentInfo/" + s_upgradeFinalizedMetricProperty);
    Request request=PropertyHelper.getReadRequest(properties);
    PredicateBuilder pb=new PredicateBuilder();
    Predicate predicate=pb.begin().property("ServiceComponentInfo/service_name").equals(s_serviceName).and().property("ServiceComponentInfo/component_name").equals(s_serviceComponent).and().property("ServiceComponentInfo/cluster_name").equals(cluster.getClusterName()).end().toPredicate();
    Set<Resource> res=ClusterControllerHelper.getClusterController().populateResources(Resource.Type.Component,crp.getResources(request,predicate),request,predicate);
    for (    Resource rr : res) {
      for (      Map<String,Object> t : rr.getPropertiesMap().values()) {
        if (t.containsKey(s_upgradeFinalizedMetricProperty) && t.get(s_upgradeFinalizedMetricProperty) instanceof Boolean) {
          if ((Boolean)t.get(s_upgradeFinalizedMetricProperty)) {
            return HDFSFinalizationState.FINALIZED;
          }
 else {
            return HDFSFinalizationState.NOT_FINALIZED;
          }
        }
      }
    }
  }
 catch (  SystemException|UnsupportedPropertyException|NoSuchParentResourceException|NoSuchResourceException e) {
    LOG.error("Unable to run the {} alert",ALERT_DEFINITION_NAME,e);
  }
  return HDFSFinalizationState.UNKNOWN;
}
