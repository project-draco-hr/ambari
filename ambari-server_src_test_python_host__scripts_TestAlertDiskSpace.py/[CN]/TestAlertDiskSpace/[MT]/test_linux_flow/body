@patch.object(OSCheck, 'os_distribution', new=MagicMock(return_value=os_distro_value))
@patch('alert_disk_space._get_disk_usage')
@patch('os.path.isdir')
@patch.object(OSCheck, 'get_os_family', new=MagicMock(return_value='redhat'))
def test_linux_flow(self, isdir_mock, disk_usage_mock):
    isdir_mock.return_value = False
    disk_usage_mock.return_value = alert_disk_space.DiskInfo(total=21673930752L, used=5695861760L, free=15978068992L)
    res = alert_disk_space.execute()
    self.assertEqual(res, ('OK', ['Capacity Used: [26.28%, 5.7 GB], Capacity Total: [21.7 GB]']))
    disk_usage_mock.return_value = alert_disk_space.DiskInfo(total=21673930752L, used=14521533603L, free=7152397149L)
    res = alert_disk_space.execute()
    self.assertEqual(res, ('WARNING', ['Capacity Used: [67.00%, 14.5 GB], Capacity Total: [21.7 GB]']))
    disk_usage_mock.return_value = alert_disk_space.DiskInfo(total=21673930752L, used=20590234214L, free=1083696538)
    res = alert_disk_space.execute()
    self.assertEqual(res, ('CRITICAL', ['Capacity Used: [95.00%, 20.6 GB], Capacity Total: [21.7 GB]']))
    disk_usage_mock.return_value = alert_disk_space.DiskInfo(total=5418482688L, used=1625544806L, free=3792937882L)
    res = alert_disk_space.execute()
    self.assertEqual(res, ('WARNING', ['Capacity Used: [30.00%, 1.6 GB], Capacity Total: [5.4 GB]. Total free space is less than 5.0 GB']))
    disk_usage_mock.side_effect = [alert_disk_space.DiskInfo(total=21673930752L, used=5695861760L, free=15978068992L), alert_disk_space.DiskInfo(total=21673930752L, used=14521533603L, free=7152397149L)]
    isdir_mock.return_value = True
    res = alert_disk_space.execute()
    self.assertEqual(res, ('WARNING', ['Capacity Used: [26.28%, 5.7 GB], Capacity Total: [21.7 GB]. Insufficient space at /usr/hdp: Capacity Used: [67.00%, 14.5 GB], Capacity Total: [21.7 GB]']))
    disk_usage_mock.side_effect = [alert_disk_space.DiskInfo(total=21673930752L, used=5695861760L, free=15978068992L), alert_disk_space.DiskInfo(total=21673930752L, used=20590234214L, free=1083696538L)]
    res = alert_disk_space.execute()
    self.assertEqual(res, ('WARNING', ['Capacity Used: [26.28%, 5.7 GB], Capacity Total: [21.7 GB]. Insufficient space at /usr/hdp: Capacity Used: [95.00%, 20.6 GB], Capacity Total: [21.7 GB]']))
    disk_usage_mock.side_effect = [alert_disk_space.DiskInfo(total=21673930752L, used=5695861760L, free=15978068992L), alert_disk_space.DiskInfo(total=5418482688L, used=1625544806L, free=3792937882L)]
    res = alert_disk_space.execute()
    self.assertEqual(res, ('WARNING', ['Capacity Used: [26.28%, 5.7 GB], Capacity Total: [21.7 GB]. Insufficient space at /usr/hdp: Capacity Used: [30.00%, 1.6 GB], Capacity Total: [5.4 GB]. Total free space is less than 5.0 GB']))
