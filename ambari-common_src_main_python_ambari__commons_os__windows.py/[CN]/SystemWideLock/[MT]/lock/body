def lock(self, timeout=0):
    result = WaitForSingleObject(self._mutex, timeout)
    if (result in [WAIT_TIMEOUT, WAIT_ABANDONED, WAIT_FAILED]):
        return False
    elif (result == WAIT_OBJECT_0):
        return True
