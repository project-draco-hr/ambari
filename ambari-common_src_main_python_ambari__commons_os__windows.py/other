'\nLicensed to the Apache Software Foundation (ASF) under one\nor more contributor license agreements.  See the NOTICE file\ndistributed with this work for additional information\nregarding copyright ownership.  The ASF licenses this file\nto you under the Apache License, Version 2.0 (the\n"License"); you may not use this file except in compliance\nwith the License.  You may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an "AS IS" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n'
import os
import getpass
import shlex
import subprocess
import sys
import time
import win32api
import win32event
import win32service
import win32con
import win32serviceutil
import wmi
import random
import string
import ctypes
from win32security import *
from win32api import *
from winerror import ERROR_INVALID_HANDLE
from win32process import GetExitCodeProcess, STARTF_USESTDHANDLES, STARTUPINFO, CreateProcessAsUser
from win32event import WaitForSingleObject, INFINITE
import msvcrt
import tempfile
from win32event import *
from win32api import CloseHandle
from ambari_commons.exceptions import *
from logging_utils import *
from win32security import LsaOpenPolicy, POLICY_CREATE_ACCOUNT, POLICY_LOOKUP_NAMES, LookupAccountName, LsaAddAccountRights, LsaRemoveAccountRights, SE_SERVICE_LOGON_NAME
from win32net import NetUserAdd
from win32netcon import USER_PRIV_USER, UF_NORMAL_ACCOUNT, UF_SCRIPT
import pywintypes
SERVICE_STATUS_UNKNOWN = 'unknown'
SERVICE_STATUS_STARTING = 'starting'
SERVICE_STATUS_RUNNING = 'running'
SERVICE_STATUS_STOPPING = 'stopping'
SERVICE_STATUS_STOPPED = 'stopped'
SERVICE_STATUS_NOT_INSTALLED = 'not installed'
WHOAMI_GROUPS = 'whoami /groups'
ADMIN_ACCOUNT = 'BUILTIN\\Administrators'
CHECK_FIREWALL_SCRIPT = '[string]$CName = $env:computername\n$reg = [Microsoft.Win32.RegistryKey]::OpenRemoteBaseKey("LocalMachine",$computer)\n$domain = $reg.OpenSubKey("System\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile").GetValue("EnableFirewall")\n$standart = $reg.OpenSubKey("System\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile").GetValue("EnableFirewall")\n$public = $reg.OpenSubKey("System\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile").GetValue("EnableFirewall")\nWrite-Host $domain\nWrite-Host $standart\nWrite-Host $public\n'
