{
  super(hBaseAccessor,metricsConf);
  String checkpointDir=metricsConf.get(TIMELINE_METRICS_AGGREGATOR_CHECKPOINT_DIR,DEFAULT_CHECKPOINT_LOCATION);
  checkpointLocation=FilenameUtils.concat(checkpointDir,CLUSTER_AGGREGATOR_CHECKPOINT_FILE);
  sleepIntervalMillis=SECONDS.toMillis(metricsConf.getLong(CLUSTER_AGGREGATOR_MINUTE_SLEEP_INTERVAL,120l));
  timeSliceIntervalMillis=(int)SECONDS.toMillis(metricsConf.getInt(CLUSTER_AGGREGATOR_TIMESLICE_INTERVAL,15));
  checkpointCutOffMultiplier=metricsConf.getInt(CLUSTER_AGGREGATOR_MINUTE_CHECKPOINT_CUTOFF_MULTIPLIER,2);
  appAggregator=new TimelineMetricAppAggregator(metricsConf);
}
