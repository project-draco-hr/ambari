{
  if (condition.getMetricNames() == null || condition.getMetricNames().isEmpty()) {
    return;
  }
  long range=condition.getEndTime() - condition.getStartTime();
  long rowsPerMetric;
  Precision precision=condition.getPrecision();
  if (precision == null) {
    precision=Precision.getPrecision(condition.getStartTime(),condition.getEndTime());
  }
switch (precision) {
case DAYS:
    rowsPerMetric=TimeUnit.MILLISECONDS.toDays(range);
  break;
case HOURS:
rowsPerMetric=TimeUnit.MILLISECONDS.toHours(range);
break;
case MINUTES:
rowsPerMetric=TimeUnit.MILLISECONDS.toMinutes(range) / 2;
break;
default :
rowsPerMetric=TimeUnit.MILLISECONDS.toSeconds(range) / 10;
}
long totalRowsRequested=rowsPerMetric * condition.getMetricNames().size();
if (totalRowsRequested > PhoenixHBaseAccessor.RESULTSET_LIMIT) {
throw new PrecisionLimitExceededException("Requested precision (" + precision + ") for given time range causes "+ "result set size of "+ totalRowsRequested+ ", which exceeds the limit - "+ PhoenixHBaseAccessor.RESULTSET_LIMIT+ ". Please request higher precision.");
}
}
