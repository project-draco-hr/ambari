def calculate_llap_app_heap_size(self, services, num_executors_per_node):
    hive_container_size = self.get_tez_container_size(services)
    total_mem_for_executors = (num_executors_per_node * hive_container_size)
    llap_app_heap_size = max((total_mem_for_executors * 0.8), (total_mem_for_executors - 1024))
    Logger.info('Calculated llap_app_heap_size : {0}, using following : hive_container_size : {1}, total_mem_for_executors : {2}'.format(llap_app_heap_size, hive_container_size, total_mem_for_executors))
    return max((total_mem_for_executors * 0.8), (total_mem_for_executors - 1024))
