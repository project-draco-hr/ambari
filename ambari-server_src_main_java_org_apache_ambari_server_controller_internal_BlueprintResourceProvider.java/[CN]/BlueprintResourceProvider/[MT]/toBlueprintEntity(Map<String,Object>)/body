{
  String name=(String)properties.get(BLUEPRINT_NAME_PROPERTY_ID);
  if (name == null || name.isEmpty()) {
    throw new IllegalArgumentException("Blueprint name must be provided");
  }
  BlueprintEntity blueprint=new BlueprintEntity();
  blueprint.setBlueprintName(name);
  blueprint.setStackName((String)properties.get(STACK_NAME_PROPERTY_ID));
  blueprint.setStackVersion((String)properties.get(STACK_VERSION_PROPERTY_ID));
  createHostGroupEntities(blueprint,(HashSet<HashMap<String,Object>>)properties.get(HOST_GROUP_PROPERTY_ID));
  createBlueprintConfigEntities((Collection<Map<String,String>>)properties.get(CONFIGURATION_PROPERTY_ID),blueprint);
  return blueprint;
}
