{
  final String clusterName=request.getClusterName();
  final Cluster cluster=clustersProvider.get().getCluster(clusterName);
  final String mrConfigType="mapred-site";
  final String coreSiteConfigType="core-site";
  final Map<String,DesiredConfig> desiredConfigs=cluster.getDesiredConfigs();
  final DesiredConfig mrDesiredConfig=desiredConfigs.get(mrConfigType);
  final DesiredConfig coreSiteDesiredConfig=desiredConfigs.get(coreSiteConfigType);
  final Config mrConfig=cluster.getConfig(mrConfigType,mrDesiredConfig.getTag());
  final Config coreSiteConfig=cluster.getConfig(coreSiteConfigType,coreSiteDesiredConfig.getTag());
  final String applicationClasspath=mrConfig.getProperties().get("mapreduce.application.classpath");
  final String frameworkPath=mrConfig.getProperties().get("mapreduce.application.framework.path");
  final String defaultFS=coreSiteConfig.getProperties().get("fs.defaultFS");
  List<String> errorMessages=new ArrayList<String>();
  if (applicationClasspath == null || applicationClasspath.isEmpty()) {
    errorMessages.add("Property mapreduce.application.classpath is missing from mapred-site, please add it.");
  }
  if (frameworkPath == null || frameworkPath.isEmpty()) {
    errorMessages.add("Property mapreduce.application.framework.path is missing from mapred-site, please add it.");
  }
  if (!errorMessages.isEmpty()) {
    prerequisiteCheck.getFailedOn().add("MAP_REDUCE");
    prerequisiteCheck.setStatus(PrereqCheckStatus.FAIL);
    prerequisiteCheck.setFailReason(StringUtils.join(errorMessages," "));
    return;
  }
  if (!frameworkPath.matches("^[^:]*dfs:.*") && (defaultFS == null || !defaultFS.matches("^[^:]*dfs:.*"))) {
    prerequisiteCheck.getFailedOn().add("MAP_REDUCE");
    prerequisiteCheck.setStatus(PrereqCheckStatus.FAIL);
    prerequisiteCheck.setFailReason("MapReduce should reference hadoop libraries from the distributed cache. Please make sure that either mapred-site's mapreduce.application.framework.path or core-site's fs.defaultFS begins with *dfs:");
  }
}
