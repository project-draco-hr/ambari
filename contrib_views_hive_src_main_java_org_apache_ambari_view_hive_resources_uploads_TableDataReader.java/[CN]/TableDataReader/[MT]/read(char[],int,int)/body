{
  int totalLen=len;
  int count=0;
  do {
    int n=stringReader.read(cbuf,off,len);
    if (n != -1) {
      len=len - n;
      off=off + n;
      count+=n;
    }
    if (count == totalLen)     return count;
    if (iterator.hasNext()) {
      StringWriter stringWriter=new StringWriter(CAPACITY);
      CSVPrinter csvPrinter=new CSVPrinter(stringWriter,CSV_FORMAT);
      Row row=iterator.next();
      csvPrinter.printRecord(row.getRow());
      stringReader.close();
      stringReader=new StringReader(stringWriter.getBuffer().toString());
      csvPrinter.close();
      stringWriter.close();
    }
 else {
      return count == 0 ? -1 : count;
    }
  }
 while (count < totalLen);
  return count;
}
