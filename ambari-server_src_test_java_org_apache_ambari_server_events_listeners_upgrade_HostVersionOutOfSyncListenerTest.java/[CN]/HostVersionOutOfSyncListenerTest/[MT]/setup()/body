{
  injector=Guice.createInjector(new InMemoryDefaultTestModule());
  injector.getInstance(GuiceJpaInitializer.class);
  clusters=injector.getInstance(Clusters.class);
  metaInfo=injector.getInstance(AmbariMetaInfo.class);
  helper=injector.getInstance(OrmTestHelper.class);
  hostVersionDAO=injector.getInstance(HostVersionDAO.class);
  serviceComponentHostFactory=injector.getInstance(ServiceComponentHostFactory.class);
  clusters.addCluster("c1");
  c1=clusters.getCluster("c1");
  addHost("h1");
  StackId stackId=new StackId(this.stackId);
  c1.setDesiredStackVersion(stackId);
  helper.getOrCreateRepositoryVersion(stackId.getStackName(),stackId.getStackVersion());
  c1.createClusterVersion(stackId.getStackName(),stackId.getStackVersion(),"admin",RepositoryVersionState.UPGRADING);
  c1.transitionClusterVersion(stackId.getStackName(),stackId.getStackVersion(),RepositoryVersionState.CURRENT);
  clusters.mapHostToCluster("h1","c1");
}
