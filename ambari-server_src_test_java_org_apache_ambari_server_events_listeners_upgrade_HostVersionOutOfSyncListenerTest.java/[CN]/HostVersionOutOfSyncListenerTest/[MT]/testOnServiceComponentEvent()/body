{
  String INSTALLED_VERSION="1.0-1000";
  StackId stackId=new StackId(this.stackId);
  createClusterAndHosts(INSTALLED_VERSION,stackId);
  List<String> hostList=new ArrayList<String>();
  hostList.add("h1");
  hostList.add("h2");
  hostList.add("h3");
  addServiceComponent(c1,hostList,"ZOOKEEPER","ZOOKEEPER_CLIENT");
  Set<String> changedHosts=new HashSet<String>();
  changedHosts.add("h1");
  changedHosts.add("h2");
  changedHosts.add("h3");
  checkStackVersionState(stackId.getStackId(),INSTALLED_VERSION,RepositoryVersionState.INSTALLED);
  List<HostVersionEntity> hostVersions=hostVersionDAO.findAll();
  boolean atLeastOneOutOfSync=false;
  for (  HostVersionEntity hostVersionEntity : hostVersions) {
    RepositoryVersionEntity repoVersion=hostVersionEntity.getRepositoryVersion();
    if (repoVersion.getVersion().equals(INSTALLED_VERSION)) {
      if (changedHosts.contains(hostVersionEntity.getHostName())) {
        assertEquals(hostVersionEntity.getState(),RepositoryVersionState.OUT_OF_SYNC);
        atLeastOneOutOfSync=true;
      }
 else {
        assertEquals(hostVersionEntity.getState(),RepositoryVersionState.INSTALLED);
      }
    }
  }
  assertTrue(atLeastOneOutOfSync);
}
