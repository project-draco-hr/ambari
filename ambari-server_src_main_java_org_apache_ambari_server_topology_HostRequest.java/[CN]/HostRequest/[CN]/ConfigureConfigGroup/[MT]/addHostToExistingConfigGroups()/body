{
  boolean addedHost=false;
  Clusters clusters;
  Cluster cluster;
  try {
    clusters=controller.getClusters();
    cluster=clusters.getCluster(clusterName);
  }
 catch (  AmbariException e) {
    throw new IllegalArgumentException(String.format("Attempt to add hosts to a non-existent cluster: '%s'",clusterName));
  }
  Map<Long,ConfigGroup> configGroups=cluster.getConfigGroups();
  for (  ConfigGroup group : configGroups.values()) {
    if (group.getName().equals(groupName)) {
      try {
        group.addHost(clusters.getHost(hostName));
        group.persist();
        addedHost=true;
      }
 catch (      AmbariException e) {
        throw new SystemException(String.format("Unable to obtain newly created host '%s' from cluster '%s'",hostName,clusterName));
      }
    }
  }
  return addedHost;
}
