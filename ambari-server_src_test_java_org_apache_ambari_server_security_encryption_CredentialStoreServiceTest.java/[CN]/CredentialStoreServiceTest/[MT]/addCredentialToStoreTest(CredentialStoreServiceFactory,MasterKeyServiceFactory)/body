{
  File directory=tmpFolder.getRoot();
  String masterKey="ThisIsSomeSecretPassPhrase1234";
  File masterKeyFile=new File(directory,"master");
  MasterKeyService masterKeyService=masterKeyServiceFactory.create(masterKey);
  CredentialStoreService credentialStoreService=credentialStoreServiceFactory.create(directory,masterKeyService);
  String password="mypassword";
  credentialStoreService.addCredential("password",password.toCharArray());
  char[] credential=credentialStoreService.getCredential("password");
  Assert.assertEquals(password,new String(credential));
  credentialStoreService.addCredential("null_password",null);
  Assert.assertNull(credentialStoreService.getCredential("null_password"));
  credentialStoreService.addCredential("empty_password",new char[0]);
  Assert.assertNull(credentialStoreService.getCredential("empty_password"));
  Assert.assertFalse(masterKeyFile.exists());
}
