{
  String auth=context.getProperties().get("hive.auth");
  Map<String,String> params=new HashMap<String,String>();
  if (auth == null || auth.isEmpty()) {
    auth="auth=NOSASL";
  }
  for (  String param : auth.split(";")) {
    String[] keyvalue=param.split("=");
    if (keyvalue.length != 2) {
      throw new ServiceFormattedException("H010 Can not parse authentication param " + param + " in "+ auth);
    }
    params.put(keyvalue[0],keyvalue[1]);
  }
  return params;
}
