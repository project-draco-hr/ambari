{
  String connectUrl=getCollectorUri();
  int timeout=getTimeoutSeconds() * 1000;
  try {
    String jsonData=mapper.writeValueAsString(metrics);
    LOG.info("Posting JSON=" + jsonData);
    HttpURLConnection connection=(HttpURLConnection)new URL(connectUrl).openConnection();
    connection.setRequestMethod("POST");
    connection.setRequestProperty("Content-Type","application/json");
    connection.setConnectTimeout(timeout);
    connection.setReadTimeout(timeout);
    connection.setDoOutput(true);
    if (jsonData != null) {
      try (OutputStream os=connection.getOutputStream()){
        os.write(jsonData.getBytes("UTF-8"));
      }
     }
    int statusCode=connection.getResponseCode();
    if (statusCode != 200) {
      LOG.info("Unable to POST metrics to collector, " + connectUrl + ", "+ "statusCode = "+ statusCode);
    }
 else {
      LOG.debug("Metrics posted to Collector " + connectUrl);
    }
  }
 catch (  IOException e) {
    throw new UnableToConnectException(e).setConnectUrl(connectUrl);
  }
}
