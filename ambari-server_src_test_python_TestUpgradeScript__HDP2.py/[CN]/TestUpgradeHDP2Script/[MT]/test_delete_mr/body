@patch.object(UpgradeHelper_HDP2, 'get_YN_input')
@patch.object(UpgradeHelper_HDP2, 'read_mapping')
@patch.object(logging, 'FileHandler')
@patch.object(UpgradeHelper_HDP2, 'backup_file')
@patch.object(UpgradeHelper_HDP2, 'curl')
@patch('optparse.OptionParser')
def test_delete_mr(self, option_parser_mock, curl_mock, backup_file_mock, file_handler_mock, read_mapping_mock, get_yn_mock):
    file_handler_mock.return_value = logging.FileHandler('')
    opm = option_parser_mock.return_value
    options = self.get_mock_options()
    args = ['delete-mr']
    opm.parse_args.return_value = (options, args)
    curl_mock.return_value = ''
    get_yn_mock.return_value = True
    read_mapping_mock.return_value = {'TASKTRACKER': ['c6401', 'c6402'], 'JOBTRACKER': ['c6401'], 'MAPREDUCE_CLIENT': ['c6401'], }
    UpgradeHelper_HDP2.main()
    expected_curl_calls = [call(False, '-u', 'admin:admin', '-H', 'X-Requested-By: ambari', '-X', 'PUT', '-d', '{"HostRoles": {"state": "DISABLED"}}', 'http://localhost:8080/api/v1/clusters/c1/hosts/c6401/host_components/TASKTRACKER'), call(False, '-u', 'admin:admin', '-H', 'X-Requested-By: ambari', '-X', 'PUT', '-d', '{"HostRoles": {"state": "DISABLED"}}', 'http://localhost:8080/api/v1/clusters/c1/hosts/c6402/host_components/TASKTRACKER'), call(False, '-u', 'admin:admin', '-H', 'X-Requested-By: ambari', '-X', 'PUT', '-d', '{"HostRoles": {"state": "DISABLED"}}', 'http://localhost:8080/api/v1/clusters/c1/hosts/c6401/host_components/JOBTRACKER'), call(False, '-u', 'admin:admin', '-H', 'X-Requested-By: ambari', '-X', 'DELETE', 'http://localhost:8080/api/v1/clusters/c1/services/MAPREDUCE')]
    curl_mock.assert_has_calls(expected_curl_calls, any_order=True)
    pass
