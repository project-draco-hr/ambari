@patch.object(logging, 'FileHandler')
@patch.object(UpgradeHelper_HDP2, 'backup_file')
@patch.object(UpgradeHelper_HDP2, 'curl')
@patch('optparse.OptionParser')
def test_install_yarn_mr2(self, option_parser_mock, curl_mock, backup_file_mock, file_handler_mock):
    file_handler_mock.return_value = logging.FileHandler('')
    opm = option_parser_mock.return_value
    options = self.get_mock_options()
    args = ['install-yarn-mr2']
    opm.parse_args.return_value = (options, args)
    curl_mock.return_value = '"href" : "'
    UpgradeHelper_HDP2.main()
    expected_curl_calls = [call(False, '-u', 'admin:admin', '-X', 'PUT', '-d', '{"ServiceInfo": {"state": "INSTALLED"}}', 'http://localhost:8080/api/v1/clusters/c1/services?ServiceInfo/state=INIT')]
    curl_mock.assert_has_calls(expected_curl_calls, any_order=True)
    pass
