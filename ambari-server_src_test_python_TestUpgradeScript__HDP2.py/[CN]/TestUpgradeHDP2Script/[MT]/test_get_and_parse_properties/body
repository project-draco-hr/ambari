@patch.object(logging, 'FileHandler')
@patch.object(UpgradeHelper_HDP2, 'backup_file')
@patch.object(UpgradeHelper_HDP2, 'curl')
def test_get_and_parse_properties(self, curl_mock, backup_file_mock, file_handler_mock):
    file_handler_mock.return_value = logging.FileHandler('')
    options = self.get_mock_options()
    curl_mock.side_effect = ['{ "href" : "http://localhost:8080/api/v1/clusters/c1",\n           "Clusters" : {\n              "cluster_id" : 2,\n              "cluster_name" : "c1",\n              "version" : "HDP-2.0.5",\n              "desired_configs" : {\n                "capacity-scheduler" : {\n                  "user" : "admin",\n                  "tag" : "version137"\n                },\n                "core-site" : {\n                   "user" : "admin",\n                   "tag" : "version138"\n                }}}}', '{\n           "href" : "http://localhost:8080/api/v1/clusters/c1/configurations?type=core-site&tag=version138",\n           "items" : [\n             {\n               "href" : "http://localhost:8080/api/v1/clusters/c1/configurations?type=core-site&tag=version138",\n               "tag" : "version1378850572477",\n               "type" : "core-site",\n               "Config" : {\n                 "cluster_name" : "c1"\n               },\n               "properties" : {\n                 "name1" : "value1",\n                 "name2" : "value2",\n                 "name3" : "value3"\n               }}]}', '{ "href" : "http://localhost:8080/api/v1/clusters/c1",\n           "Clusters" : {\n              "desired_configs" : {\n                "capacity-scheduler" : {\n                  "user" : "admin",\n                  "tag" : "version137"\n                }}}}']
    properties = UpgradeHelper_HDP2.get_config(options, 'core-site')
    self.assertTrue((len(properties.keys()) == 3))
    self.assertTrue((properties['name1'] == 'value1'))
    self.assertTrue((properties['name2'] == 'value2'))
    self.assertTrue((properties['name3'] == 'value3'))
    try:
        UpgradeHelper_HDP2.get_config(options, 'hdfs-site')
    except Exception as e:
        self.assertTrue(('Unable to get the current version for config type hdfs-site' in e.reason))
        pass
    pass
