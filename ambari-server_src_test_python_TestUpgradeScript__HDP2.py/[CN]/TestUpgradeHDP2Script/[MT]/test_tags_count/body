def test_tags_count(self):

    def count_tags(template):
        deleted = 0
        replaced = 0
        for key in template.keys():
            value = template[key]
            if (value == UpgradeHelper_HDP2.DELETE_OLD_TAG):
                deleted += 1
                continue
            if (value.find(UpgradeHelper_HDP2.REPLACE_WITH_TAG) == 0):
                replaced += 1
                continue
            pass
        return (deleted, replaced)
    (deleted, replaced) = count_tags(UpgradeHelper_HDP2.GLOBAL)
    self.assertEqual(6, replaced)
    self.assertEqual(24, deleted)
    (deleted, replaced) = count_tags(UpgradeHelper_HDP2.MAPRED_SITE)
    self.assertEqual(0, replaced)
    self.assertEqual(85, deleted)
    (deleted, replaced) = count_tags(UpgradeHelper_HDP2.CORE_SITE)
    self.assertEqual(0, replaced)
    self.assertEqual(1, deleted)
    (deleted, replaced) = count_tags(UpgradeHelper_HDP2.HDFS_SITE)
    self.assertEqual(0, replaced)
    self.assertEqual(8, deleted)
    pass
