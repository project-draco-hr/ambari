{
  dao=createNiceMock(MetainfoDAO.class);
  actionMetadata=createNiceMock(ActionMetadata.class);
  osFamily=createNiceMock(OsFamily.class);
  actionMetadata.addServiceCheckAction("HDFS");
  replay(dao,actionMetadata,osFamily);
  StackManager stackManager=new StackManager(new File("./src/test/resources/single_stack".replace("/",File.separator)),new StackContext(dao,actionMetadata,osFamily));
  Collection<StackInfo> stacks=stackManager.getStacks();
  assertEquals(1,stacks.size());
  assertNotNull(stacks.iterator().next().getService("HDFS"));
  verify(dao,actionMetadata,osFamily);
}
