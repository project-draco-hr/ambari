def action_create(self):
    path = self.resource.path
    write = False
    content = self._get_content()
    if (not os.path.exists(path)):
        write = True
        reason = "it doesn't exist"
    elif (content is not None):
        with open(path, 'rb') as fp:
            old_content = fp.read()
        if (content != old_content):
            write = True
            reason = "contents don't match"
            self.resource.env.backup_file(path)
    if write:
        self.log.info(('Writing %s because %s' % (self.resource, reason)))
        with open(path, 'wb') as fp:
            if content:
                fp.write(content)
        self.resource.updated()
    if _ensure_metadata(self.resource.path, self.resource.owner, self.resource.group, mode=self.resource.mode, log=self.log):
        self.resource.updated()
