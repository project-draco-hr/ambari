def action_run(self):
    if self.resource.creates:
        if os.path.exists(self.resource.creates):
            return
    self.log.info(('Executing %s' % self.resource))
    ret = subprocess.call(self.resource.command, shell=True, cwd=self.resource.cwd, env=self.resource.environment, preexec_fn=_preexec_fn(self.resource))
    if (self.resource.returns and (ret not in self.resource.returns)):
        raise Fail(('%s failed, returned %d instead of %s' % (self, ret, self.resource.returns)))
    self.resource.updated()
