def action_create(self):
    path = self.resource.path
    if os.path.lexists(path):
        oldpath = os.path.realpath(path)
        if (oldpath == self.resource.to):
            return
        if (not os.path.islink(path)):
            raise Fail(('%s trying to create a symlink with the same name as an existing file or directory' % self))
        self.log.info(('%s replacing old symlink to %s' % (self, oldpath)))
        os.unlink(path)
    if self.resource.hard:
        self.log.info(('Creating hard %s' % self.resource))
        os.link(self.resource.to, path)
        self.resource.updated()
    else:
        self.log.info(('Creating symbolic %s' % self.resource))
        os.symlink(self.resource.to, path)
        self.resource.updated()
