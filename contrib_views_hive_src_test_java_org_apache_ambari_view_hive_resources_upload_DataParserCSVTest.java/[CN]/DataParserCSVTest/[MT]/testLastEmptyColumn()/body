{
  String str="1,a,x\n" + "2,,\n" + "3,c,z\n";
  StringReader sr=new StringReader(str);
  ParseOptions parseOptions=new ParseOptions();
  parseOptions.setOption(ParseOptions.OPTIONS_FILE_TYPE,ParseOptions.InputFileType.CSV.toString());
  parseOptions.setOption(ParseOptions.OPTIONS_HEADER,ParseOptions.HEADER.FIRST_RECORD.toString());
  DataParser dp=null;
  try {
    dp=new DataParser(sr,parseOptions);
    PreviewData pd=dp.parsePreview();
    Assert.assertEquals("Empty column not detected properly.",pd.getPreviewRows().get(1).getRow()[1],"");
    Assert.assertEquals("Empty column not detected properly.",pd.getPreviewRows().get(1).getRow()[2],"");
  }
  finally {
    if (null != dp)     dp.close();
    sr.close();
  }
}
