def archive_dir(output_filename, input_dir):
    with closing(tarfile.open(output_filename, 'w:gz')) as tar:
        try:
            tar.add(input_dir, arcname=os.path.basename('.'))
        finally:
            tar.close()
