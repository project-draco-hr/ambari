{
  Statement statement=null;
  ResultSet rs=null;
  int value=-1;
  try {
    statement=dbAccessor.getConnection().createStatement();
    if (statement != null) {
      rs=statement.executeQuery(String.format("SELECT COUNT(*) from %s where sequence_name='%s'",ambariSequencesTable,seqName));
      if (rs != null) {
        value=rs.getInt(1);
        dbAccessor.executeUpdate(String.format("UPDATE %s SET sequence_value = sequence_value + 1 where sequence_name='%s'",ambariSequencesTable,seqName));
      }
 else {
        LOG.error("Sequence {} not found.",seqName);
        throw new IllegalArgumentException("Sequence " + seqName + " not found.");
      }
    }
  }
  finally {
    if (rs != null) {
      rs.close();
    }
    if (statement != null) {
      statement.close();
    }
  }
  return value;
}
