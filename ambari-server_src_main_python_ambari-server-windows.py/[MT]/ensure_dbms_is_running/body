def ensure_dbms_is_running(options, properties, scmStatus):
    dbms = DBMSConfig.create(options, properties, 'Ambari')
    if (not dbms._is_jdbc_driver_installed(properties)):
        raise FatalException((-1), 'JDBC driver is not installed. Run ambari-server setup and try again.')
    dbms.ensure_dbms_is_running(options, properties, scmStatus)
    dbms2 = DBMSConfig.create(options, properties, 'Metrics')
    if (dbms2.database_host.lower() != dbms.database_host.lower()):
        dbms2.ensure_dbms_is_running(options, properties, scmStatus)
    pass
