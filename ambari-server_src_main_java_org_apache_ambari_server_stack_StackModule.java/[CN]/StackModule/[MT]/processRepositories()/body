{
  RepositoryXml rxml=stackDirectory.getRepoFile();
  if (rxml == null) {
    return;
  }
  LOG.debug("Adding repositories to stack" + ", stackName=" + stackInfo.getName() + ", stackVersion="+ stackInfo.getVersion()+ ", repoFolder="+ stackDirectory.getRepoDir());
  List<RepositoryInfo> repos=new ArrayList<RepositoryInfo>();
  for (  RepositoryXml.Os o : rxml.getOses()) {
    String osFamily=o.getFamily();
    for (    String os : osFamily.split(",")) {
      for (      RepositoryXml.Repo r : o.getRepos()) {
        repos.add(processRepository(osFamily,os,r));
      }
    }
  }
  stackInfo.getRepositories().addAll(repos);
  if (null != rxml.getLatestURI() && repos.size() > 0) {
    stackContext.registerRepoUpdateTask(rxml.getLatestURI(),this);
  }
}
