{
  ServiceInfo serviceInfo=service.getModuleInfo();
  String[] parentToks=parent.split("/");
  String baseStackKey=parentToks[0] + parentToks[1];
  StackModule baseStack=stacks.get(baseStackKey);
  if (baseStack == null) {
    throw new AmbariException("The service '" + serviceInfo.getName() + "' in stack '"+ stackInfo.getName()+ ":"+ stackInfo.getVersion()+ "' extends a service in a non-existent stack: '"+ baseStackKey+ "'");
  }
  resolveStack(baseStack,stacks);
  ServiceModule baseService=baseStack.serviceModules.get(parentToks[2]);
  if (baseService == null) {
    throw new AmbariException("The service '" + serviceInfo.getName() + "' in stack '"+ stackInfo.getName()+ ":"+ stackInfo.getVersion()+ "' extends a non-existent service: '"+ parent+ "'");
  }
  service.resolve(baseService,stacks);
}
