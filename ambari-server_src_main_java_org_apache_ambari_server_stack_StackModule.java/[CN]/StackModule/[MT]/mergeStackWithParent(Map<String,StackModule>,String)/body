{
  String parentStackKey=stackInfo.getName() + parentVersion;
  StackModule parentStack=allStacks.get(parentStackKey);
  if (parentStack == null) {
    throw new AmbariException("Stack '" + stackInfo.getName() + ":"+ stackInfo.getVersion()+ "' specifies a parent that doesn't exist");
  }
  resolveStack(parentStack,allStacks);
  mergeConfigurations(parentStack,allStacks);
  mergeRoleCommandOrder(parentStack);
  if (stackInfo.getStackHooksFolder() == null) {
    stackInfo.setStackHooksFolder(parentStack.getModuleInfo().getStackHooksFolder());
  }
  mergeServicesWithParent(allStacks,parentStack);
}
