{
  HdfsApi api=null;
  Thread.currentThread().setContextClassLoader(null);
  ConfigurationBuilder configurationBuilder=new ConfigurationBuilder(context);
  AuthConfigurationBuilder authConfigurationBuilder=new AuthConfigurationBuilder(context);
  try {
    api=new HdfsApi(configurationBuilder,getHdfsUsername(context),authConfigurationBuilder);
    LOG.info("HdfsApi connected OK");
  }
 catch (  IOException e) {
    String message="HDFS040 Couldn't open connection to HDFS";
    LOG.error(message);
    throw new HdfsApiException(message,e);
  }
catch (  InterruptedException e) {
    String message="HDFS041 Couldn't open connection to HDFS";
    LOG.error(message);
    throw new HdfsApiException(message,e);
  }
  return api;
}
