{
  ConfigurationRequest config=null;
  for (  Entry<String,Object> entry : properties.entrySet()) {
    String absCategory=PropertyHelper.getPropertyCategory(entry.getKey());
    String propName=PropertyHelper.getPropertyName(entry.getKey());
    if (absCategory.startsWith(parentCategory + "/desired_config")) {
      config=(null == config) ? new ConfigurationRequest() : config;
      if (propName.equals("type"))       config.setType(entry.getValue().toString());
 else       if (propName.equals("tag"))       config.setVersionTag(entry.getValue().toString());
 else       if (propName.equals("selected")) {
        config.setSelected(Boolean.parseBoolean(entry.getValue().toString()));
      }
 else       if (absCategory.endsWith("/properties")) {
        config.getProperties().put(propName,entry.getValue().toString());
      }
 else       if (propertiesAttributesPattern.matcher(absCategory).matches()) {
        String attributeName=absCategory.substring(absCategory.lastIndexOf('/') + 1);
        Map<String,Map<String,String>> configAttributesMap=config.getPropertiesAttributes();
        if (null == configAttributesMap) {
          configAttributesMap=new HashMap<String,Map<String,String>>();
          config.setPropertiesAttributes(configAttributesMap);
        }
        Map<String,String> attributesMap=configAttributesMap.get(attributeName);
        if (null == attributesMap) {
          attributesMap=new HashMap<String,String>();
          configAttributesMap.put(attributeName,attributesMap);
        }
        attributesMap.put(PropertyHelper.getPropertyName(entry.getKey()),entry.getValue().toString());
      }
    }
  }
  return config;
}
