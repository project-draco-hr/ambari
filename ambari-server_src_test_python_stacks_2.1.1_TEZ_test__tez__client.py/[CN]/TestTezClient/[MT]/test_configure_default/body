def test_configure_default(self):
    self.executeScript('2.1.1/services/TEZ/package/scripts/tez_client.py', classname='TezClient', command='configure', config_file='default.json')
    self.assertResourceCalled('Directory', '/etc/tez/conf', owner='tez', group='hadoop', recursive=True)
    self.assertResourceCalled('XmlConfig', 'tez-site.xml', owner='tez', group='hadoop', conf_dir='/etc/tez/conf', configurations=self.getConfig()['configurations']['tez-site'], mode=436)
    self.assertResourceCalled('TemplateConfig', '/etc/tez/conf/tez-env.sh', owner='tez')
    self.assertResourceCalled('HdfsDirectory', '/apps/tez/', action=['create_delayed'], mode=493, owner='tez', security_enabled=False, keytab=UnknownConfigurationMock(), conf_dir='/etc/hadoop/conf', hdfs_user='hdfs', kinit_path_local='/usr/bin/kinit')
    self.assertResourceCalled('HdfsDirectory', '/apps/tez/lib/', action=['create_delayed'], mode=493, owner='tez', security_enabled=False, keytab=UnknownConfigurationMock(), conf_dir='/etc/hadoop/conf', hdfs_user='hdfs', kinit_path_local='/usr/bin/kinit')
    self.assertResourceCalled('HdfsDirectory', None, security_enabled=False, keytab=UnknownConfigurationMock(), conf_dir='/etc/hadoop/conf', hdfs_user='hdfs', kinit_path_local='/usr/bin/kinit', action=['create'])
    self.assertResourceCalled('ExecuteHadoop', 'fs -copyFromLocal /usr/lib/tez/tez*.jar /apps/tez/', not_if=' hadoop fs -ls /tmp/tez_jars_copied >/dev/null 2>&1', user='tez', conf_dir='/etc/hadoop/conf', ignore_failures=True)
    self.assertResourceCalled('ExecuteHadoop', 'fs -copyFromLocal /usr/lib/tez/lib/*.jar /apps/tez/lib/', not_if=' hadoop fs -ls /tmp/tez_jars_copied >/dev/null 2>&1', user='tez', conf_dir='/etc/hadoop/conf', ignore_failures=True)
    self.assertResourceCalled('ExecuteHadoop', 'dfs -touchz /tmp/tez_jars_copied', user='tez', conf_dir='/etc/hadoop/conf')
    self.assertNoMoreResources()
