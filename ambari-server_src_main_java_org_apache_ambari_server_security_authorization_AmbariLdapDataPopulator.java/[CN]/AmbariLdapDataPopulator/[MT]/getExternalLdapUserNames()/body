{
  final Set<String> users=new HashSet<String>();
  final LdapTemplate ldapTemplate=loadLdapTemplate();
  final EqualsFilter equalsFilter=new EqualsFilter("objectClass",ldapServerProperties.getUserObjectClass());
  String baseDn=ldapServerProperties.getBaseDN();
  ldapTemplate.search(baseDn,equalsFilter.encode(),new AttributesMapper(){
    public Object mapFromAttributes(    Attributes attributes) throws NamingException {
      users.add(attributes.get(ldapServerProperties.getUsernameAttribute()).get().toString().toLowerCase());
      return null;
    }
  }
);
  return users;
}
