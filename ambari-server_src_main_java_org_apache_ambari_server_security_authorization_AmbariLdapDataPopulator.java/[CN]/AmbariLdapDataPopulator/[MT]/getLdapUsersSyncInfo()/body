{
  final Map<String,Boolean> ldapUsers=new HashMap<String,Boolean>();
  final List<User> internalUsers=users.getAllUsers();
  final Map<String,User> internalUsersMap=new HashMap<String,User>();
  for (  User user : internalUsers) {
    internalUsersMap.put(user.getUserName(),user);
  }
  final Set<String> externalUsers=getExternalLdapUserNames();
  for (  String externalUser : externalUsers) {
    if (internalUsersMap.containsKey(externalUser) && internalUsersMap.get(externalUser).isLdapUser()) {
      ldapUsers.put(externalUser,true);
    }
 else {
      ldapUsers.put(externalUser,false);
    }
  }
  return ldapUsers;
}
