{
  final Set<String> members=new HashSet<String>();
  final LdapTemplate ldapTemplate=loadLdapTemplate();
  final AndFilter andFilter=new AndFilter();
  andFilter.and(new EqualsFilter("objectClass",ldapServerProperties.getGroupObjectClass()));
  andFilter.and(new EqualsFilter(ldapServerProperties.getGroupNamingAttr(),groupName));
  String baseDn=ldapServerProperties.getGroupBase();
  if (baseDn == null) {
    baseDn=ldapServerProperties.getBaseDN();
  }
  ldapTemplate.search(baseDn,andFilter.encode(),new ContextMapper(){
    public Object mapFromContext(    Object ctx){
      final DirContextAdapter adapter=(DirContextAdapter)ctx;
      for (      String uniqueMember : adapter.getStringAttributes(ldapServerProperties.getGroupMembershipAttr())) {
        final DirContextAdapter userAdapter=(DirContextAdapter)ldapTemplate.lookup(uniqueMember);
        members.add(userAdapter.getStringAttribute(ldapServerProperties.getUsernameAttribute().toLowerCase()));
      }
      return null;
    }
  }
);
  return members;
}
