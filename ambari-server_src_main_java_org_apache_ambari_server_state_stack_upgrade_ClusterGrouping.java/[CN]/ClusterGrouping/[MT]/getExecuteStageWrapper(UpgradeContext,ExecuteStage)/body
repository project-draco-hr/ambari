{
  String service=execution.service;
  String component=execution.component;
  Task task=execution.task;
  if (null != service && !service.isEmpty() && null != component && !component.isEmpty()) {
    HostsType hosts=ctx.getResolver().getMasterAndHosts(service,component);
    if (hosts != null) {
      Set<String> realHosts=new LinkedHashSet<String>(hosts.hosts);
      ExecuteTask et=(ExecuteTask)task;
      if (null != et.hosts && "master".equals(et.hosts) && null != hosts.master) {
        realHosts=Collections.singleton(hosts.master);
      }
      return new StageWrapper(StageWrapper.Type.RU_TASKS,execution.title,new TaskWrapper(service,component,realHosts,task));
    }
  }
  return null;
}
