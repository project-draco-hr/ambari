{
  if (null == ClusterGrouping.this.executionStages) {
    return Collections.emptyList();
  }
  List<StageWrapper> results=new ArrayList<StageWrapper>();
  for (  ExecuteStage execution : executionStages) {
    Task task=execution.task;
    StageWrapper wrapper=null;
    if (null != execution.service && null != execution.component) {
      Set<String> hosts=m_cluster.getHosts(execution.service,execution.component);
      if (hosts.size() > 0 && task.getType() == Task.Type.EXECUTE) {
        wrapper=new StageWrapper(StageWrapper.Type.RU_TASKS,execution.title,new TaskWrapper(execution.service,execution.component,hosts,task));
      }
    }
 else {
switch (task.getType()) {
case MANUAL:
        wrapper=new StageWrapper(StageWrapper.Type.MANUAL,execution.title,new TaskWrapper(null,null,Collections.<String>emptySet(),task));
      break;
default :
    break;
}
}
if (null != wrapper) {
results.add(wrapper);
}
}
return results;
}
