{
  final String clusterName=request.getClusterName();
  final Cluster cluster=clustersProvider.get().getCluster(clusterName);
  final String configType="yarn-site";
  final Map<String,DesiredConfig> desiredConfigs=cluster.getDesiredConfigs();
  final DesiredConfig desiredConfig=desiredConfigs.get(configType);
  final Config config=cluster.getConfig(configType,desiredConfig.getTag());
  if (!config.getProperties().containsKey("yarn.resourcemanager.work-preserving-recovery.enabled") || !BooleanUtils.toBoolean(config.getProperties().get("yarn.resourcemanager.work-preserving-recovery.enabled"))) {
    prerequisiteCheck.getFailedOn().add("YARN");
    prerequisiteCheck.setStatus(PrereqCheckStatus.FAIL);
    prerequisiteCheck.setFailReason("YARN doesn't have work preserving restart. Verify that yarn.resourcemanager.work-preserving-recovery.enabled property" + " is present in yarn-site.xml and is set to true");
  }
}
