def service_check(self, env):
    import params
    env.set_params(params)
    run_yarn_check_cmd = format('yarn --config {hadoop_conf_dir} node -list')
    component_type = 'rm'
    if params.hadoop_ssl_enabled:
        component_address = params.rm_webui_https_address
    else:
        component_address = params.rm_webui_address
    validateStatusFileName = 'validateYarnComponentStatus.py'
    validateStatusFilePath = format('{tmp_dir}/{validateStatusFileName}')
    python_executable = sys.executable
    validateStatusCmd = format('{python_executable} {validateStatusFilePath} {component_type} -p {component_address} -s {hadoop_ssl_enabled}')
    if params.security_enabled:
        kinit_cmd = format('{kinit_path_local} -kt {smoke_user_keytab} {smokeuser};')
        smoke_cmd = format('{kinit_cmd} {validateStatusCmd}')
    else:
        smoke_cmd = validateStatusCmd
    File(validateStatusFilePath, content=StaticFile(validateStatusFileName), mode=493)
    Execute(smoke_cmd, tries=3, try_sleep=5, path='/usr/sbin:/sbin:/usr/local/bin:/bin:/usr/bin', user=params.smokeuser, logoutput=True)
    Execute(run_yarn_check_cmd, environment={'PATH': params.execute_path, }, user=params.smokeuser)
