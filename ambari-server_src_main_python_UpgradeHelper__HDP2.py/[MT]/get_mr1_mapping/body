def get_mr1_mapping(options):
    components = ['MAPREDUCE_CLIENT', 'JOBTRACKER', 'TASKTRACKER']
    GET_URL_FORMAT = (URL_FORMAT + '/services/MAPREDUCE/components/{2}')
    hostmapping = {}
    for component in components:
        hostlist = []
        response = curl('-u', AUTH_FORMAT.format(options.user, options.password), GET_URL_FORMAT.format(options.hostname, options.clustername, component))
        (retcode, errdata) = validate_response(response, True)
        if (not (retcode == 0)):
            raise FatalException(retcode, errdata)
        structured_resp = json.loads(response)
        if ('host_components' in structured_resp):
            for hostcomponent in structured_resp['host_components']:
                if ('HostRoles' in hostcomponent):
                    if ('host_name' in hostcomponent['HostRoles']):
                        hostlist.append(hostcomponent['HostRoles']['host_name'])
                        pass
                    pass
                pass
            pass
        pass
        hostmapping[component] = hostlist
    write_mapping(hostmapping)
