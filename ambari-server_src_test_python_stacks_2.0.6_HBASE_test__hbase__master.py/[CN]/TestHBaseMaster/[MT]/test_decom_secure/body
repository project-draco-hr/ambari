def test_decom_secure(self):
    self.executeScript('2.0.6/services/HBASE/package/scripts/hbase_master.py', classname='HbaseMaster', command='decommission', config_file='secured.json')
    self.assertResourceCalled('File', '/usr/lib/hbase/bin/draining_servers.rb', content=StaticFile('draining_servers.rb'), mode=493)
    self.assertResourceCalled('Execute', '/usr/bin/kinit -kt /etc/security/keytabs/hbase.headless.keytab hbase; /usr/lib/hbase/bin/hbase --config /etc/hbase/conf org.jruby.Main /usr/lib/hbase/bin/draining_servers.rb add host1', logoutput=True, user='hbase')
    self.assertResourceCalled('Execute', '/usr/bin/kinit -kt /etc/security/keytabs/hbase.headless.keytab hbase; /usr/lib/hbase/bin/hbase --config /etc/hbase/conf org.jruby.Main /usr/lib/hbase/bin/region_mover.rb unload host1', logoutput=True, user='hbase')
    self.assertNoMoreResources()
