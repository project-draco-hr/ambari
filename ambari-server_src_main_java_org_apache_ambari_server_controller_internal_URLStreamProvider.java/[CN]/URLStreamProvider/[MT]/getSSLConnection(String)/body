{
  if (sslSocketFactory == null) {
synchronized (this) {
      if (sslSocketFactory == null) {
        try {
          FileInputStream in=new FileInputStream(new File(path));
          KeyStore store=KeyStore.getInstance(type == null ? KeyStore.getDefaultType() : type);
          store.load(in,password.toCharArray());
          in.close();
          TrustManagerFactory tmf=TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
          tmf.init(store);
          SSLContext context=SSLContext.getInstance("TLS");
          context.init(null,tmf.getTrustManagers(),null);
          sslSocketFactory=context.getSocketFactory();
        }
 catch (        Exception e) {
          throw new IOException("Can't get connection.",e);
        }
      }
    }
  }
  HttpsURLConnection connection=(HttpsURLConnection)(new URL(spec).openConnection());
  connection.setSSLSocketFactory(sslSocketFactory);
  return connection;
}
