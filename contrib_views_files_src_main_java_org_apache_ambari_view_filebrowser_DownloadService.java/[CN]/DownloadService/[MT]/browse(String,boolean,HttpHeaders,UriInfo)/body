{
  try {
    HdfsApi api=getApi(context);
    FileStatus status=api.getFileStatus(path);
    FSDataInputStream fs=api.open(path);
    ResponseBuilder result=Response.ok(fs);
    if (download) {
      result.header("Content-Disposition","inline; filename=\"" + status.getPath().getName() + "\"").type(MediaType.APPLICATION_OCTET_STREAM);
    }
 else {
      FileNameMap fileNameMap=URLConnection.getFileNameMap();
      String mimeType=fileNameMap.getContentTypeFor(status.getPath().getName());
      result.header("Content-Disposition","filename=\"" + status.getPath().getName() + "\"").type(mimeType);
    }
    return result.build();
  }
 catch (  FileNotFoundException ex) {
    return Response.ok(Response.Status.NOT_FOUND.getStatusCode()).entity(ex.getMessage()).build();
  }
catch (  Exception ex) {
    return Response.ok(Response.Status.INTERNAL_SERVER_ERROR.getStatusCode()).entity(ex.getMessage()).build();
  }
}
