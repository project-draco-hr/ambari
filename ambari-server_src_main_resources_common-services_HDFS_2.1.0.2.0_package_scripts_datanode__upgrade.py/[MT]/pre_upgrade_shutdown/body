def pre_upgrade_shutdown():
    '\n  Runs the "shutdownDatanode {ipc_address} upgrade" command to shutdown the\n  DataNode in preparation for an upgrade. This will then periodically check\n  "getDatanodeInfo" to ensure the DataNode has shutdown correctly.\n  This function will obtain the Kerberos ticket if security is enabled.\n  :return:\n  '
    import params
    Logger.info('DataNode executing "shutdownDatanode" command in preparation for upgrade...')
    if params.security_enabled:
        Execute(params.dn_kinit_cmd, user=params.hdfs_user)
    command = format('hdfs dfsadmin -shutdownDatanode {dfs_dn_ipc_address} upgrade')
    Execute(command, user=params.hdfs_user, tries=1)
    _check_datanode_shutdown()
