@retry(times=12, sleep_time=10, err_class=Fail)
def _check_datanode_startup():
    '\n  Checks that a DataNode is reported as being alive via the\n  "hdfs dfsadmin -report -live" command. Once the DataNode is found to be\n  alive this method will return, otherwise it will raise a Fail(...) and retry\n  automatically.\n  :return:\n  '
    import params
    try:
        command = 'hdfs dfsadmin -report -live'
        (return_code, hdfs_output) = shell.call(command, user=params.hdfs_user)
    except:
        raise Fail('Unable to determine if the DataNode has started after upgrade.')
    if (return_code == 0):
        if (params.hostname.lower() in hdfs_output.lower()):
            Logger.info('DataNode {0} reports that it has rejoined the cluster.'.format(params.hostname))
            return
        else:
            raise Fail('DataNode {0} was not found in the list of live DataNodes'.format(params.hostname))
    raise Fail('Unable to determine if the DataNode has started after upgrade (result code {0})'.format(str(return_code)))
