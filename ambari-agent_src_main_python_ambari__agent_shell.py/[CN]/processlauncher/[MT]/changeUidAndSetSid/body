def changeUidAndSetSid(self):
    prefix = AmbariConfig.config.get('stack', 'installprefix')
    pidfile = os.path.join(prefix, (str(os.getpid()) + '.pid'))
    try:
        f = open(pidfile, 'w')
        f.close()
    except:
        logger.warn(("Couldn't write pid file %s for %s" % (pidfile, self.cmd)))
    changeUid()
    os.setsid()
