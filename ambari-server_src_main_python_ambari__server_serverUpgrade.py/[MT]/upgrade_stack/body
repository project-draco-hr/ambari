def upgrade_stack(args):
    if (not is_root()):
        err = 'Ambari-server upgradestack should be run with root-level privileges'
        raise FatalException(4, err)
    check_database_name_property()
    try:
        stack_id = args[1]
    except IndexError:
        raise FatalException('Invalid number of stack upgrade arguments')
    try:
        repo_url = args[2]
    except IndexError:
        repo_url = None
    try:
        repo_url_os = args[3]
    except IndexError:
        repo_url_os = None
    (stack_name, stack_version) = stack_id.split(STACK_NAME_VER_SEP)
    retcode = run_stack_upgrade(stack_name, stack_version, repo_url, repo_url_os)
    if (not (retcode == 0)):
        raise FatalException(retcode, 'Stack upgrade failed.')
    return retcode
