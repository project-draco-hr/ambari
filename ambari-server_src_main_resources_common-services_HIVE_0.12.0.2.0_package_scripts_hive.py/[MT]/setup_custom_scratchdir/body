def setup_custom_scratchdir():
    import params
    if is_empty(params.hive_exec_scratchdir):
        return
    parsed = urlparse(params.hive_exec_scratchdir)
    if parsed.path.startswith('/tmp'):
        return
    params.HdfsDirectory(params.hive_exec_scratchdir, action='create_delayed', owner=params.hive_user, group=params.hdfs_user, mode=511)
