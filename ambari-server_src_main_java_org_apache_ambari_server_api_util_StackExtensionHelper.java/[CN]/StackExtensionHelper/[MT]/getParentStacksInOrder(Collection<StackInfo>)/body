{
  Map<String,List<StackInfo>> parentStacksMap=new HashMap<String,List<StackInfo>>();
  for (  StackInfo child : stacks) {
    List<StackInfo> parentStacks=new LinkedList<StackInfo>();
    parentStacksMap.put(child.getVersion(),parentStacks);
    while (child.getParentStackVersion() != null && !child.getParentStackVersion().isEmpty() && !child.getVersion().equals(child.getParentStackVersion())) {
      String key=child.getName() + child.getParentStackVersion();
      if (stackVersionMap.containsKey(key)) {
        StackInfo parent=stackVersionMap.get(key);
        parentStacks.add(parent);
        child=parent;
      }
 else {
        LOG.info("Unknown parent stack version: " + child.getParentStackVersion() + ", for stack: "+ child.getName()+ " "+ child.getVersion());
        break;
      }
    }
  }
  return parentStacksMap;
}
