{
  DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
  DocumentBuilder builder=factory.newDocumentBuilder();
  Document doc=builder.parse(stackMetainfoFile);
  XPathFactory xPathfactory=XPathFactory.newInstance();
  XPath xpath=xPathfactory.newXPath();
  XPathExpression schemaPath=xpath.compile("/metainfo/schemaVersion[1]");
  String value=schemaPath.evaluate(doc).trim();
  if ("".equals(value) || AmbariMetaInfo.SCHEMA_VERSION_LEGACY.equals(value)) {
    return AmbariMetaInfo.SCHEMA_VERSION_LEGACY;
  }
 else   if (AmbariMetaInfo.SCHEMA_VERSION_2.equals(value)) {
    return AmbariMetaInfo.SCHEMA_VERSION_2;
  }
 else {
    String message=String.format("Unknown schema version %s at file " + "%s",value,stackMetainfoFile.getAbsolutePath());
    throw new AmbariException(message);
  }
}
