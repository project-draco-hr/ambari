{
  List<String> metricNames=Arrays.asList(MEM_METRIC + "._avg",MEM_METRIC + "._rate._avg",BYTES_IN_METRIC,BYTES_NOT_AFUNCTION_METRIC);
  HashMap<String,List<Function>> mfm=HBaseTimelineMetricStore.parseMetricNamesToAggregationFunctions(metricNames);
  assertThat(mfm).hasSize(3).containsKeys(MEM_METRIC,BYTES_IN_METRIC,BYTES_NOT_AFUNCTION_METRIC);
  assertThat(mfm.get(MEM_METRIC)).containsOnly(new Function(AVG,null),new Function(AVG,RATE));
  assertThat(mfm.get(BYTES_IN_METRIC)).contains(Function.DEFAULT_VALUE_FUNCTION);
  assertThat(mfm.get(BYTES_NOT_AFUNCTION_METRIC)).contains(Function.DEFAULT_VALUE_FUNCTION);
}
