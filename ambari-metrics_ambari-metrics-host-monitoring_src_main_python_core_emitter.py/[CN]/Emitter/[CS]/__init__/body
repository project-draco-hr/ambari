def __init__(self, config, application_metric_map, stop_handler):
    threading.Thread.__init__(self)
    logger.debug('Initializing Emitter thread.')
    self.lock = threading.Lock()
    self.send_interval = config.get_send_interval()
    self._stop_handler = stop_handler
    self.application_metric_map = application_metric_map
    protocol = ('https' if config.get_server_https_enabled() else 'http')
    self.collector_url = self.COLLECTOR_URL.format(protocol, config.get_server_address())
