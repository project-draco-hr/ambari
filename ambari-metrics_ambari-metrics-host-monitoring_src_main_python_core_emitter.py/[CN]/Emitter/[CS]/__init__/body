def __init__(self, config, application_metric_map, stop_handler):
    threading.Thread.__init__(self)
    logger.debug('Initializing Emitter thread.')
    self.lock = threading.Lock()
    self.send_interval = config.get_send_interval()
    self._stop_handler = stop_handler
    self.application_metric_map = application_metric_map
    timeout = int((self.send_interval - 10))
    if config.is_server_https_enabled():
        self.connection = CachedHTTPSConnection(config.get_server_host(), config.get_server_port(), timeout=timeout, ca_certs=config.get_ca_certs())
    else:
        self.connection = CachedHTTPConnection(config.get_server_host(), config.get_server_port(), timeout=timeout)
