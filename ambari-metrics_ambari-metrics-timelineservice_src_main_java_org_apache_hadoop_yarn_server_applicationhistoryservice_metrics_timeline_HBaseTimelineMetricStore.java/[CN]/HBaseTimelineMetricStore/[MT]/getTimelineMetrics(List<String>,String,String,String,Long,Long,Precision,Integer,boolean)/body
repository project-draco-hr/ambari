{
  Map<String,List<Function>> metricFunctions=parseMetricNamesToAggregationFunctions(metricNames);
  Condition condition=new DefaultCondition(new ArrayList<String>(metricFunctions.keySet()),hostname,applicationId,instanceId,startTime,endTime,precision,limit,groupedByHosts);
  if (hostname == null) {
    TimelineMetrics metrics=hBaseAccessor.getAggregateMetricRecords(condition,metricFunctions);
    return postProcessMetrics(metrics);
  }
  return postProcessMetrics(hBaseAccessor.getMetricRecords(condition,metricFunctions));
}
