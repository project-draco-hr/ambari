{
  LOG.info("Context parameters " + context);
  try {
    hostname=InetAddress.getLocalHost().getHostName();
  }
 catch (  UnknownHostException e) {
    LOG.error("Could not identify hostname.");
    throw new FlumeException("Could not identify hostname.",e);
  }
  Configuration configuration=new Configuration("/flume-metrics2.properties");
  int maxRowCacheSize=Integer.parseInt(configuration.getProperty(MAX_METRIC_ROW_CACHE_SIZE,String.valueOf(TimelineMetricsCache.MAX_RECS_PER_NAME_DEFAULT)));
  int metricsSendInterval=Integer.parseInt(configuration.getProperty(METRICS_SEND_INTERVAL,String.valueOf(TimelineMetricsCache.MAX_EVICTION_TIME_MILLIS)));
  metricsCache=new TimelineMetricsCache(maxRowCacheSize,metricsSendInterval);
  collectorUri="http://" + configuration.getProperty(COLLECTOR_HOST_PROPERTY) + "/ws/v1/timeline/metrics";
  List<InetSocketAddress> socketAddresses=Servers.parse(configuration.getProperty(configuration.getProperty(COLLECTOR_HOST_PROPERTY)),8188);
  if (socketAddresses != null && !socketAddresses.isEmpty()) {
    socketAddress=socketAddresses.get(0);
  }
  pollFrequency=Long.parseLong(configuration.getProperty("collectionFrequency"));
}
