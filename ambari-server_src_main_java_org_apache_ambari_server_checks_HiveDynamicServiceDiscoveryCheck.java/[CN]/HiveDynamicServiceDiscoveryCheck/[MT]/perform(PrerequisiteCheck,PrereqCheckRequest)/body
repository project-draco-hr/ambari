{
  List<String> errorMessages=new ArrayList<String>();
  String dynamicServiceDiscoveryEnabled=getProperty(request,"hive-site","hive.server2.support.dynamic.service.discovery");
  String zookeeperQuorum=getProperty(request,"hive-site","hive.zookeeper.quorum");
  String zookeeperNamespace=getProperty(request,"hive-site","hive.server2.zookeeper.namespace");
  if (null == dynamicServiceDiscoveryEnabled || !Boolean.parseBoolean(dynamicServiceDiscoveryEnabled)) {
    errorMessages.add(getFailReason(HIVE_DYNAMIC_SERVICE_DISCOVERY_ENABLED_KEY,prerequisiteCheck,request));
  }
  if (StringUtils.isBlank(zookeeperQuorum)) {
    errorMessages.add(getFailReason(HIVE_DYNAMIC_SERVICE_ZK_QUORUM_KEY,prerequisiteCheck,request));
  }
  if (StringUtils.isBlank(zookeeperNamespace)) {
    errorMessages.add(getFailReason(HIVE_DYNAMIC_SERVICE_ZK_NAMESPACE_KEY,prerequisiteCheck,request));
  }
  if (!errorMessages.isEmpty()) {
    prerequisiteCheck.setFailReason(StringUtils.join(errorMessages," "));
    prerequisiteCheck.getFailedOn().add("HIVE");
    PrereqCheckStatus checkStatus=PrereqCheckStatus.FAIL;
    if ("HDP".equals(request.getSourceStackId().getStackName())) {
      if (VersionUtils.compareVersions(request.getSourceStackId().getStackVersion(),"2.3.0.0") < 0 && VersionUtils.compareVersions(request.getTargetStackId().getStackVersion(),"2.3.0.0") < 0 && VersionUtils.compareVersions(request.getSourceStackId().getStackVersion(),request.getTargetStackId().getStackVersion()) < 0) {
        checkStatus=PrereqCheckStatus.WARNING;
      }
    }
    prerequisiteCheck.setStatus(checkStatus);
  }
}
