{
  List<String> errorMessages=new ArrayList<String>();
  String dynamicServiceDiscoveryEnabled=getProperty(request,"hive-site","hive.server2.support.dynamic.service.discovery");
  String zookeeperQuorum=getProperty(request,"hive-site","hive.zookeeper.quorum");
  String zookeeperNamespace=getProperty(request,"hive-site","hive.server2.zookeeper.namespace");
  if (null == dynamicServiceDiscoveryEnabled || !Boolean.parseBoolean(dynamicServiceDiscoveryEnabled)) {
    errorMessages.add(getFailReason(HIVE_DYNAMIC_SERVICE_DISCOVERY_ENABLED_KEY,prerequisiteCheck,request));
  }
  if (StringUtils.isBlank(zookeeperQuorum)) {
    errorMessages.add(getFailReason(HIVE_DYNAMIC_SERVICE_ZK_QUORUM_KEY,prerequisiteCheck,request));
  }
  if (StringUtils.isBlank(zookeeperNamespace)) {
    errorMessages.add(getFailReason(HIVE_DYNAMIC_SERVICE_ZK_NAMESPACE_KEY,prerequisiteCheck,request));
  }
  if (!errorMessages.isEmpty()) {
    prerequisiteCheck.setFailReason(StringUtils.join(errorMessages," "));
    prerequisiteCheck.getFailedOn().add("HIVE");
    prerequisiteCheck.setStatus(PrereqCheckStatus.FAIL);
  }
}
