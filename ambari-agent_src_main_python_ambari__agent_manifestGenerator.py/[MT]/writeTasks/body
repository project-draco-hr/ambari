def writeTasks(outputFile, roles, ambariconfig, clusterHostInfo=None, hostname='localhost'):
    rolesToClass = AmbariConfig.rolesToClass
    serviceStates = AmbariConfig.serviceStates
    outputFile.write('node /default/ {\n ')
    writeStages(outputFile, (len(roles) + 1))
    stageNum = 1
    outputFile.write((("class {'hdp': stage => " + str(stageNum)) + '}\n'))
    stageNum = (stageNum + 1)
    zk_hosts = []
    for role in roles:
        rolename = role['role']
        command = role['cmd']
        taskParams = role['roleParams']
        if (rolename == 'ZOOKEEPER_SERVER'):
            zk_hosts = clusterHostInfo['zookeeper_hosts']
            taskParams['myid'] = str((sorted(zk_hosts).index(hostname) + 1))
        taskParamsNormalized = normalizeTaskParams(taskParams)
        taskParamsPostfix = ''
        if (len(taskParamsNormalized) > 0):
            taskParamsPostfix = (', ' + taskParamsNormalized)
        className = rolesToClass[rolename]
        if (command in serviceStates):
            serviceState = serviceStates[command]
            outputFile.write((((((((("class {'" + className) + "':") + ' stage => ') + str(stageNum)) + ', service_state => ') + serviceState) + taskParamsPostfix) + '}\n'))
        else:
            outputFile.write((((((("class {'" + className) + "':") + ' stage => ') + str(stageNum)) + taskParamsPostfix) + '}\n'))
        stageNum = (stageNum + 1)
    outputFile.write('}\n')
