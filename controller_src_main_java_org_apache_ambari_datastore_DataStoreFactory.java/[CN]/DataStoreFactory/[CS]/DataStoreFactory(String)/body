{
  URI uri;
  try {
    uri=new URI(dataStore);
  }
 catch (  URISyntaxException e) {
    throw new IllegalArgumentException("Bad data store URI: " + dataStore,e);
  }
  String scheme=uri.getScheme();
  if ("zk".equals(scheme)) {
    String auth=uri.getAuthority();
    ds=new ZookeeperDS(auth);
  }
 else   if ("test".equals(scheme)) {
    ds=new StaticDataStore();
  }
 else {
    throw new IllegalArgumentException("Unknown data store " + scheme);
  }
}
