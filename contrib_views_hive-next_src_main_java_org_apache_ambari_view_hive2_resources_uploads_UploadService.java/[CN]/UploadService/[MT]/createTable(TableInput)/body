{
  try {
    tableInput.validate();
    List<ColumnDescriptionImpl> header=tableInput.getHeader();
    String databaseName=tableInput.getDatabaseName();
    String tableName=tableInput.getTableName();
    Boolean isFirstRowHeader=tableInput.getIsFirstRowHeader();
    String fileTypeStr=tableInput.getFileType();
    HiveFileType hiveFileType=HiveFileType.valueOf(fileTypeStr);
    TableInfo ti=new TableInfo(databaseName,tableName,header,hiveFileType);
    String tableCreationQuery=generateCreateQuery(ti);
    LOG.info("tableCreationQuery : {}",tableCreationQuery);
    Job actualTableJob=createJob(tableCreationQuery,databaseName);
    String actualTableJobId=actualTableJob.getId();
    JSONObject jobObject=new JSONObject();
    jobObject.put("jobId",actualTableJobId);
    LOG.info("table creation jobId {}",actualTableJobId);
    return Response.ok(jobObject).status(201).build();
  }
 catch (  Throwable e) {
    LOG.error("Exception occurred while creating table with input : " + tableInput,e);
    throw new ServiceFormattedException(e.getMessage(),e);
  }
}
