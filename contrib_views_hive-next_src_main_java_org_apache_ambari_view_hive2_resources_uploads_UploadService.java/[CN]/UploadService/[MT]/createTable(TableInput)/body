{
  try {
    tableInput.validate();
    List<ColumnDescriptionImpl> header=tableInput.getHeader();
    String databaseName=tableInput.getDatabaseName();
    String tableName=tableInput.getTableName();
    Boolean isFirstRowHeader=tableInput.getIsFirstRowHeader();
    String fileTypeStr=tableInput.getFileType();
    HiveFileType hiveFileType=HiveFileType.valueOf(fileTypeStr);
    TableInfo ti=new TableInfo(databaseName,tableName,header,hiveFileType);
    String tableCreationQuery=generateCreateQuery(ti);
    LOG.info("tableCreationQuery : {}",tableCreationQuery);
    Job job=createJob(tableCreationQuery,databaseName);
    LOG.info("job created for table creation {}",job);
    return job;
  }
 catch (  WebApplicationException e) {
    LOG.error(getErrorMessage(e),e);
    throw e;
  }
catch (  Throwable e) {
    LOG.error(e.getMessage(),e);
    throw new ServiceFormattedException(e);
  }
}
