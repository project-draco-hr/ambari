def mapreduce(name=None):
    import params
    if (name in ['jobtracker', 'historyserver']):
        params.HdfsDirectory('/mapred', action='create_delayed', owner=params.mapred_user)
        params.HdfsDirectory('/mapred/system', action='create_delayed', owner=params.mapred_user)
        params.HdfsDirectory('/mapred/history', action='create_delayed', owner=params.mapred_user)
        params.HdfsDirectory(params.mapreduce_jobhistory_intermediate_done_dir, action='create_delayed', owner=params.mapred_user, group=params.user_group, mode=511)
        params.HdfsDirectory(params.mapreduce_jobhistory_done_dir, action='create_delayed', owner=params.mapred_user, group=params.user_group, mode=511)
        params.HdfsDirectory(None, action='create')
    Directory([params.mapred_pid_dir, params.mapred_log_dir], owner=params.mapred_user, group=params.user_group, recursive=True)
    Directory(params.mapred_local_dir.split(','), owner=params.mapred_user, mode=493, recursive=True)
    File(params.exclude_file_path, owner=params.mapred_user, group=params.user_group)
    File(params.mapred_hosts_file_path, owner=params.mapred_user, group=params.user_group)
