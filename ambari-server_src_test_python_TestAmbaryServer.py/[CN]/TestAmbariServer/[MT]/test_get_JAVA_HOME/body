@patch('__builtin__.open')
@patch.object(ambari_server, 'Properties')
@patch.object(ambari_server, 'search_file')
@patch.object(ambari_server, 'get_conf_dir')
def test_get_JAVA_HOME(self, get_conf_dir_mock, search_file_mock, Properties_mock, openMock):
    out = StringIO.StringIO()
    sys.stdout = out
    openMock.side_effect = Exception('exception')
    result = ambari_server.get_JAVA_HOME()
    self.assertEqual(None, result)
    expected = os.path.dirname(__file__)
    p = MagicMock()
    p.__getitem__.return_value = expected
    openMock.side_effect = None
    Properties_mock.return_value = p
    result = ambari_server.get_JAVA_HOME()
    self.assertEqual(expected, result)
    sys.stdout = sys.__stdout__
