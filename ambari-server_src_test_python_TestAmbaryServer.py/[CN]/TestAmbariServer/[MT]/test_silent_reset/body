@patch.object(ambari_server, 'setup_db')
@patch.object(ambari_server, 'print_info_msg')
@patch.object(ambari_server, 'run_os_command')
@patch.object(ambari_server, 'parse_properties')
def test_silent_reset(self, parse_properties_mock, run_os_command_mock, print_info_msg_mock, setup_db_mock):
    out = StringIO.StringIO()
    sys.stdout = out
    args = MagicMock()
    ambari_server.SILENT = True
    self.assertTrue(ambari_server.SILENT)
    run_os_command_mock.return_value = (0, None, None)

    def signal_handler(signum, frame):
        self.fail('Timed out!')
    signal.signal(signal.SIGALRM, signal_handler)
    signal.alarm(5)
    rcode = ambari_server.reset(args)
    self.assertEqual(None, rcode)
    self.assertTrue(setup_db_mock.called)
    sys.stdout = sys.__stdout__
