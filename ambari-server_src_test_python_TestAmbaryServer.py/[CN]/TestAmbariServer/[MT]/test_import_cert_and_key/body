@patch.object(ambari_server, 'read_ambari_user')
@patch.object(ambari_server, 'set_file_permissions')
@patch.object(ambari_server, 'import_file_to_keystore')
@patch('__builtin__.open')
@patch.object(ambari_server, 'run_os_command')
@patch('os.path.join')
@patch.object(ambari_server, 'get_validated_filepath_input')
@patch.object(ambari_server, 'get_validated_string_input')
def test_import_cert_and_key(self, get_validated_string_input_mock, get_validated_filepath_input_mock, os_path_join_mock, run_os_command_mock, open_mock, import_file_to_keystore_mock, set_file_permissions_mock, read_ambari_user_mock):
    get_validated_string_input_mock.return_value = 'password'
    get_validated_filepath_input_mock.side_effect = ['cert_file_path', 'key_file_path']
    os_path_join_mock.side_effect = ['cert_file_path', 'key_file_path', 'keystore_cert_file_path', 'keystore_cert_key_file_path']
    run_os_command_mock.return_value = (0, '', '')
    om = open_mock.return_value
    expect_import_file_to_keystore = ((("[call('cert_file_path'," + " 'keystore_cert_file_path'),\n") + " call('key_file_path',") + " 'keystore_cert_key_file_path')]")
    ambari_server.import_cert_and_key('key_dir')
    self.assertTrue((get_validated_filepath_input_mock.call_count == 2))
    self.assertTrue(get_validated_string_input_mock.called)
    self.assertTrue((os_path_join_mock.call_count == 4))
    self.assertTrue((set_file_permissions_mock.call_count == 2))
    self.assertEqual(str(import_file_to_keystore_mock.call_args_list), expect_import_file_to_keystore)
