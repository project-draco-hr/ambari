@patch.object(ambari_server, 'run_os_command')
@patch.object(ambari_server, 'get_postgre_status')
def test_check_postgre_up(self, get_postgre_status_mock, run_os_command_mock):
    out = StringIO.StringIO()
    sys.stdout = out
    get_postgre_status_mock.return_value = ambari_server.PG_STATUS_RUNNING
    rcode = ambari_server.check_postgre_up()
    self.assertEqual(0, rcode)
    run_os_command_mock.return_value = (4, None, None)
    get_postgre_status_mock.return_value = None
    rcode = ambari_server.check_postgre_up()
    self.assertEqual(4, rcode)
    sys.stdout = sys.__stdout__
