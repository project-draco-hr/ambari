@patch.object(ambari_server, 'get_YN_input')
@patch.object(ambari_server, 'run_os_command')
def test_check_selinux(self, run_os_command_mock, getYNInput_mock):
    run_os_command_mock.return_value = (0, ambari_server.SE_STATUS_DISABLED, None)
    rcode = ambari_server.check_selinux()
    self.assertEqual(0, rcode)
    getYNInput_mock.return_value = True
    run_os_command_mock.return_value = (0, ('enabled ' + ambari_server.SE_MODE_ENFORCING), None)
    rcode = ambari_server.check_selinux()
    self.assertEqual(0, rcode)
    self.assertTrue(run_os_command_mock.called)
    self.assertTrue(getYNInput_mock.called)
