@patch.object(ambari_server, 'run_os_command')
def test_check_iptables(self, run_os_command_mock):
    out = StringIO.StringIO()
    sys.stdout = out
    run_os_command_mock.return_value = (1, 'test', '')
    (rcode, info) = ambari_server.check_iptables()
    self.assertEqual(1, rcode)
    self.assertEqual('test', info)
    run_os_command_mock.return_value = (2, '', ambari_server.IP_TBLS_SRVC_NT_FND)
    rcode = ambari_server.check_iptables()
    self.assertEqual(0, rcode)
    sys.stdout = sys.__stdout__
