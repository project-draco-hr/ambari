{
  Resource.Type type=Resource.Type.User;
  Injector injector=createInjector();
  SecurityHelper securityHelper=injector.getInstance(SecurityHelper.class);
  Users users=injector.getInstance(Users.class);
  User user=createMock(User.class);
  AmbariManagementController managementController=injector.getInstance(AmbariManagementController.class);
  RequestStatusResponse response=createNiceMock(RequestStatusResponse.class);
  expect(users.getAnyUser("User100")).andReturn(user).once();
  securityHelper.getCurrentAuthorities();
  expectLastCall().andReturn(Collections.emptyList()).once();
  replay(securityHelper,user,users,response);
  ResourceProvider provider=AbstractControllerResourceProvider.getResourceProvider(type,PropertyHelper.getPropertyIds(type),PropertyHelper.getKeyPropertyIds(type),managementController);
  Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(UserResourceProvider.USER_ACTIVE_PROPERTY_ID,"false");
  Request request=PropertyHelper.getUpdateRequest(properties,null);
  Predicate predicate=new PredicateBuilder().property(UserResourceProvider.USER_USERNAME_PROPERTY_ID).equals("User100").toPredicate();
  provider.updateResources(request,predicate);
  verify(securityHelper,user,users,response);
}
