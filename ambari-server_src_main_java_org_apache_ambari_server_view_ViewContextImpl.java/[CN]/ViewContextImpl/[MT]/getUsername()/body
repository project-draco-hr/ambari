{
  String shortName=getLoggedinUser();
  try {
    String authToLocalRules=getAuthToLocalRules();
    String defaultRealm=KerberosUtil.getDefaultRealm();
    if (Strings.isNotEmpty(authToLocalRules) && Strings.isNotEmpty(defaultRealm)) {
synchronized (KerberosName.class) {
        KerberosName.setRules(authToLocalRules);
        shortName=new KerberosName(shortName + "@" + defaultRealm).getShortName();
      }
    }
  }
 catch (  Exception e) {
    LOG.error("Failed to get username",e);
  }
  return shortName;
}
