{
  Map<String,Map<String,ConfigProperty>> mapServiceConfig=new HashMap<String,Map<String,ConfigProperty>>();
  serviceConfigurations.put(service,mapServiceConfig);
  Set<StackConfigurationResponse> serviceConfigs=ambariManagementController.getStackConfigurations(Collections.singleton(new StackConfigurationRequest(name,version,service,null)));
  Set<StackConfigurationResponse> stackLevelConfigs=ambariManagementController.getStackLevelConfigurations(Collections.singleton(new StackLevelConfigurationRequest(name,version,null)));
  serviceConfigs.addAll(stackLevelConfigs);
  for (  StackConfigurationResponse config : serviceConfigs) {
    String type=config.getType();
    if (type.endsWith(".xml")) {
      type=type.substring(0,type.length() - 4);
    }
    Map<String,ConfigProperty> mapTypeConfig=mapServiceConfig.get(type);
    if (mapTypeConfig == null) {
      mapTypeConfig=new HashMap<String,ConfigProperty>();
      mapServiceConfig.put(type,mapTypeConfig);
    }
    mapTypeConfig.put(config.getPropertyName(),new ConfigProperty(config.getPropertyValue(),config.getPropertyAttributes()));
  }
}
