{
  String clusterName=(String)requestMap.get(UPGRADE_CLUSTER_NAME);
  String version=(String)requestMap.get(UPGRADE_VERSION);
  String versionForUpgradePack=(String)requestMap.get(UPGRADE_FROM_VERSION);
  final UpgradeType upgradeType=requestMap.containsKey(UPGRADE_TYPE) ? UpgradeType.valueOf((String)requestMap.get(UPGRADE_TYPE)) : UpgradeType.ROLLING;
  if (null == clusterName) {
    throw new AmbariException(String.format("%s is required",UPGRADE_CLUSTER_NAME));
  }
  if (null == version) {
    throw new AmbariException(String.format("%s is required",UPGRADE_VERSION));
  }
  validatePreRequest(clusterName,direction,version,requestMap);
  return s_upgradeHelper.suggestUpgradePack(clusterName,versionForUpgradePack,version,direction,upgradeType);
}
