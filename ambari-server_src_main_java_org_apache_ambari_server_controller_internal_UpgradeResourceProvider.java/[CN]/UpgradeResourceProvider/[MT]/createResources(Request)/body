{
  Set<Map<String,Object>> requestMaps=request.getProperties();
  if (requestMaps.size() > 1) {
    throw new SystemException("Can only initiate one upgrade per request.");
  }
  for (  final Map<String,Object> requestMap : requestMaps) {
    createResources(new Command<Void>(){
      @Override public Void invoke() throws AmbariException {
        UpgradePack up=validateRequest(requestMap);
        createUpgrade(up,requestMap);
        return null;
      }
    }
);
  }
  notifyCreate(Resource.Type.Upgrade,request);
  return getRequestStatus(null);
}
