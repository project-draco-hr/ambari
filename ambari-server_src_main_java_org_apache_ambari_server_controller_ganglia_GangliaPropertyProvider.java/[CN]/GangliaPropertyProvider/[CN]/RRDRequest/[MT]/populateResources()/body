{
  String spec=getSpec(clusterName,clusterSet,hostSet,metrics.keySet(),temporalInfo);
  Collection<Resource> populatedResources=new HashSet<Resource>();
  try {
    List<GangliaMetric> gangliaMetrics=new ObjectMapper().readValue(getStreamProvider().readFrom(spec),new TypeReference<List<GangliaMetric>>(){
    }
);
    if (gangliaMetrics != null) {
      for (      GangliaMetric gangliaMetric : gangliaMetrics) {
        ResourceKey key=new ResourceKey(gangliaMetric.getHost_name(),gangliaMetric.getCluster_name());
        Set<Resource> resourceSet=resources.get(key);
        if (resourceSet != null) {
          for (          Resource resource : resourceSet) {
            populateResource(resource,gangliaMetric);
          }
        }
      }
    }
  }
 catch (  IOException e) {
    if (LOG.isErrorEnabled()) {
      LOG.error("Caught exception getting Ganglia metrics : spec=" + spec,e);
    }
  }
  return populatedResources;
}
