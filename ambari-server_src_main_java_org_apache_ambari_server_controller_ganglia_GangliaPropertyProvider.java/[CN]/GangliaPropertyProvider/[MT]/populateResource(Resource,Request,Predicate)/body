{
  if (getPropertyIds().isEmpty()) {
    return true;
  }
  String clusterName=(String)resource.getPropertyValue(clusterNamePropertyId);
  if (hostProvider.getGangliaHostClusterMap(clusterName) == null || hostProvider.getGangliaCollectorHostName(clusterName) == null) {
    return true;
  }
  String hostName=hostNamePropertyId == null ? null : (String)resource.getPropertyValue(hostNamePropertyId);
  String componentName;
  String gangliaClusterName;
  if (componentNamePropertyId == null) {
    componentName="*";
    gangliaClusterName=hostProvider.getGangliaHostClusterMap(clusterName).get(hostName);
  }
 else {
    componentName=(String)resource.getPropertyValue(componentNamePropertyId);
    gangliaClusterName=GANGLIA_CLUSTER_NAMES.get(componentName);
  }
  Map<PropertyId,String> metrics=componentMetrics.get(componentName);
  if (metrics == null || gangliaClusterName == null) {
    return true;
  }
  Set<PropertyId> ids=PropertyHelper.getRequestPropertyIds(getPropertyIds(),request,predicate);
  if (checkRRD || useRRD) {
    useRRD=setProperties(resource,request,clusterName,hostName,gangliaClusterName,metrics,ids,true);
    checkRRD=false;
  }
  if (!useRRD) {
    setProperties(resource,request,clusterName,hostName,gangliaClusterName,metrics,ids,false);
  }
  return true;
}
