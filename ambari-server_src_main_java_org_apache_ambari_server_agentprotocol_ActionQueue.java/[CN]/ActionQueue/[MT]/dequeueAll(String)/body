{
  Queue<AgentCommand> q=getQueue(hostname);
  List<AgentCommand> l=new ArrayList<AgentCommand>();
synchronized (q) {
    while (true) {
      try {
        l.add(q.remove());
      }
 catch (      NoSuchElementException ex) {
        return l;
      }
    }
  }
}
