{
  String username=((User)SecurityContextHolder.getContext().getAuthentication().getPrincipal()).getUsername();
  AccessUnauthorizedAuditEvent ae=AccessUnauthorizedAuditEvent.builder().withRemoteIp(request.getRemoteAddress()).withResourcePath(request.getURI()).withTimestamp(System.currentTimeMillis()).withUserName(username).build();
  return ae;
}
