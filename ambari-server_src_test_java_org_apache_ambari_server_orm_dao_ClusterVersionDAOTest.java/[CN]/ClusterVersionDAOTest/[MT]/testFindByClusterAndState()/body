{
  createRecordsUntilStep(1);
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.CURRENT).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLED).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLING).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALL_FAILED).size());
  createRecordsUntilStep(2);
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.CURRENT).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLED).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLING).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALL_FAILED).size());
  createRecordsUntilStep(3);
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.CURRENT).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLED).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLING).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALL_FAILED).size());
  createRecordsUntilStep(4);
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.CURRENT).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLED).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLING).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALL_FAILED).size());
  createRecordsUntilStep(5);
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.CURRENT).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLED).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLING).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALL_FAILED).size());
  createRecordsUntilStep(6);
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.CURRENT).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLED).size());
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLING).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALL_FAILED).size());
  createRecordsUntilStep(7);
  Assert.assertEquals(1,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.CURRENT).size());
  Assert.assertEquals(2,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLED).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALLING).size());
  Assert.assertEquals(0,clusterVersionDAO.findByClusterAndState(cluster.getClusterName(),RepositoryVersionState.INSTALL_FAILED).size());
}
