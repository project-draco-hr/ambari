@patch.object(ambari_server, 'run_os_command')
@patch.object(ambari_server, 'print_warning_msg')
@patch.object(ambari_server, 'get_YN_input')
def test_check_iptables_is_running(self, get_YN_input_mock, print_warning_msg, run_os_command_mock):
    run_os_command_mock.return_value = (0, 'Table: filter', '')
    get_YN_input_mock.side_effect = [True]
    ambari_server.check_iptables()
    self.assertEqual(print_warning_msg.call_args_list[0][0][0], (('%s is running. Confirm the necessary Ambari ports are accessible. ' % ambari_server.FIREWALL_SERVICE_NAME) + 'Refer to the Ambari documentation for more details on ports.'))
