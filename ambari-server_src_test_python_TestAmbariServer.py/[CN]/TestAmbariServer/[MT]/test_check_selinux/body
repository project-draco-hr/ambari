@patch.object(_ambari_server_, 'get_YN_input')
@patch.object(_ambari_server_, 'run_os_command')
def test_check_selinux(self, run_os_command_mock, getYNInput_mock):
    run_os_command_mock.return_value = (0, _ambari_server_.SE_STATUS_DISABLED, None)
    rcode = _ambari_server_.check_selinux()
    self.assertEqual(0, rcode)
    getYNInput_mock.return_value = True
    run_os_command_mock.return_value = (0, ('enabled ' + _ambari_server_.SE_MODE_ENFORCING), None)
    rcode = _ambari_server_.check_selinux()
    self.assertEqual(0, rcode)
    self.assertTrue(run_os_command_mock.called)
    self.assertTrue(getYNInput_mock.called)
