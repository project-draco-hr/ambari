@patch.object(OSCheck, 'get_os_family')
@patch.object(OSCheck, 'get_os_type')
@patch.object(OSCheck, 'get_os_major_version')
@patch('ambari_server.serverSetup.get_YN_input')
@patch('ambari_server.serverSetup.run_os_command')
def test_disable_security_enhancements(self, run_os_command_mock, getYNInput_mock, get_os_major_version_mock, get_os_type_mock, get_os_family_mock):
    run_os_command_mock.return_value = (0, ambari__server.SE_STATUS_DISABLED, None)
    (rcode, err) = disable_security_enhancements()
    self.assertEqual(0, rcode)
    getYNInput_mock.return_value = True
    run_os_command_mock.return_value = (0, ('enabled ' + ambari__server.SE_MODE_ENFORCING), None)
    (rcode, err) = disable_security_enhancements()
    self.assertEqual(0, rcode)
    self.assertTrue(run_os_command_mock.called)
    self.assertTrue(getYNInput_mock.called)
