@patch('shlex.split')
@patch('subprocess.Popen')
@patch.object(_ambari_server_, 'print_info_msg')
def test_run_os_command(self, printInfoMsg_mock, popenMock, splitMock):
    p = MagicMock()
    p.communicate.return_value = (None, None)
    p.returncode = 3
    popenMock.return_value = p
    cmd = ['exec', 'arg']
    _ambari_server_.run_os_command(cmd)
    self.assertFalse(splitMock.called)
    resp = _ambari_server_.run_os_command('runme')
    self.assertEqual(3, resp[0])
    self.assertTrue(splitMock.called)
