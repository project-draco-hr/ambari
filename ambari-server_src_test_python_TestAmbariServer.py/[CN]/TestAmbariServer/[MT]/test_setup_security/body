@patch.object(_ambari_server_, 'setup_ambari_krb5_jaas')
@patch.object(_ambari_server_, 'setup_master_key')
@patch.object(_ambari_server_, 'setup_component_https')
@patch.object(_ambari_server_, 'setup_https')
@patch.object(_ambari_server_, 'get_validated_string_input')
def test_setup_security(self, get_validated_string_input_mock, setup_https, setup_component_https, setup_master_key, setup_ambari_krb5_jaas):
    args = {}
    get_validated_string_input_mock.return_value = '1'
    _ambari_server_.setup_security(args)
    self.assertTrue(setup_https.called)
    get_validated_string_input_mock.return_value = '2'
    _ambari_server_.setup_security(args)
    self.assertTrue(setup_component_https.called)
    setup_component_https.assert_called_with('Ganglia', 'setup-ganglia-https', _ambari_server_.GANGLIA_HTTPS, 'ganglia_cert')
    get_validated_string_input_mock.return_value = '3'
    _ambari_server_.setup_security(args)
    self.assertTrue(setup_master_key.called)
    get_validated_string_input_mock.return_value = '4'
    _ambari_server_.setup_security(args)
    self.assertTrue(setup_ambari_krb5_jaas.called)
    pass
