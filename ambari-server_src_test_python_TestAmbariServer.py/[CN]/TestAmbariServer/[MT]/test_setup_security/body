@patch.object(ambari_server, 'setup_ambari_krb5_jaas')
@patch.object(ambari_server, 'setup_master_key')
@patch.object(ambari_server, 'setup_component_https')
@patch.object(ambari_server, 'setup_https')
@patch.object(ambari_server, 'get_validated_string_input')
def test_setup_security(self, get_validated_string_input_mock, setup_https, setup_component_https, setup_master_key, setup_ambari_krb5_jaas):
    args = {}
    get_validated_string_input_mock.return_value = '1'
    ambari_server.setup_security(args)
    self.assertTrue(setup_https.called)
    get_validated_string_input_mock.return_value = '2'
    ambari_server.setup_security(args)
    self.assertTrue(setup_component_https.called)
    setup_component_https.assert_called_with('Ganglia', 'setup-ganglia-https', ambari_server.GANGLIA_HTTPS, 'ganglia_cert')
    get_validated_string_input_mock.return_value = '3'
    ambari_server.setup_security(args)
    self.assertTrue(setup_component_https.called)
    setup_component_https.assert_called_with('Nagios', 'setup-nagios-https', ambari_server.NAGIOS_HTTPS, 'nagios_cert')
    get_validated_string_input_mock.return_value = '4'
    ambari_server.setup_security(args)
    self.assertTrue(setup_master_key.called)
    get_validated_string_input_mock.return_value = '5'
    ambari_server.setup_security(args)
    self.assertTrue(setup_ambari_krb5_jaas.called)
