@patch.object(ambari_server, 'configure_database_username_password')
@patch.object(ambari_server, 'run_os_command')
@patch('optparse.Values')
def test_configure_pg_hba_ambaridb_users(self, OptParseValuesMock, run_os_command_method, configure_database_username_password_method):
    run_os_command_method.return_value = (0, '', '')
    opvm = OptParseValuesMock.return_value
    opvm.database_username = 'ffdf'
    tf1 = tempfile.NamedTemporaryFile()
    ambari_server.PG_HBA_CONF_FILE = tf1.name
    ambari_server.configure_pg_hba_ambaridb_users()
    self.assertTrue(run_os_command_method.called)
    self.assertTrue(configure_database_username_password_method.called)
    string_expected = self.get_file_string(self.get_samples_dir('configure_pg_hba_ambaridb_users1'))
    string_actual = self.get_file_string(ambari_server.PG_HBA_CONF_FILE)
    self.assertEquals(string_expected, string_actual)
    pass
