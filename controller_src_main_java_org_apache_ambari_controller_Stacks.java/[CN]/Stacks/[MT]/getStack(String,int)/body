{
  if (!stackExists(stackName)) {
    String msg="Stack [" + stackName + "] is not defined";
    throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_FOUND)).get());
  }
  Stack bp=null;
  if (revision < 0) {
    bp=dataStore.retrieveStack(stackName,getStackLatestRevision(stackName));
  }
 else {
    if (revision > getStackLatestRevision(stackName)) {
      String msg="Stack [" + stackName + "], revision ["+ revision+ "] does not exist";
      throw new WebApplicationException((new ExceptionResponse(msg,Response.Status.NOT_FOUND)).get());
    }
    bp=dataStore.retrieveStack(stackName,revision);
  }
  return bp;
}
