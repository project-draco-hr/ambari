{
  Hashtable<String,String> clusterStacks=new Hashtable<String,String>();
  List<String> clusterNames=dataStore.retrieveClusterList();
  for (  String clsName : clusterNames) {
    Cluster c=Clusters.getInstance().getClusterByName(clsName);
    String cBPName=c.getClusterDefinition(-1).getStackName();
    String cBPRevision=c.getClusterDefinition(-1).getStackRevision();
    clusterStacks.put(cBPName,cBPRevision);
    Stack bpx=this.getStack(cBPName,Integer.parseInt(cBPRevision));
    while (bpx.getParentName() != null) {
      if (bpx.getParentRevision() == null) {
        bpx=this.getStack(bpx.getParentName(),-1);
      }
 else {
        bpx=this.getStack(bpx.getParentName(),Integer.parseInt(bpx.getParentRevision()));
      }
      clusterStacks.put(bpx.getName(),bpx.getRevision());
    }
  }
  return clusterStacks;
}
