{
  Set<String> requestedIds=PropertyHelper.getRequestPropertyIds(getPropertyIds(),request,predicate);
  final Map<String,Object> predicateProperties=PredicateHelper.getProperties(predicate);
  String clusterName=(String)predicateProperties.get(TASK_CLUSTER_NAME_PROPERTY_ID);
  Long request_id=new Long((String)predicateProperties.get(TASK_REQUEST_ID_PROPERTY_ID));
  Set<TaskStatusResponse> responses=getResources(new Command<Set<TaskStatusResponse>>(){
    @Override public Set<TaskStatusResponse> invoke() throws AmbariException {
      return getManagementController().getTaskStatus(Collections.singleton(getRequest(predicateProperties)));
    }
  }
);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Printing size of responses " + responses.size());
    for (    TaskStatusResponse response : responses) {
      LOG.debug("Printing response from management controller " + response.toString());
    }
  }
  Set<Resource> resources=new HashSet<Resource>();
  for (  TaskStatusResponse response : responses) {
    Resource resource=new ResourceImpl(Resource.Type.Task);
    setResourceProperty(resource,TASK_CLUSTER_NAME_PROPERTY_ID,clusterName,requestedIds);
    setResourceProperty(resource,TASK_REQUEST_ID_PROPERTY_ID,request_id,requestedIds);
    setResourceProperty(resource,TASK_ID_PROPERTY_ID,response.getTaskId(),requestedIds);
    setResourceProperty(resource,TASK_STAGE_ID_PROPERTY_ID,response.getStageId(),requestedIds);
    setResourceProperty(resource,TASK_HOST_NAME_PROPERTY_ID,response.getHostName(),requestedIds);
    setResourceProperty(resource,TASK_ROLE_PROPERTY_ID,response.getRole(),requestedIds);
    setResourceProperty(resource,TASK_COMMAND_PROPERTY_ID,response.getCommand(),requestedIds);
    setResourceProperty(resource,TASK_STATUS_PROPERTY_ID,response.getStatus(),requestedIds);
    setResourceProperty(resource,TASK_EXIT_CODE_PROPERTY_ID,response.getExitCode(),requestedIds);
    setResourceProperty(resource,TASK_STDERR_PROPERTY_ID,response.getStderr(),requestedIds);
    setResourceProperty(resource,TASK_STOUT_PROPERTY_ID,response.getStdout(),requestedIds);
    setResourceProperty(resource,TASK_START_TIME_PROPERTY_ID,response.getStartTime(),requestedIds);
    setResourceProperty(resource,TASK_ATTEMPT_CNT_PROPERTY_ID,response.getAttemptCount(),requestedIds);
    resources.add(resource);
  }
  return resources;
}
