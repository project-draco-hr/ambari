@patch('time.time')
@patch('socket.socket')
def test_socket_timeout(self, socket_mock, time_mock):
    s = socket_mock.return_value
    s.connect = MagicMock()
    s.connect.side_effect = socket.error('')
    time_mock.side_effect = [0, 1000, 2000, 3000, 4000]
    try:
        self.executeScript('1.3.2/services/HIVE/package/scripts/hive_server.py', classname='HiveServer', command='start', config_file='default.json')
        self.fail('Script failure due to socket error was expected')
    except:
        self.assert_configure_default()
        self.assertTrue(socket_mock.called)
        self.assertTrue(s.close.called)
