{
  Map<String,String> hosts=new HashMap<String,String>();
  try {
    Connection connection=CONNECTION_FACTORY.getConnection();
    try {
      String sql="select attributes from hosts";
      Statement statement=connection.createStatement();
      ResultSet rs=statement.executeQuery(sql);
      ObjectMapper mapper=new ObjectMapper();
      while (rs.next()) {
        String attributes=rs.getString(1);
        if (!attributes.startsWith("[]")) {
          try {
            Map<String,String> attributeMap=mapper.readValue(attributes,new TypeReference<Map<String,String>>(){
            }
);
            hosts.put(attributeMap.get("privateFQDN"),attributeMap.get("publicFQDN"));
          }
 catch (          IOException e) {
            throw new IllegalStateException("Can't read hosts " + attributes,e);
          }
        }
      }
      statement.close();
    }
  finally {
      connection.close();
    }
  }
 catch (  SQLException e) {
    throw new IllegalStateException("Can't access DB.",e);
  }
  return hosts;
}
