{
  HttpServletRequest request=createMock(HttpServletRequest.class);
  HttpServletResponse response=createMock(HttpServletResponse.class);
  FilterChain filterChain=createMock(FilterChain.class);
  expect(request.getHeader("Authorization")).andReturn("header").andReturn(null);
  expect(request.getHeader("X-Forwarded-For")).andReturn("1.2.3.4");
  mockedAuditLogger.log(anyObject(AuditEvent.class));
  expectLastCall().times(1);
  filterChain.doFilter(request,response);
  expectLastCall();
  replay(mockedAuditLogger,request,filterChain);
  underTest.doFilter(request,response,filterChain);
  verify(mockedAuditLogger,request,filterChain);
}
