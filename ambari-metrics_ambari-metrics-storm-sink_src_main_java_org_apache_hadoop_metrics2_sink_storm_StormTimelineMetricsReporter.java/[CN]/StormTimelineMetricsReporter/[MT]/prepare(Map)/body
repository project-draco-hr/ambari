{
  LOG.info("Preparing Storm Metrics Reporter");
  try {
    try {
      hostname=InetAddress.getLocalHost().getHostName();
    }
 catch (    UnknownHostException e) {
      LOG.error("Could not identify hostname.");
      throw new RuntimeException("Could not identify hostname.",e);
    }
    Validate.notNull(conf.get(METRICS_COLLECTOR),METRICS_COLLECTOR + " can not be null");
    Map cf=(Map)conf.get(METRICS_COLLECTOR);
    Map stormConf=Utils.readStormConfig();
    this.nimbusClient=NimbusClient.getConfiguredClient(stormConf);
    String collectorHostname=cf.get(COLLECTOR_HOST).toString();
    String port=cf.get(COLLECTOR_PORT).toString();
    collectorUri="http://" + collectorHostname + ":"+ port+ "/ws/v1/timeline/metrics";
    List<InetSocketAddress> socketAddresses=Servers.parse(collectorHostname,Integer.valueOf(port));
    if (socketAddresses != null && !socketAddresses.isEmpty()) {
      socketAddress=socketAddresses.get(0);
    }
  }
 catch (  Exception e) {
    LOG.warn("could not initialize metrics collector, please specify host, port under $STORM_HOME/conf/config.yaml ",e);
  }
}
