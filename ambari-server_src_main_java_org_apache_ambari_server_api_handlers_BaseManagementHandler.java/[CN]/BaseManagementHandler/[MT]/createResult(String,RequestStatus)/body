{
  boolean isSynchronous=requestStatus.getStatus() == RequestStatus.Status.Complete;
  Result result=new ResultImpl(isSynchronous);
  TreeNode<Resource> tree=result.getResultTree();
  Set<Resource> setResources=requestStatus.getAssociatedResources();
  TreeNode<Resource> resourcesNode=null;
  if (!setResources.isEmpty()) {
    resourcesNode=tree.addChild(null,"resources");
  }
  int count=1;
  for (  Resource resource : setResources) {
    resourcesNode.addChild(resource,resource.getType() + ":" + count++);
  }
  if (!isSynchronous) {
    Resource requestResource=requestStatus.getRequestResource();
    TreeNode<Resource> r=tree.addChild(requestResource,"request");
    r.setProperty("href",buildRequestHref(uri,requestStatus));
  }
  return result;
}
