{
  logStartup();
  Injector injector=Guice.createInjector(new ControllerModule(),new AuditLoggerModule());
  AmbariServer server=null;
  try {
    LOG.info("Getting the controller");
    setupProxyAuth();
    injector.getInstance(GuiceJpaInitializer.class);
    DatabaseConsistencyCheckHelper.checkDBVersionCompatible();
    server=injector.getInstance(AmbariServer.class);
    CertificateManager certMan=injector.getInstance(CertificateManager.class);
    certMan.initRootCert();
    KerberosChecker.checkJaasConfiguration();
    ViewRegistry.initInstance(server.viewRegistry);
    ComponentSSLConfiguration.instance().init(server.configs);
    server.run();
  }
 catch (  Throwable t) {
    LOG.error("Failed to run the Ambari Server",t);
    if (server != null) {
      server.stop();
    }
    System.exit(-1);
  }
}
