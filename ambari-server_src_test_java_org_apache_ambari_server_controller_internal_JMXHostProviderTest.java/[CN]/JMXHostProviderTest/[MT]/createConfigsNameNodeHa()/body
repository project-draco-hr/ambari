{
  String clusterName="nnha";
  ClusterRequest r=new ClusterRequest(null,clusterName,"HDP-2.0.6",null);
  controller.createCluster(r);
  Cluster cluster=clusters.getCluster(clusterName);
  cluster.setDesiredStackVersion(new StackId("HDP-2.0.6"));
  String serviceName="HDFS";
  createService(clusterName,serviceName,null);
  String componentName1="NAMENODE";
  String componentName2="DATANODE";
  String componentName3="HDFS_CLIENT";
  createServiceComponent(clusterName,serviceName,componentName1,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName2,State.INIT);
  createServiceComponent(clusterName,serviceName,componentName3,State.INIT);
  String host1="h1";
  clusters.addHost(host1);
  Map<String,String> hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","5.9");
  clusters.getHost("h1").setHostAttributes(hostAttributes);
  clusters.getHost("h1").persist();
  String host2="h2";
  clusters.addHost(host2);
  hostAttributes=new HashMap<String,String>();
  hostAttributes.put("os_family","redhat");
  hostAttributes.put("os_release_version","6.3");
  clusters.getHost("h2").setHostAttributes(hostAttributes);
  clusters.getHost("h2").persist();
  clusters.mapHostToCluster(host1,clusterName);
  clusters.mapHostToCluster(host2,clusterName);
  createServiceComponentHost(clusterName,serviceName,componentName1,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName1,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName2,host2,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host1,null);
  createServiceComponentHost(clusterName,serviceName,componentName3,host2,null);
  Map<String,String> configs=new HashMap<String,String>();
  configs.put("dfs.internal.nameservices","ns");
  configs.put("dfs.namenode.http-address","h1:50070");
  configs.put("dfs.namenode.http-address.ns.nn1","h1:50071");
  configs.put("dfs.namenode.http-address.ns.nn2","h2:50072");
  configs.put("dfs.namenode.https-address","h1:50470");
  configs.put("dfs.namenode.https-address.ns.nn1","h1:50473");
  configs.put("dfs.namenode.https-address.ns.nn2","h2:50474");
  configs.put("dfs.ha.namenodes.ns","nn1,nn2");
  ConfigurationRequest cr1=new ConfigurationRequest(clusterName,"hdfs-site","version1",configs,null);
  ClusterRequest crReq=new ClusterRequest(cluster.getClusterId(),clusterName,null,null);
  crReq.setDesiredConfig(Collections.singletonList(cr1));
  controller.updateClusters(Collections.singleton(crReq),null);
}
