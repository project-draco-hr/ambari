def check_db_connnection():
    import params
    Logger.info('Checking DB connection')
    if (params.db_flavor.lower() == 'mysql'):
        cmd = format('{sql_command_invoker} -u {db_root_user} --password={db_root_password} -h {db_host}  -s -e "select version();"')
    elif (params.db_flavor.lower() == 'oracle'):
        cmd = format('{sql_command_invoker} {db_root_user}/{db_root_password}@{db_host} AS SYSDBA')
    elif (params.db_flavor.lower() == 'postgres'):
        cmd = 'true'
    elif (params.db_flavor.lower() == 'sqlserver'):
        cmd = 'true'
    try:
        Execute(cmd)
    except Fail as ex:
        Logger.info(ex)
        raise Fail('Ranger Admin installation Failed! Ranger requires DB client installed on Ranger Host, DB administrative privileges configured for connectivity from the Ranger Admin host to the configured DB host/instance and the DB server up and running on the DB host.')
