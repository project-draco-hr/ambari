def check_db_connnection():
    import params
    db_root_password = params.db_root_password
    db_root_user = params.db_root_user
    db_host = params.db_host
    sql_command_invoker = params.sql_command_invoker
    db_flavor = params.db_flavor
    cmd_str = ''
    Logger.info('Checking DB connection')
    if (db_flavor and (db_flavor.lower() == 'mysql')):
        cmd_str = ((((((((('"' + sql_command_invoker) + '"') + ' -u ') + db_root_user) + ' --password=') + db_root_password) + ' -h ') + db_host) + ' -s -e "select version();"')
    elif (db_flavor and (db_flavor.lower() == 'oracle')):
        cmd_str = (((((((sql_command_invoker + ' ') + db_root_user) + '/') + db_root_password) + '@') + db_host) + ' AS SYSDBA')
    (status, output) = get_status_output(cmd_str)
    if (status == 0):
        Logger.info('Checking DB connection DONE')
        return True
    else:
        Logger.info('Ranger Admin installation Failed! Ranger requires DB client installed on Ranger Host, DB administrative privileges configured for connectivity from the Ranger Admin host to the configured DB host/instance and the DB server up and running on the DB host.')
        sys.exit(1)
