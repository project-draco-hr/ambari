{
  final Cluster cluster=clustersProvider.get().getCluster(request.getClusterName());
  Map<String,Service> services=cluster.getServices();
  List<String> errorMessages=new ArrayList<String>();
  if (services.containsKey("HIVE")) {
    String hiveClientRetryCount=getProperty(request,"hive-site","hive.metastore.failure.retries");
    if (null != hiveClientRetryCount && Integer.parseInt(hiveClientRetryCount) <= 0) {
      errorMessages.add(getFailReason(HIVE_CLIENT_RETRY_MISSING_KEY,prerequisiteCheck,request));
      prerequisiteCheck.getFailedOn().add("HIVE");
    }
  }
  if (services.containsKey("OOZIE")) {
    String oozieClientRetry=getProperty(request,"oozie-env","content");
    if (null == oozieClientRetry || !oozieClientRetry.contains("-Doozie.connection.retry.count")) {
      errorMessages.add(getFailReason(OOZIE_CLIENT_RETRY_MISSING_KEY,prerequisiteCheck,request));
      prerequisiteCheck.getFailedOn().add("OOZIE");
    }
  }
  if (!errorMessages.isEmpty()) {
    prerequisiteCheck.setFailReason(StringUtils.join(errorMessages," "));
    prerequisiteCheck.setStatus(PrereqCheckStatus.FAIL);
  }
}
