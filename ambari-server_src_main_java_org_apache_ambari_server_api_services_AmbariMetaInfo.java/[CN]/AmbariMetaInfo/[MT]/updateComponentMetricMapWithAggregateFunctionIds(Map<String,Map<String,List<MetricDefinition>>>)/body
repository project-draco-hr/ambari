{
  if (!metricMap.isEmpty()) {
    for (    Map<String,List<MetricDefinition>> componentMetricDef : metricMap.values()) {
      for (      Map.Entry<String,List<MetricDefinition>> metricDefEntry : componentMetricDef.entrySet()) {
        if (metricDefEntry.getKey().equals(Component.name())) {
          for (          MetricDefinition metricDefinition : metricDefEntry.getValue()) {
            if (metricDefinition.getType().equals("ganglia")) {
              for (              Map<String,Metric> metricByCategory : metricDefinition.getMetricsByCategory().values()) {
                Map<String,Metric> newMetrics=new HashMap<String,Metric>();
                for (                String identifierToAdd : AGGREGATE_FUNCTION_IDENTIFIERS) {
                  for (                  Map.Entry<String,Metric> metricEntry : metricByCategory.entrySet()) {
                    String newMetricKey=metricEntry.getKey() + identifierToAdd;
                    Metric currentMetric=metricEntry.getValue();
                    Metric newMetric=new Metric(currentMetric.getName() + identifierToAdd,currentMetric.isPointInTime(),currentMetric.isTemporal(),currentMetric.isAmsHostMetric(),currentMetric.getUnit());
                    newMetrics.put(newMetricKey,newMetric);
                  }
                }
                metricByCategory.putAll(newMetrics);
              }
            }
          }
        }
      }
    }
  }
  return metricMap;
}
