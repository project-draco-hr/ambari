def decommission(self, env):
    import params
    env.set_params(params)
    hdfs_user = params.hdfs_user
    conf_dir = params.hadoop_conf_dir
    File(params.exclude_file_path, content=Template('exclude_hosts_list.j2'), owner=hdfs_user)
    if params.dfs_ha_enabled:
        nn_refresh_cmd = format('cmd /c hadoop dfsadmin -fs hdfs://{namenode_rpc} -refreshNodes')
    else:
        nn_refresh_cmd = format('cmd /c hadoop dfsadmin -refreshNodes')
    Execute(nn_refresh_cmd, user=hdfs_user)
