def install(self, env):
    if (not check_windows_service_exists(service_mapping.namenode_win_service_name)):
        self.install_packages(env)
    import params
    self.configure(env)
    namenode_format_marker = os.path.join(params.hadoop_conf_dir, 'NN_FORMATTED')
    if (not os.path.exists(namenode_format_marker)):
        hadoop_cmd = ('cmd /C %s' % os.path.join(params.hadoop_home, 'bin', 'hadoop.cmd'))
        Execute(('%s namenode -format' % hadoop_cmd))
        open(namenode_format_marker, 'a').close()
