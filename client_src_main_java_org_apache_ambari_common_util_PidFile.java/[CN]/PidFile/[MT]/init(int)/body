{
  String pidLong=ManagementFactory.getRuntimeMXBean().getName();
  String[] items=pidLong.split("@");
  String pid=items[0];
  String chukwaPath=System.getProperty("HMS_HOME");
  StringBuffer pidFilesb=new StringBuffer();
  String pidDir=System.getenv("HMS_PID_DIR");
  if (pidDir == null) {
    pidDir=chukwaPath + File.separator + "var"+ File.separator+ "run";
  }
  pidFilesb.append(pidDir).append(File.separator).append(name).append(".pid");
  try {
    serverSocket=new ServerSocket(port);
    File existsFile=new File(pidDir);
    if (!existsFile.exists()) {
      boolean success=(new File(pidDir)).mkdirs();
      if (!success) {
        throw (new IOException());
      }
    }
    File pidFile=new File(pidFilesb.toString());
    pidFileOutput=new FileOutputStream(pidFile);
    pidFileOutput.write(pid.getBytes());
    pidFileOutput.flush();
    log.debug("Initlization succeeded...");
  }
 catch (  IOException ex) {
    System.out.println("Initialization failed: can not write pid file to " + pidFilesb);
    log.error("Initialization failed...");
    log.error(ex.getMessage());
    System.exit(-1);
    throw ex;
  }
}
