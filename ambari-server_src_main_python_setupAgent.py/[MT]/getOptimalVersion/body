def getOptimalVersion(initialProjectVersion):
    optimalVersion = initialProjectVersion
    if is_suse():
        ret = checkAgentPackageAvailabilitySuse(optimalVersion)
    else:
        ret = checkAgentPackageAvailability(optimalVersion)
    if (ret['exitstatus'] == 0):
        return optimalVersion
    optimalVersion = (optimalVersion + '.')
    if is_suse():
        ret = findNearestAgentPackageVersionSuse(optimalVersion)
    else:
        ret = findNearestAgentPackageVersion(optimalVersion)
    if ((ret['exitstatus'] == 0) and (ret['log'][0].strip() != '')):
        optimalVersion = ret['log'][0].strip()
    else:
        optimalVersion = ''
    return optimalVersion
