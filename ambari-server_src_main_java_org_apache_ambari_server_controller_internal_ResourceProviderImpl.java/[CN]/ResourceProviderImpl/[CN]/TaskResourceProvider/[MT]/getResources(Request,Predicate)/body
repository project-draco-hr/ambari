{
  Set<PropertyId> requestedIds=PropertyHelper.getRequestPropertyIds(getPropertyIds(),request,predicate);
  TaskStatusRequest taskStatusRequest=getRequest(getProperties(predicate));
  LOG.info("Request to management controller " + taskStatusRequest.getRequestId() + " taskid "+ taskStatusRequest.getTaskId());
  Set<TaskStatusResponse> responses=getManagementController().getTaskStatus(Collections.singleton(taskStatusRequest));
  LOG.info("Printing size of responses " + responses.size());
  for (  TaskStatusResponse response : responses) {
    LOG.info("Printing response from management controller " + response.toString());
  }
  Set<Resource> resources=new HashSet<Resource>();
  for (  TaskStatusResponse response : responses) {
    Resource resource=new ResourceImpl(Resource.Type.Task);
    resource.setProperty(TASK_ID_PROPERTY_ID,response.getTaskId() + "");
    resource.setProperty(TASK_STAGE_ID_PROPERTY_ID,response.getStageId() + "");
    resource.setProperty(TASK_HOST_NAME_PROPERTY_ID,response.getHostName() + "");
    resource.setProperty(TASK_ROLE_PROPERTY_ID,response.getRole() + "");
    resource.setProperty(TASK_COMMAND_PROPERTY_ID,response.getCommand() + "");
    resource.setProperty(TASK_STATUS_PROPERTY_ID,response.getStatus());
    resource.setProperty(TASK_EXIT_CODE_PROPERTY_ID,response.getExitCode() + "");
    resource.setProperty(TASK_STDERR_PROPERTY_ID,response.getStderr() + "");
    resource.setProperty(TASK_STOUT_PROPERTY_ID,response.getStdout() + "");
    resource.setProperty(TASK_START_TIME_PROPERTY_ID,response.getStartTime() + "");
    resource.setProperty(TASK_ATTEMPT_CNT_PROPERTY_ID,response.getAttemptCount() + "");
    LOG.info("Creating resource " + resource.toString());
    resources.add(resource);
  }
  return resources;
}
