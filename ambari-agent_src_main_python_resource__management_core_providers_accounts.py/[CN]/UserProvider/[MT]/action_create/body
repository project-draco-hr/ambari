def action_create(self):
    if (not self.user):
        command = ['useradd', '-m']
        self.log.info(('Adding user %s' % self.resource))
    else:
        command = ['usermod']
        self.log.info(('Modifying user %s' % self.resource.username))
    options = dict(comment='-c', gid='-g', uid='-u', shell='-s', password='-p', home='-d')
    if (self.resource.system and (not self.user)):
        command.append('--system')
    if self.resource.groups:
        command += ['-G', ','.join(self.resource.groups)]
    for (option_name, option_flag) in options.items():
        option_value = getattr(self.resource, option_name)
        if (option_flag and option_value):
            command += [option_flag, str(option_value)]
    command.append(self.resource.username)
    shell.checked_call(command)
