{
  Summary summary=new Summary();
  ResultSet rs=null;
  try {
    rs=ps.executeQuery();
    if (rs.next()) {
      summary.setNumRows(SummaryFields.numRows.getInt(rs));
      summary.setJobs(getAvgData(rs,SummaryFields.avgJobs,SummaryFields.minJobs,SummaryFields.maxJobs));
      summary.setInput(getAvgData(rs,SummaryFields.avgInput,SummaryFields.minInput,SummaryFields.maxInput));
      summary.setOutput(getAvgData(rs,SummaryFields.avgOutput,SummaryFields.minOutput,SummaryFields.maxOutput));
      summary.setDuration(getAvgData(rs,SummaryFields.avgDuration,SummaryFields.minDuration,SummaryFields.maxDuration));
      Times times=new Times();
      times.setYoungest(SummaryFields.youngest.getLong(rs));
      times.setOldest(SummaryFields.oldest.getLong(rs));
      summary.setTimes(times);
    }
  }
 catch (  SQLException e) {
    throw new IOException(e);
  }
 finally {
    try {
      if (rs != null)       rs.close();
    }
 catch (    SQLException e) {
      LOG.error("Exception while closing ResultSet",e);
    }
  }
  return summary;
}
