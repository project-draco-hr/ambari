def test_hawqsegmentDatanode(self):
    ' Test that HAWQSegment gets recommended on same host group which has DATANODE'
    services = self.load_json('services-hawq-pxf-hdfs.json')
    hosts = self.load_json('hosts-3-hosts.json')
    recommendations = self.stackAdvisor.createComponentLayoutRecommendations(services, hosts)
    for hostgroup in recommendations['blueprint']['host_groups']:
        component_names = [component['name'] for component in hostgroup['components']]
        if ('DATANODE' in component_names):
            self.assertTrue(('HAWQSEGMENT' in component_names))
