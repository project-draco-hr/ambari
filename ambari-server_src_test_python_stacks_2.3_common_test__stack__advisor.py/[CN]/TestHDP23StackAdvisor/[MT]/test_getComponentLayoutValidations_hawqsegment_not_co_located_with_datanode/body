def test_getComponentLayoutValidations_hawqsegment_not_co_located_with_datanode(self):
    ' Test validation warning for HAWQ segment not colocated with DATANODE '
    services = self.load_json('services-normal-hawq-3-hosts.json')
    hosts = self.load_json('hosts-3-hosts.json')
    componentsListList = [service['components'] for service in services['services']]
    componentsList = [item for sublist in componentsListList for item in sublist]
    hawqsegmentComponent = self.__getHosts(componentsList, 'HAWQSEGMENT')
    hawqsegmentComponent['hostnames'] = ['c6401.ambari.apache.org']
    datanodeComponent = self.__getHosts(componentsList, 'DATANODE')
    datanodeComponent['hostnames'] = ['c6402.ambari.apache.org']
    validations = self.stackAdvisor.getComponentLayoutValidations(services, hosts)
    expected = {'type': 'host-component', 'level': 'WARN', 'component-name': 'HAWQSEGMENT', 'message': 'HAWQ Segment must be installed on all DataNodes. The following 2 host(s) do not satisfy the colocation recommendation: c6401.ambari.apache.org, c6402.ambari.apache.org', }
    self.assertEquals(validations[0], expected)
    datanodeComponent['hostnames'] = ['c6401.ambari.apache.org']
    validations = self.stackAdvisor.getComponentLayoutValidations(services, hosts)
    self.assertEquals(len(validations), 0)
