def test_recommendHAWQConfigurations(self):
    services = self.load_json('services-normal-hawq-3-hosts.json')
    componentsListList = [service['components'] for service in services['services']]
    componentsList = [item for sublist in componentsListList for item in sublist]
    hawqSegmentComponent = [component['StackServiceComponents'] for component in componentsList if (component['StackServiceComponents']['component_name'] == 'HAWQSEGMENT')][0]
    services['configurations']['hawq-site'] = {'properties': {'default_segment_num': '24', }, }
    configurations = {}
    clusterData = {}
    self.assertEquals(len(hawqSegmentComponent['hostnames']), 3)
    self.stackAdvisor.recommendHAWQConfigurations(configurations, clusterData, services, None)
    self.assertEquals(configurations['hawq-site']['properties']['default_segment_num'], str((3 * 6)))
    hawqSegmentComponent['hostnames'] = [('host' + str(i)) for i in range(49)]
    self.stackAdvisor.recommendHAWQConfigurations(configurations, clusterData, services, None)
    self.assertEquals(configurations['hawq-site']['properties']['default_segment_num'], str((49 * 6)))
    hawqSegmentComponent['hostnames'] = [('host' + str(i)) for i in range(50)]
    self.stackAdvisor.recommendHAWQConfigurations(configurations, clusterData, services, None)
    self.assertEquals(configurations['hawq-site']['properties']['default_segment_num'], str((50 * 4)))
    configurations = {}
    hawqSegmentComponent['hostnames'] = []
    self.stackAdvisor.recommendHAWQConfigurations(configurations, clusterData, services, None)
    self.assertEquals(configurations, {'hawq-site': {'properties': {}, }, })
