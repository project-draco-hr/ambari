def test_createComponentLayoutRecommendations_pxf_co_locate_with_namenode_or_datanode(self):
    ' Test that PXF gets recommended on same host group which has NAMENODE or DATANODE'
    services = self.load_json('services-hawq-pxf-hdfs.json')
    hosts = self.load_json('hosts-3-hosts.json')
    recommendations = self.stackAdvisor.createComponentLayoutRecommendations(services, hosts)
    for hostgroup in recommendations['blueprint']['host_groups']:
        component_names = [component['name'] for component in hostgroup['components']]
        if (('NAMENODE' in component_names) or ('DATANODE' in component_names)):
            self.assertTrue(('PXF' in component_names))
        if (('NAMENODE' not in component_names) and ('DATANODE' not in component_names)):
            self.assertTrue(('PXF' not in component_names))
