{
  try {
    String basePath=getHiveMetaStoreLocation();
    if (!basePath.endsWith("/")) {
      basePath=basePath + "/";
    }
    if (databaseName != null && !databaseName.equals(HIVE_DEFAULT_DB)) {
      basePath=basePath + databaseName + ".db/";
    }
    String fullPath=basePath + tempTableName + "/"+ tempTableName+ ".csv";
    LOG.info("Uploading file into : {}",fullPath);
    uploadFile(fullPath,new ReaderInputStream(reader));
    return fullPath;
  }
 catch (  Exception e) {
    throw new ServiceFormattedException(e.getMessage(),e);
  }
}
