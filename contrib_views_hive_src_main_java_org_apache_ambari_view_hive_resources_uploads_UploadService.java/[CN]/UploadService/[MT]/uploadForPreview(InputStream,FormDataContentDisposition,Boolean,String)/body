{
  try {
    PreviewData pd=generatePreview(isFirstRowHeader,inputFileType,uploadedInputStream);
    return createPreviewResponse(pd,isFirstRowHeader,getBasename(fileDetail.getFileName()));
  }
 catch (  Exception e) {
    LOG.error("Exception occurred while generating preview for local file",e);
    throw new ServiceFormattedException(e.getMessage(),e);
  }
}
