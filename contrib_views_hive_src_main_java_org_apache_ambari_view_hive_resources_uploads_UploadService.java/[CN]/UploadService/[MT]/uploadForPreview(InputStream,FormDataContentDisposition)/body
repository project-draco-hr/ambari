{
  ParseOptions parseOptions=new ParseOptions();
  parseOptions.setOption(ParseOptions.OPTIONS_FILE_TYPE,ParseOptions.FILE_TYPE_CSV);
  parseOptions.setOption(ParseOptions.OPTIONS_HEADER,ParseOptions.HEADER_FIRST_RECORD);
  try {
    DataParser dataParser=new DataParser(new InputStreamReader(uploadedInputStream),parseOptions);
    dataParser.parsePreview();
    Map<String,Object> retData=new HashMap<String,Object>();
    retData.put("header",dataParser.getHeader());
    retData.put("rows",dataParser.getPreviewRows());
    retData.put("isFirstRowHeader",true);
    JSONObject jsonObject=new JSONObject(retData);
    return Response.ok(jsonObject).build();
  }
 catch (  IOException e) {
    throw new ServiceFormattedException(e.getMessage(),e);
  }
}
