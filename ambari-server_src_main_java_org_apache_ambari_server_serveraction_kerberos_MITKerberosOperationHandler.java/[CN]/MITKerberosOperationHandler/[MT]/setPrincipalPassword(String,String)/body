{
  if (!isOpen()) {
    throw new KerberosOperationException("This operation handler has not been opened");
  }
  if (StringUtils.isEmpty(principal)) {
    throw new KerberosOperationException("Failed to set password - no principal specified");
  }
 else   if (StringUtils.isEmpty(password)) {
    throw new KerberosOperationException("Failed to set password - no password specified");
  }
 else {
    invokeKAdmin(String.format("change_password -pw \"%s\" %s",password,principal));
    return getKeyNumber(principal);
  }
}
