{
  try {
    if (!hdfsApiMap.containsKey(context.getInstanceName())) {
synchronized (lock) {
        if (!hdfsApiMap.containsKey(context.getInstanceName())) {
          LOG.debug("Creating HDFSApi instance for Viewname: {}, Instance Name: {}",context.getViewName(),context.getInstanceName());
          HdfsApi api=HdfsUtil.connectToHDFSApi(context);
          hdfsApiMap.put(context.getInstanceName(),api);
          return Optional.of(api);
        }
      }
    }
    return Optional.of(hdfsApiMap.get(context.getInstanceName()));
  }
 catch (  HdfsApiException e) {
    LOG.error("Cannot get the HDFS API",e);
    return Optional.absent();
  }
}
