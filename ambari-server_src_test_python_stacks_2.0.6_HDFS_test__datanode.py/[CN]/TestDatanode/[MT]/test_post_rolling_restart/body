@patch('time.sleep')
@patch('subprocess.Popen')
def test_post_rolling_restart(self, process_mock, time_mock):
    process_output = '\n      Live datanodes (2):\n\n      Name: 192.168.64.102:50010 (c6401.ambari.apache.org)\n      Hostname: c6401.ambari.apache.org\n      Decommission Status : Normal\n      Configured Capacity: 524208947200 (488.21 GB)\n      DFS Used: 193069056 (184.13 MB)\n      Non DFS Used: 29264986112 (27.26 GB)\n      DFS Remaining: 494750892032 (460.77 GB)\n      DFS Used%: 0.04%\n      DFS Remaining%: 94.38%\n      Configured Cache Capacity: 0 (0 B)\n      Cache Used: 0 (0 B)\n      Cache Remaining: 0 (0 B)\n      Cache Used%: 100.00%\n      Cache Remaining%: 0.00%\n      Xceivers: 2\n      Last contact: Fri Dec 12 20:47:21 UTC 2014\n    '
    process = MagicMock()
    process.communicate.return_value = [process_output]
    process.returncode = 0
    process_mock.return_value = process
    self.executeScript('2.0.6/services/HDFS/package/scripts/datanode.py', classname='DataNode', command='post_rolling_restart', config_file='default.json')
    self.assertTrue(process_mock.called)
    self.assertEqual(process_mock.call_count, 1)
