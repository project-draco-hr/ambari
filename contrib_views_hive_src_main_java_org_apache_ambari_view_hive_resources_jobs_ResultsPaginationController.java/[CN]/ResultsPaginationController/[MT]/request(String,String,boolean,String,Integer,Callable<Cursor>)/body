{
  if (searchId == null)   searchId=DEFAULT_SEARCH_ID;
  key=key + "?" + searchId;
  if (!canExpire)   key="$" + key;
  if (fromBeginning != null && fromBeginning.equals("true") && getResultsCache().containsKey(key))   getResultsCache().remove(key);
  Cursor resultSet=getResultsSet(key,makeResultsSet);
  if (count == null)   count=DEFAULT_FETCH_COUNT;
  ResultsResponse resultsResponse=new ResultsResponse();
  resultsResponse.setSchema(resultSet.getSchema());
  ArrayList<Object[]> rows=new ArrayList<Object[]>(count);
  int read=resultSet.readRaw(rows,count);
  resultsResponse.setRows(rows);
  resultsResponse.setReadCount(read);
  resultsResponse.setHasNext(resultSet.hasNext());
  resultsResponse.setOffset(resultSet.getOffset());
  resultsResponse.setHasResults(true);
  return Response.ok(resultsResponse);
}
