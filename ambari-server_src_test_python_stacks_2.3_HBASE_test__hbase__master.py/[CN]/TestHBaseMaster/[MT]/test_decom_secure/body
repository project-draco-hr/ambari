def test_decom_secure(self):
    self.executeScript((self.COMMON_SERVICES_PACKAGE_DIR + '/scripts/hbase_master.py'), classname='HbaseMaster', command='decommission', config_file='hbase_secure.json', hdp_stack_version=self.STACK_VERSION, target=RMFTestCase.TARGET_COMMON_SERVICES)
    self.assertResourceCalled('File', '/usr/hdp/current/hbase-regionserver/bin/draining_servers.rb', content=StaticFile('draining_servers.rb'), mode=493)
    self.assertResourceCalled('Execute', '/usr/bin/kinit -kt /etc/security/keytabs/hbase.headless.keytab hbase@EXAMPLE.COM; /usr/hdp/current/hbase-regionserver/bin/hbase --config /etc/hbase/conf org.jruby.Main /usr/hdp/current/hbase-regionserver/bin/draining_servers.rb add host1', logoutput=True, user='hbase')
    self.assertResourceCalled('Execute', '/usr/bin/kinit -kt /etc/security/keytabs/hbase.headless.keytab hbase@EXAMPLE.COM; /usr/hdp/current/hbase-regionserver/bin/hbase --config /etc/hbase/conf org.jruby.Main /usr/hdp/current/hbase-regionserver/bin/region_mover.rb unload host1', logoutput=True, user='hbase')
    self.assertNoMoreResources()
