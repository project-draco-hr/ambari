{
  LOG.info("Preparing Storm Metrics Sink");
  try {
    hostname=InetAddress.getLocalHost().getHostName();
  }
 catch (  UnknownHostException e) {
    LOG.error("Could not identify hostname.");
    throw new RuntimeException("Could not identify hostname.",e);
  }
  Configuration configuration=new Configuration("/storm-metrics2.properties");
  timeoutSeconds=Integer.parseInt(configuration.getProperty(METRICS_POST_TIMEOUT_SECONDS,String.valueOf(DEFAULT_POST_TIMEOUT_SECONDS)));
  int maxRowCacheSize=Integer.parseInt(configuration.getProperty(MAX_METRIC_ROW_CACHE_SIZE,String.valueOf(MAX_RECS_PER_NAME_DEFAULT)));
  int metricsSendInterval=Integer.parseInt(configuration.getProperty(METRICS_SEND_INTERVAL,String.valueOf(MAX_EVICTION_TIME_MILLIS)));
  metricsCache=new TimelineMetricsCache(maxRowCacheSize,metricsSendInterval);
  collectorUri="http://" + configuration.getProperty(COLLECTOR_HOST_PROPERTY) + ":"+ configuration.getProperty(COLLECTOR_PORT_PROPERTY)+ "/ws/v1/timeline/metrics";
}
