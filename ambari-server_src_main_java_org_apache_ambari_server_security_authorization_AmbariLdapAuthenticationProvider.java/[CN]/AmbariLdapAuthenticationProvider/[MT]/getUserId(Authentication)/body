{
  String userName=authentication.getName();
  UserEntity userEntity=userDAO.findLdapUserByName(userName);
  if (userEntity == null || !StringUtils.equals(userEntity.getUserName(),userName)) {
    LOG.info("user not found ");
    throw new UsernameNotFoundException("Username " + userName + " not found");
  }
  if (!userEntity.getActive()) {
    LOG.debug("User account is disabled");
    throw new DisabledException("Username " + userName + " is disabled");
  }
  return userEntity.getUserId();
}
