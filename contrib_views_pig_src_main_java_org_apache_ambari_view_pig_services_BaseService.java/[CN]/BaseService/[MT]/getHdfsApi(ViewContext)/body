{
  if (hdfsApi == null) {
    Thread.currentThread().setContextClassLoader(null);
    String userName=context.getUsername();
    String defaultFS=context.getProperties().get("dataworker.defaultFs");
    if (defaultFS == null) {
      String message="dataworker.defaultFs is not configured!";
      LOG.error(message);
      throw new WebServiceException(message);
    }
    try {
      hdfsApi=new HdfsApi(defaultFS,userName);
      LOG.info("HdfsApi connected OK");
    }
 catch (    IOException e) {
      String message="HdfsApi IO error: " + e.getMessage();
      LOG.error(message);
      throw new WebServiceException(message,e);
    }
catch (    InterruptedException e) {
      String message="HdfsApi Interrupted error: " + e.getMessage();
      LOG.error(message);
      throw new WebServiceException(message,e);
    }
  }
  return hdfsApi;
}
