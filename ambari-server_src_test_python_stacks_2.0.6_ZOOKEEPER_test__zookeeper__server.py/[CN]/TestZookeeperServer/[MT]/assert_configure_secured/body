def assert_configure_secured(self):
    self.assertResourceCalled('Directory', '/etc/zookeeper/conf', owner='zookeeper', group='hadoop', recursive=True)
    self.assertResourceCalled('File', '/etc/zookeeper/conf/zoo.cfg', owner='zookeeper', content=Template('zoo.cfg.j2'), group='hadoop')
    self.assertResourceCalled('File', '/etc/zookeeper/conf/zookeeper-env.sh', owner='zookeeper', content=Template('zookeeper-env.sh.j2'), group='hadoop')
    self.assertResourceCalled('File', '/etc/zookeeper/conf/configuration.xsl', owner='zookeeper', content=Template('configuration.xsl.j2'), group='hadoop')
    self.assertResourceCalled('Directory', '/var/run/zookeeper', owner='zookeeper', group='hadoop', recursive=True)
    self.assertResourceCalled('Directory', '/var/log/zookeeper', owner='zookeeper', group='hadoop', recursive=True)
    self.assertResourceCalled('Directory', '/hadoop/zookeeper', owner='zookeeper', group='hadoop', recursive=True)
    self.assertResourceCalled('File', '/hadoop/zookeeper/myid', content='1', mode=420)
    self.assertResourceCalled('File', '/etc/zookeeper/conf/zookeeper_jaas.conf', owner='zookeeper', content=Template('zookeeper_jaas.conf.j2'), group='hadoop')
    self.assertResourceCalled('File', '/etc/zookeeper/conf/zookeeper_client_jaas.conf', owner='zookeeper', content=Template('zookeeper_client_jaas.conf.j2'), group='hadoop')
    self.assertResourceCalled('File', '/etc/zookeeper/conf/zoo_sample.cfg', owner='zookeeper', group='hadoop')
