{
  injector=Guice.createInjector(Modules.override(new InMemoryDefaultTestModule()).with(new MockModule()));
  injector.getInstance(GuiceJpaInitializer.class);
  injector.getInstance(AlertServiceStateListener.class);
  injector.getInstance(AlertStateChangedListener.class);
  dispatchDao=injector.getInstance(AlertDispatchDAO.class);
  eventPublisher=injector.getInstance(AlertEventPublisher.class);
  EventBus synchronizedBus=new EventBus();
  synchronizedBus.register(injector.getInstance(AlertStateChangedListener.class));
  Field field=AlertEventPublisher.class.getDeclaredField("m_eventBus");
  field.setAccessible(true);
  field.set(eventPublisher,synchronizedBus);
}
