def read_file(filename, encoding=None):
    tmpf = tempfile.NamedTemporaryFile()
    shell.checked_call(['cp', '-f', filename, tmpf.name], sudo=True)
    with tmpf:
        with open(tmpf.name, 'rb') as fp:
            content = fp.read()
    content = (content.decode(encoding) if encoding else content)
    return content
