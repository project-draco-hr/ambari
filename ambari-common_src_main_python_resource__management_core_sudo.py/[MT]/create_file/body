def create_file(filename, content, encoding='utf-8'):
    '\n  if content is None, create empty file\n  '
    tmpf = tempfile.NamedTemporaryFile()
    if content:
        content = (content.encode(encoding) if encoding else content)
        with open(tmpf.name, 'wb') as fp:
            fp.write(content)
    with tmpf:
        shell.checked_call(['cp', '-f', tmpf.name, filename], sudo=True)
    chmod(filename, 420)
