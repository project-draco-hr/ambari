def _create_file(filename, content, withSudo, encoding=None):
    '\n  if content is None, create empty file\n  '
    content = (content if content else '')
    content = (content.encode(encoding) if encoding else content)
    tmpf_name = (((((tempfile.gettempdir() + os.sep) + tempfile.template) + str(time.time())) + '_') + str(random.randint(0, 1000)))
    try:
        with open(tmpf_name, 'wb') as fp:
            fp.write(content)
        shell.checked_call(['cp', '-f', tmpf_name, filename], sudo=withSudo)
    finally:
        os.unlink(tmpf_name)
