{
  final ResourceProvider provider=injector.getInstance(ResourceProviderFactory.class).getRepositoryVersionResourceProvider();
  final Set<Map<String,Object>> propertySet=new LinkedHashSet<Map<String,Object>>();
  final Map<String,Object> properties=new LinkedHashMap<String,Object>();
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_DISPLAY_NAME_PROPERTY_ID,"name");
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_REPOSITORIES_PROPERTY_ID,jsonStructureRedhat6);
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_STACK_PROPERTY_ID,"HDP-1.1");
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_UPGRADE_PACK_PROPERTY_ID,"pack1");
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_VERSION_PROPERTY_ID,"1.1.1.1");
  propertySet.add(properties);
  final Request getRequest=PropertyHelper.getReadRequest(RepositoryVersionResourceProvider.REPOSITORY_VERSION_DISPLAY_NAME_PROPERTY_ID,RepositoryVersionResourceProvider.REPOSITORY_VERSION_REPOSITORIES_PROPERTY_ID,RepositoryVersionResourceProvider.REPOSITORY_VERSION_UPGRADE_PACK_PROPERTY_ID);
  Assert.assertEquals(0,provider.getResources(getRequest,null).size());
  final Request createRequest=PropertyHelper.getCreateRequest(propertySet,null);
  provider.createResources(createRequest);
  Assert.assertEquals(1,provider.getResources(getRequest,null).size());
  Assert.assertEquals("name",provider.getResources(getRequest,null).iterator().next().getPropertyValue(RepositoryVersionResourceProvider.REPOSITORY_VERSION_DISPLAY_NAME_PROPERTY_ID));
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_ID_PROPERTY_ID,"1");
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_DISPLAY_NAME_PROPERTY_ID,"name2");
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_REPOSITORIES_PROPERTY_ID,jsonStructureRedhat7);
  properties.put(RepositoryVersionResourceProvider.REPOSITORY_VERSION_UPGRADE_PACK_PROPERTY_ID,"pack2");
  final Request updateRequest=PropertyHelper.getUpdateRequest(properties,null);
  provider.updateResources(updateRequest,null);
  Assert.assertEquals("name2",provider.getResources(getRequest,null).iterator().next().getPropertyValue(RepositoryVersionResourceProvider.REPOSITORY_VERSION_DISPLAY_NAME_PROPERTY_ID));
  Assert.assertEquals("[{\"os\":\"redhat7\",\"baseurls\":[{\"id\":\"HDP-2.2.0.1-885\",\"type\":\"HDP\",\"baseurl\":\"http://host1/hdp\"},{\"id\":\"HDP-UTILS-1.0.0.20\",\"type\":\"HDP-UTILS\",\"baseurl\":\"http://host1/hdp-utils\"}]}]",new Gson().toJson(provider.getResources(getRequest,null).iterator().next().getPropertyValue(RepositoryVersionResourceProvider.REPOSITORY_VERSION_REPOSITORIES_PROPERTY_ID)));
  Assert.assertEquals("pack2",provider.getResources(getRequest,null).iterator().next().getPropertyValue(RepositoryVersionResourceProvider.REPOSITORY_VERSION_UPGRADE_PACK_PROPERTY_ID));
}
