{
  Set<Map<String,Object>> propertySet=request.getProperties();
  if (propertySet == null || propertySet.isEmpty()) {
    LOG.warn("Received a create host request with no associated property sets");
    return null;
  }
  Set<String> addedHosts=new HashSet<String>();
  String clusterName=null;
  for (  Map<String,Object> properties : propertySet) {
    clusterName=(String)properties.get(HOST_CLUSTER_NAME_PROPERTY_ID);
    String bpName=(String)properties.get(BLUEPRINT_PROPERTY_ID);
    String hgName=(String)properties.get(HOSTGROUP_PROPERTY_ID);
    String hostname=getHostNameFromProperties(properties);
    addedHosts.add(hostname);
    String configGroupName=getConfigurationGroupName(bpName,hgName);
    BlueprintEntity blueprint=getExistingBlueprint(bpName);
    Stack stack=parseStack(blueprint);
    Map<String,HostGroupImpl> blueprintHostGroups=parseBlueprintHostGroups(blueprint,stack);
    addHostToHostgroup(hgName,hostname,blueprintHostGroups);
    createHostAndComponentResources(blueprintHostGroups,clusterName,this);
    addHostToExistingConfigGroups(configGroupName,clusterName,hostname);
  }
  return ((HostComponentResourceProvider)getResourceProvider(Resource.Type.HostComponent)).installAndStart(clusterName,addedHosts);
}
