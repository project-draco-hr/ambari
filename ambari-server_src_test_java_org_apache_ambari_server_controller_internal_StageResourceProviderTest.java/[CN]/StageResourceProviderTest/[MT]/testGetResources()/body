{
  StageResourceProvider provider=new StageResourceProvider();
  Request request=createNiceMock(Request.class);
  Predicate predicate=createNiceMock(Predicate.class);
  List<StageEntity> entities=getStageEntities();
  expect(dao.findAll(request,predicate)).andReturn(entities);
  replay(dao,request,predicate);
  Set<Resource> resources=provider.getResources(request,predicate);
  Assert.assertEquals(1,resources.size());
  Resource resource=resources.iterator().next();
  Assert.assertEquals(100.0,resource.getPropertyValue(StageResourceProvider.STAGE_PROGRESS_PERCENT));
  Assert.assertEquals("COMPLETED",resource.getPropertyValue(StageResourceProvider.STAGE_STATUS));
  Assert.assertEquals(1000L,resource.getPropertyValue(StageResourceProvider.STAGE_START_TIME));
  Assert.assertEquals(2500L,resource.getPropertyValue(StageResourceProvider.STAGE_END_TIME));
  verify(dao);
}
