{
  AmbariManagementController ambariManagementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=ambariManagementController.getClusters();
  if (clusters != null) {
    Map<String,Cluster> clusterMap=clusters.getClusters();
    if (clusterMap != null && !clusterMap.isEmpty()) {
      for (      final Cluster cluster : clusterMap.values()) {
        if (cluster.getDesiredConfigByType("hive-env") != null) {
          Map<String,String> hiveProps=new HashMap<String,String>();
          if (!cluster.getDesiredConfigByType("hive-env").getProperties().containsKey("hive.client.heapsize")) {
            hiveProps.put("hive.client.heapsize","512m");
          }
          if (!cluster.getDesiredConfigByType("hive-env").getProperties().containsKey("hive.metastore.heapsize")) {
            hiveProps.put("hive.metastore.heapsize","1024m");
          }
          updateConfigurationPropertiesForCluster(cluster,"hive-env",hiveProps,false,true);
        }
      }
    }
  }
}
