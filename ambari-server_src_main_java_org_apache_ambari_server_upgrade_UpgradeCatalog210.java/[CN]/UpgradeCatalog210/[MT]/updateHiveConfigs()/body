{
  AmbariManagementController ambariManagementController=injector.getInstance(AmbariManagementController.class);
  Clusters clusters=ambariManagementController.getClusters();
  if (clusters != null) {
    Map<String,Cluster> clusterMap=clusters.getClusters();
    if (clusterMap != null && !clusterMap.isEmpty()) {
      for (      final Cluster cluster : clusterMap.values()) {
        String content=null;
        if (cluster.getDesiredConfigByType("hive-env") != null) {
          Map<String,String> hiveProps=new HashMap<String,String>();
          content=cluster.getDesiredConfigByType("hive-env").getProperties().get("content");
          if (content != null) {
            content=updateHiveEnvContent(content);
            hiveProps.put("content",content);
          }
          if (!cluster.getDesiredConfigByType("hive-env").getProperties().containsKey("hive.client.heapsize")) {
            hiveProps.put("hive.client.heapsize","512m");
          }
          if (!cluster.getDesiredConfigByType("hive-env").getProperties().containsKey("hive.metastore.heapsize")) {
            hiveProps.put("hive.metastore.heapsize","1024m");
          }
          updateConfigurationPropertiesForCluster(cluster,"hive-env",hiveProps,true,true);
        }
      }
    }
  }
}
