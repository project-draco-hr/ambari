{
  TOperationHandle operationHandle=operationHandleResourceManager.getHandleForJob(viewJob);
  String hexGuid=Hex.encodeHexString(operationHandle.getOperationId().getGuid());
  HiveQueryId atsHiveQuery=ats.getHiveQueryIdByOperationId(hexStringToUrlSafeBase64(hexGuid));
  TezDagId atsTezDag;
  if (atsHiveQuery.dagNames != null && atsHiveQuery.dagNames.size() > 0) {
    String dagName=atsHiveQuery.dagNames.get(0);
    atsTezDag=ats.getTezDAGByName(dagName);
  }
 else {
    atsTezDag=new TezDagId();
  }
  saveJobInfoIfNeeded(atsHiveQuery,atsTezDag,viewJob);
  return mergeAtsJobWithViewJob(atsHiveQuery,atsTezDag,viewJob);
}
