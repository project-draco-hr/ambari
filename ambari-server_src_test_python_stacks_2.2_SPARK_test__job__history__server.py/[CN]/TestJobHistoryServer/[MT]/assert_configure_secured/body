def assert_configure_secured(self):
    self.assertResourceCalled('Directory', '/var/run/spark', owner='spark', group='hadoop', recursive=True)
    self.assertResourceCalled('Directory', '/var/log/spark', owner='spark', group='hadoop', recursive=True)
    self.assertResourceCalled('HdfsDirectory', '/user/spark', security_enabled=True, keytab=UnknownConfigurationMock(), conf_dir='/usr/hdp/current/hadoop-client/conf', hdfs_user=UnknownConfigurationMock(), kinit_path_local='/usr/bin/kinit', mode=509, owner='spark', bin_dir='/usr/hdp/current/hadoop-client/bin', action=['create'])
    self.assertResourceCalled('PropertiesFile', '/usr/hdp/current/spark-client/conf/spark-defaults.conf', key_value_delimiter=' ', properties=self.getConfig()['configurations']['spark-defaults'])
    self.assertResourceCalled('File', '/usr/hdp/current/spark-client/conf/spark-env.sh', content=InlineTemplate(self.getConfig()['configurations']['spark-env']['content']), owner='spark', group='spark')
    self.assertResourceCalled('File', '/usr/hdp/current/spark-client/conf/log4j.properties', content='\n# Set everything to be logged to the console\nlog4j.rootCategory=INFO, console\nlog4j.appender.console=org.apache.log4j.ConsoleAppender\nlog4j.appender.console.target=System.err\nlog4j.appender.console.layout=org.apache.log4j.PatternLayout\nlog4j.appender.console.layout.ConversionPattern=%d{yy/MM/dd HH:mm:ss} %p %c{1}: %m%n\n\n# Settings to quiet third party logs that are too verbose\nlog4j.logger.org.eclipse.jetty=WARN\nlog4j.logger.org.eclipse.jetty.util.component.AbstractLifeCycle=ERROR\nlog4j.logger.org.apache.spark.repl.SparkIMain$exprTyper=INFO\nlog4j.logger.org.apache.spark.repl.SparkILoop$SparkILoopInterpreter=INFO', owner='spark', group='spark')
    self.assertResourceCalled('File', '/usr/hdp/current/spark-client/conf/metrics.properties', content=InlineTemplate(self.getConfig()['configurations']['spark-metrics-properties']['content']), owner='spark', group='spark')
    self.assertResourceCalled('File', '/usr/hdp/current/spark-client/conf/java-opts', content='  -Dhdp.version=2.3.0.0-1597', owner='spark', group='spark')
