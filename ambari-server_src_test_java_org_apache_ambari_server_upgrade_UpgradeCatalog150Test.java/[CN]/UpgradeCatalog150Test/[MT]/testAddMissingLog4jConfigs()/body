{
  ClusterDAO clusterDAO=injector.getInstance(ClusterDAO.class);
  ClusterEntity clusterEntity=createCluster();
  ClusterServiceEntity clusterServiceEntityMR=addService(clusterEntity,"HDFS");
  Long clusterId=clusterEntity.getClusterId();
  ClusterConfigEntityPK configEntityPK=new ClusterConfigEntityPK();
  configEntityPK.setClusterId(clusterId);
  configEntityPK.setType("hdfs-log4j");
  configEntityPK.setTag("version1");
  ClusterConfigEntity configEntity=clusterDAO.findConfig(configEntityPK);
  Assert.assertNull(configEntity);
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      Assert.fail();
    }
  }
  UpgradeCatalog150 upgradeCatalog150=injector.getInstance(UpgradeCatalog150.class);
  upgradeCatalog150.addMissingLog4jConfigs();
  configEntity=clusterDAO.findConfig(configEntityPK);
  Assert.assertNotNull(configEntity);
  clusterEntity=clusterDAO.findById(1L);
  boolean failFlag=true;
  for (  ClusterConfigMappingEntity ccme : clusterEntity.getConfigMappingEntities()) {
    if ("hdfs-log4j".equals(ccme.getType())) {
      failFlag=false;
    }
  }
  Assert.assertFalse(failFlag);
}
