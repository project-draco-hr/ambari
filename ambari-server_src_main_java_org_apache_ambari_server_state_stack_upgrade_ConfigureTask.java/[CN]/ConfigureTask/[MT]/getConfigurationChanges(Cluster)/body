{
  Map<String,String> configParameters=new HashMap<String,String>();
  if (null != conditions && !conditions.isEmpty()) {
    for (    Condition condition : conditions) {
      String conditionConfigType=condition.conditionConfigType;
      String conditionKey=condition.conditionKey;
      String conditionValue=condition.conditionValue;
      configParameters.put(PARAMETER_CONFIG_TYPE,condition.configType);
      String checkValue=getDesiredConfigurationValue(cluster,conditionConfigType,conditionKey);
      if (conditionValue.equals(checkValue)) {
        List<ConfigurationKeyValue> configurations=new ArrayList<ConfigurationKeyValue>(1);
        ConfigurationKeyValue keyValue=new ConfigurationKeyValue();
        keyValue.key=condition.key;
        keyValue.value=condition.value;
        configurations.add(keyValue);
        configParameters.put(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS,m_gson.toJson(configurations));
        return configParameters;
      }
    }
  }
  if (null != configType) {
    configParameters.put(PARAMETER_CONFIG_TYPE,configType);
  }
  if (null != keyValuePairs && !keyValuePairs.isEmpty()) {
    configParameters.put(ConfigureTask.PARAMETER_KEY_VALUE_PAIRS,m_gson.toJson(keyValuePairs));
  }
  if (null != transfers && !transfers.isEmpty()) {
    List<Transfer> allowedTransfers=new ArrayList<Transfer>();
    for (    Transfer transfer : transfers) {
      if (transfer.operation == TransferOperation.DELETE) {
        if (StringUtils.isNotBlank(transfer.ifKey) && StringUtils.isNotBlank(transfer.ifType) && transfer.ifValue != null) {
          String ifConfigType=transfer.ifType;
          String ifKey=transfer.ifKey;
          String ifValue=transfer.ifValue;
          String checkValue=getDesiredConfigurationValue(cluster,ifConfigType,ifKey);
          if (!ifValue.toLowerCase().equals(StringUtils.lowerCase(checkValue))) {
            LOG.info("Skipping property delete for {}/{} as the value {} for {}/{} is not equal to {}",this.getConfigType(),transfer.deleteKey,checkValue,ifConfigType,ifKey,ifValue);
            continue;
          }
        }
      }
      allowedTransfers.add(transfer);
    }
    configParameters.put(ConfigureTask.PARAMETER_TRANSFERS,m_gson.toJson(allowedTransfers));
  }
  if (null != replacements && !replacements.isEmpty()) {
    configParameters.put(ConfigureTask.PARAMETER_REPLACEMENTS,m_gson.toJson(replacements));
  }
  return configParameters;
}
