{
  String GET_CONFIGS_SELECTED_MORE_THAN_ONCE_QUERY="select c.cluster_name,type_name from clusterconfigmapping ccm " + "join clusters c on ccm.cluster_id=c.cluster_id " + "group by c.cluster_name,type_name "+ "having sum(selected) > 1";
  Multimap<String,String> configsSelectedMoreThanOnce=HashMultimap.create();
  ResultSet rs=null;
  try {
    Statement statement=connection.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);
    rs=statement.executeQuery(GET_CONFIGS_SELECTED_MORE_THAN_ONCE_QUERY);
    if (rs != null) {
      while (rs.next()) {
        configsSelectedMoreThanOnce.put(rs.getString("cluster_name"),rs.getString("type_name"));
      }
    }
    for (    String clusterName : configsSelectedMoreThanOnce.keySet()) {
      LOG.error(String.format("You have config(s), in cluster %s, that is(are) selected more than once in clusterconfigmapping: %s",clusterName,StringUtils.join(configsSelectedMoreThanOnce.get(clusterName),",")));
      errorAvailable=true;
    }
  }
 catch (  SQLException e) {
    LOG.error("Exception occurred during check for config selected more than ones procedure: ",e);
  }
 finally {
    if (rs != null) {
      try {
        rs.close();
      }
 catch (      SQLException e) {
        LOG.error("Exception occurred during result set closing procedure: ",e);
      }
    }
  }
}
