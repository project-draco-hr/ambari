{
  if (actionRequest.getCommandName().contains("SERVICE_CHECK")) {
    addServiceCheckAction(actionRequest,stage,hostsMap,hostLevelParams);
  }
 else   if (actionRequest.getCommandName().equals("DECOMMISSION_DATANODE")) {
    addDecommissionDatanodeAction(actionRequest,stage,hostLevelParams);
  }
 else   if (isValidCustomCommand(actionRequest)) {
    addCustomcommandAction(actionRequest,stage,hostsMap,hostLevelParams);
  }
 else {
    throw new AmbariException("Unsupported action " + actionRequest.getCommandName());
  }
}
