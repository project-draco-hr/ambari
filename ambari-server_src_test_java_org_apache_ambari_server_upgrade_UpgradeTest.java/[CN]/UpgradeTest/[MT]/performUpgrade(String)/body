{
  Injector injector=Guice.createInjector(new SchemaUpgradeHelper.UpgradeHelperModule(properties));
  SchemaUpgradeHelper schemaUpgradeHelper=injector.getInstance(SchemaUpgradeHelper.class);
  LOG.info("Upgrading schema to target version = " + targetVersion);
  UpgradeCatalog targetUpgradeCatalog=AbstractUpgradeCatalog.getUpgradeCatalog(targetVersion);
  LOG.debug("Target upgrade catalog. " + targetUpgradeCatalog);
  String sourceVersion=schemaUpgradeHelper.readSourceVersion();
  LOG.info("Upgrading schema from source version = " + sourceVersion);
  List<UpgradeCatalog> upgradeCatalogs=schemaUpgradeHelper.getUpgradePath(sourceVersion,targetVersion);
  schemaUpgradeHelper.executeUpgrade(upgradeCatalogs);
  schemaUpgradeHelper.startPersistenceService();
  schemaUpgradeHelper.executeDMLUpdates(upgradeCatalogs);
  LOG.info("Upgrade successful.");
  schemaUpgradeHelper.stopPersistenceService();
}
