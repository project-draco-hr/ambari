{
  String rmHost=null;
  JSONObject rmData=proxy.request(String.format(rmHostUrl,baseUrl)).get().asJSON();
  JSONArray components=(JSONArray)rmData.get("host_components");
  for (  Object component : components) {
    JSONObject roles=(JSONObject)((JSONObject)component).get("HostRoles");
    if (roles.get("component_name").equals("RESOURCEMANAGER")) {
      rmHost=(String)roles.get("host_name");
      break;
    }
  }
  if (rmHost == null)   throw new ServiceFormattedException("Can't retrieve Resource Manager Host");
  return rmHost;
}
