{
  if ((updates != null) && !updates.isEmpty()) {
    if (configurations == null) {
      configurations=new HashMap<String,Map<String,String>>();
    }
    for (    Map.Entry<String,KerberosConfigurationDescriptor> entry : updates.entrySet()) {
      String type=entry.getKey();
      KerberosConfigurationDescriptor configurationDescriptor=entry.getValue();
      if (configurationDescriptor != null) {
        Map<String,String> updatedProperties=configurationDescriptor.getProperties();
        if (updatedProperties != null) {
          Map<String,String> existingProperties=configurations.get(type);
          if (existingProperties == null) {
            existingProperties=new HashMap<String,String>();
            configurations.put(type,existingProperties);
          }
          for (          Map.Entry<String,String> property : updatedProperties.entrySet()) {
            existingProperties.put(property.getKey(),KerberosDescriptor.replaceVariables(property.getValue(),replacements));
          }
        }
      }
    }
  }
  return configurations;
}
