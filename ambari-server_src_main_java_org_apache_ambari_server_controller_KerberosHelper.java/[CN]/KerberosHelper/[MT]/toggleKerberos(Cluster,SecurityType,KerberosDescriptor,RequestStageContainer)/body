{
  KerberosDetails kerberosDetails=getKerberosDetails(cluster);
  kerberosDetails.setSecurityType(securityType);
  if (kerberosDescriptor == null) {
    kerberosDescriptor=getClusterDescriptor(cluster);
  }
  if (securityType == SecurityType.KERBEROS) {
    LOG.info("Configuring Kerberos for realm {} on cluster, {}",kerberosDetails.getDefaultRealm(),cluster.getClusterName());
    requestStageContainer=handle(cluster,kerberosDescriptor,kerberosDetails,null,null,requestStageContainer,enableKerberosHandler);
  }
 else   if (securityType == SecurityType.NONE) {
    LOG.info("Disabling Kerberos from cluster, {}",cluster.getClusterName());
    requestStageContainer=handle(cluster,kerberosDescriptor,kerberosDetails,null,null,requestStageContainer,disableKerberosHandler);
  }
 else {
    throw new AmbariException(String.format("Unexpected security type value: %s",securityType.name()));
  }
  return requestStageContainer;
}
