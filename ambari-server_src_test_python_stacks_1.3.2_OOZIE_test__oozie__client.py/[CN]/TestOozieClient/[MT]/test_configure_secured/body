def test_configure_secured(self):
    self.executeScript('1.3.2/services/OOZIE/package/scripts/oozie_client.py', classname='OozieClient', command='configure', config_file='secured.json')
    self.assertResourceCalled('XmlConfig', 'oozie-site.xml', owner='oozie', group='hadoop', mode=436, conf_dir='/etc/oozie/conf', configurations=self.getConfig()['configurations']['oozie-site'])
    self.assertResourceCalled('Directory', '/etc/oozie/conf', owner='oozie', group='hadoop')
    self.assertResourceCalled('TemplateConfig', '/etc/oozie/conf/oozie-env.sh', owner='oozie')
    self.assertResourceCalled('File', '/etc/oozie/conf/adminusers.txt', owner='oozie', group='hadoop')
    self.assertResourceCalled('File', '/etc/oozie/conf/hadoop-config.xml', owner='oozie', group='hadoop')
    self.assertResourceCalled('File', '/etc/oozie/conf/oozie-default.xml', owner='oozie', group='hadoop')
    self.assertResourceCalled('Directory', '/etc/oozie/conf/action-conf', owner='oozie', group='hadoop')
    self.assertResourceCalled('File', '/etc/oozie/conf/action-conf/hive.xml', owner='oozie', group='hadoop')
    self.assertNoMoreResources()
