{
  for (  Input input : inputList) {
    try {
      input.setDrain(true);
    }
 catch (    Throwable t) {
      logger.error("Error while draining. input=" + input.getShortDescription(),t);
    }
  }
  isDrain=true;
  int iterations=30;
  int waitTimeMS=1000;
  int i=0;
  boolean allClosed=true;
  for (i=0; i < iterations; i++) {
    allClosed=true;
    for (    Input input : inputList) {
      if (!input.isClosed()) {
        try {
          allClosed=false;
          logger.warn("Waiting for input to close. " + input.getShortDescription() + ", "+ (iterations - i)+ " more seconds");
          Thread.sleep(waitTimeMS);
        }
 catch (        Throwable t) {
        }
      }
    }
    if (allClosed) {
      break;
    }
  }
  if (!allClosed) {
    logger.warn("Some inputs were not closed. Iterations=" + i);
    for (    Input input : inputList) {
      if (!input.isClosed()) {
        logger.warn("Input not closed. Will ignore it." + input.getShortDescription());
      }
    }
  }
 else {
    logger.info("All inputs are closed. Iterations=" + i);
  }
}
