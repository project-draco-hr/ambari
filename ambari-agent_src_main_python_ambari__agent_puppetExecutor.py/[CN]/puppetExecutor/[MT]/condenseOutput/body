def condenseOutput(self, stdout, stderr, retcode):
    grep = Grep()
    if (stderr == self.NO_ERROR):
        result = grep.tail(stdout, self.OUTPUT_LAST_LINES)
    else:
        result = grep.grep(stdout, 'fail', self.ERROR_LAST_LINES_BEFORE, self.ERROR_LAST_LINES_AFTER)
        if (result is None):
            result = grep.grep(stdout, 'err', self.ERROR_LAST_LINES_BEFORE, self.ERROR_LAST_LINES_AFTER)
    filteredresult = grep.filterMarkup(result)
    return filteredresult
