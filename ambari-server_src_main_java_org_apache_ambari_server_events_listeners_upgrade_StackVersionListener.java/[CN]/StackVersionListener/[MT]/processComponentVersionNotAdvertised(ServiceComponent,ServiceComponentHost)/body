{
  if (UpgradeState.ONGOING_UPGRADE_STATES.contains(sch.getUpgradeState())) {
    sch.setUpgradeState(UpgradeState.FAILED);
  }
 else   if (!sc.isVersionAdvertised()) {
    sch.setUpgradeState(UpgradeState.NONE);
  }
 else {
    sch.setUpgradeState(UpgradeState.VERSION_MISMATCH);
  }
}
