{
  if (sch.getUpgradeState().equals(UpgradeState.IN_PROGRESS)) {
    if (sc.getDesiredVersion().equals(newVersion)) {
      sch.setUpgradeState(UpgradeState.COMPLETE);
      sch.setStackVersion(cluster.getDesiredStackVersion());
    }
 else {
      sch.setUpgradeState(UpgradeState.VERSION_MISMATCH);
    }
  }
 else {
    sch.setUpgradeState(UpgradeState.VERSION_MISMATCH);
  }
  sch.setVersion(newVersion);
}
