{
  for (  UpgradeCatalog upgradeCatalog : upgradeCatalogs) {
    if (upgradeCatalog.getCompatibleVersions() != null) {
      boolean validPath=false;
      for (      String version : upgradeCatalog.getCompatibleVersions()) {
        String regexVersion=version.replace(".","\\.").replace("*",".*");
        Matcher m=Pattern.compile(regexVersion).matcher(targetVersion);
        if (m.matches()) {
          validPath=true;
          break;
        }
      }
      if (!validPath) {
        throw new AmbariException("Cannot upgrade because UpgradeCatalog " + upgradeCatalog.getTargetVersion() + " is not supported in Ambari version "+ targetVersion+ ".");
      }
    }
  }
}
