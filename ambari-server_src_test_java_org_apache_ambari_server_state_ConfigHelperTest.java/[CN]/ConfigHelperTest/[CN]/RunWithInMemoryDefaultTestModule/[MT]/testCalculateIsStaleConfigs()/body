{
  Map<String,HostConfig> schReturn=new HashMap<String,HostConfig>();
  HostConfig hc=new HostConfig();
  hc.setDefaultVersionTag("version2");
  schReturn.put("flume-conf",hc);
  ServiceComponentHost sch=createNiceMock(ServiceComponentHost.class);
  expect(sch.getActualConfigs()).andReturn(schReturn).times(3);
  expect(sch.getHostName()).andReturn("h1").times(6);
  expect(sch.getClusterId()).andReturn(1l).times(3);
  expect(sch.getServiceName()).andReturn("FLUME").times(3);
  expect(sch.getServiceComponentName()).andReturn("FLUME_HANDLER").times(3);
  replay(sch);
  Assert.assertTrue(configHelper.isStaleConfigs(sch));
  HostConfig hc2=new HostConfig();
  hc2.setDefaultVersionTag("version1");
  schReturn.put("flume-conf",hc2);
  configHelper.invalidateStaleConfigsCache();
  Assert.assertFalse(configHelper.isStaleConfigs(sch));
  List<String> hosts=new ArrayList<String>();
  hosts.add("h1");
  List<Config> configs=new ArrayList<Config>();
  configs.add(new ConfigImpl("flume-conf"));
  addConfigGroup("configGroup1","FLUME",hosts,configs);
  Assert.assertTrue(configHelper.isStaleConfigs(sch));
  verify(sch);
}
