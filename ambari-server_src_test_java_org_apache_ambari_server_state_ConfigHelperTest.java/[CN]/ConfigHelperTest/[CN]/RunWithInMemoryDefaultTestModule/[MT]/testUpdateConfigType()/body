{
  Config currentConfig=cluster.getDesiredConfigByType("core-site");
  Map<String,String> properties=currentConfig.getProperties();
  Map<String,Map<String,String>> propertiesAttributes=currentConfig.getPropertiesAttributes();
  Assert.assertNotNull(propertiesAttributes);
  Assert.assertEquals(1,propertiesAttributes.size());
  Assert.assertTrue(propertiesAttributes.containsKey("attribute1"));
  Assert.assertEquals("version1",currentConfig.getTag());
  Assert.assertEquals("30",properties.get("fs.trash.interval"));
  Assert.assertTrue(properties.containsKey("ipc.client.connect.max.retries"));
  Assert.assertTrue(propertiesAttributes.get("attribute1").containsKey("ipc.client.connect.max.retries"));
  Map<String,String> updates=new HashMap<String,String>();
  updates.put("new-property","new-value");
  updates.put("fs.trash.interval","updated-value");
  Collection<String> removals=Collections.singletonList("ipc.client.connect.max.retries");
  configHelper.updateConfigType(cluster,managementController,"core-site",updates,removals,"admin","Test note");
  Config updatedConfig=cluster.getDesiredConfigByType("core-site");
  propertiesAttributes=updatedConfig.getPropertiesAttributes();
  Assert.assertNotNull(propertiesAttributes);
  Assert.assertEquals(1,propertiesAttributes.size());
  Assert.assertTrue(propertiesAttributes.containsKey("attribute1"));
  Assert.assertFalse("version1".equals(updatedConfig.getTag()));
  properties=updatedConfig.getProperties();
  Assert.assertTrue(properties.containsKey("new-property"));
  Assert.assertEquals("new-value",properties.get("new-property"));
  Assert.assertTrue(properties.containsKey("fs.trash.interval"));
  Assert.assertEquals("updated-value",properties.get("fs.trash.interval"));
  Assert.assertEquals("2",propertiesAttributes.get("attribute1").get("fs.trash.interval"));
  Assert.assertFalse(properties.containsKey("ipc.client.connect.max.retries"));
  Assert.assertFalse(propertiesAttributes.get("attribute1").containsKey("ipc.client.connect.max.retries"));
}
