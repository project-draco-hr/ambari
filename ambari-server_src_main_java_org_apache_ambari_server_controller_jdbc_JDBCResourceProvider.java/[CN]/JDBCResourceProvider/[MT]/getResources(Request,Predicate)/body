{
  Set<Resource> resources=new HashSet<Resource>();
  Set<PropertyId> propertyIds=PropertyHelper.getRequestPropertyIds(this.propertyIds,request,predicate);
  propertyIds.remove(PropertyHelper.getPropertyId("cluster_id","Clusters"));
  try {
    Connection connection=connectionFactory.getConnection();
    try {
      for (      String table : getTables(propertyIds)) {
        getImportedKeys(connection,table);
      }
      String sql=getSelectSQL(propertyIds,predicate);
      Statement statement=connection.createStatement();
      ResultSet rs=statement.executeQuery(sql);
      while (rs.next()) {
        ResultSetMetaData metaData=rs.getMetaData();
        int columnCount=metaData.getColumnCount();
        final ResourceImpl resource=new ResourceImpl(type);
        for (int i=1; i <= columnCount; ++i) {
          PropertyIdImpl propertyId=new PropertyIdImpl(metaData.getColumnName(i),metaData.getTableName(i),false);
          if (propertyIds.contains(propertyId)) {
            resource.setProperty(propertyId,rs.getString(i));
          }
        }
        resources.add(resource);
      }
      statement.close();
    }
  finally {
      connection.close();
    }
  }
 catch (  SQLException e) {
    return Collections.emptySet();
  }
  return resources;
}
