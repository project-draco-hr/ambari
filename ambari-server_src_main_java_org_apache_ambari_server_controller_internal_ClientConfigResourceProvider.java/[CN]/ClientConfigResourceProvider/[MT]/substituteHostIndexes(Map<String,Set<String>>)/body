{
  Set<String> keysToSkip=new HashSet<String>(Arrays.asList("all_hosts","all_ping_ports","ambari_server_host","all_racks","all_ipv4_ips"));
  String[] allHosts={};
  if (clusterHostInfo.get("all_hosts") != null) {
    allHosts=clusterHostInfo.get("all_hosts").toArray(new String[clusterHostInfo.get("all_hosts").size()]);
  }
  Set<String> keys=clusterHostInfo.keySet();
  for (  String key : keys) {
    if (keysToSkip.contains(key)) {
      continue;
    }
    Set<String> hosts=new HashSet<String>();
    Set<String> currentHostsIndexes=clusterHostInfo.get(key);
    if (currentHostsIndexes == null) {
      continue;
    }
    for (    String hostIndexRange : currentHostsIndexes) {
      for (      Integer hostIndex : rangeToSet(hostIndexRange)) {
        try {
          hosts.add(allHosts[hostIndex]);
        }
 catch (        ArrayIndexOutOfBoundsException ex) {
          throw new SystemException("Failed to fill cluster host info  ",ex);
        }
      }
    }
    clusterHostInfo.put(key,hosts);
  }
  return clusterHostInfo;
}
