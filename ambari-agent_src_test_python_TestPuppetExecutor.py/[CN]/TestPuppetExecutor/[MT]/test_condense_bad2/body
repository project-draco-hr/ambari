def test_condense_bad2(self):
    puppetexecutor = PuppetExecutor('/tmp', '/x', '/y', '/z', AmbariConfig().getConfig())
    grep = Grep()
    puppetexecutor.grep = grep
    grep.ERROR_LAST_LINES_BEFORE = 2
    grep.ERROR_LAST_LINES_AFTER = 3
    string_err = open('dummy_puppet_output_error2.txt', 'r').read().replace('\n', os.linesep)
    result = puppetexecutor.condenseOutput(string_err, '', 1)
    stripped_string = string_err.strip()
    lines = stripped_string.splitlines(True)
    d = lines[1:6]
    result_check = True
    for l in d:
        result_check &= (grep.filterMarkup(l) in result)
    self.assertEquals(result_check, True, 'Failed to condence fail log')
    self.assertEquals(len(result.splitlines(True)), 6, 'Failed to condence fail log')
