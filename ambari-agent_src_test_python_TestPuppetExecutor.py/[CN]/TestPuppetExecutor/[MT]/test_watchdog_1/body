def test_watchdog_1(self):
    '\n    Tests whether watchdog works\n    '
    subproc_mock = self.Subprocess_mockup()
    executor_mock = self.PuppetExecutor_mock('/home/centos/ambari_repo_info/ambari-agent/src/main/puppet/', '/usr/', '/root/workspace/puppet-install/facter-1.6.10/', '/tmp', AmbariConfig().getConfig(), subproc_mock)
    (_, tmpoutfile) = tempfile.mkstemp()
    (_, tmperrfile) = tempfile.mkstemp()
    result = {}
    puppetEnv = {'RUBYLIB': '', }
    executor_mock.PUPPET_TIMEOUT_SECONDS = 0.1
    subproc_mock.returncode = None
    thread = Thread(target=executor_mock.runPuppetFile, args=('fake_puppetFile', result, puppetEnv, tmpoutfile, tmperrfile))
    thread.start()
    time.sleep(0.1)
    subproc_mock.finished_event.wait()
    self.assertEquals(subproc_mock.was_terminated, True, 'Subprocess should be terminated due to timeout')
