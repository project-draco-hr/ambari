def service_check(self, env):
    import params
    env.set_params(params)
    input_file = 'passwd'
    output_file = 'pigsmoke.out'
    cleanup_cmd = format('dfs -rmr {output_file} {input_file}')
    create_file_cmd = format('{cleanup_cmd}; hadoop dfs -put /etc/passwd {input_file} ')
    test_cmd = format('fs -test -e {output_file}')
    ExecuteHadoop(create_file_cmd, tries=3, try_sleep=5, user=params.smokeuser, conf_dir=params.hadoop_conf_dir, keytab=params.smoke_user_keytab, security_enabled=params.security_enabled, kinit_path_local=params.kinit_path_local)
    File('/tmp/pigSmoke.sh', content=StaticFile('pigSmoke.sh'), mode=493)
    Execute('pig /tmp/pigSmoke.sh', tries=3, try_sleep=5, path='/usr/sbin:/sbin:/usr/local/bin:/bin:/usr/bin', user=params.smokeuser)
    ExecuteHadoop(test_cmd, user=params.smokeuser, conf_dir=params.hadoop_conf_dir)
