{
  Clusters clusters=getManagementController().getClusters();
  Set<Service> removable=new HashSet<Service>();
  for (  ServiceRequest serviceRequest : request) {
    if (StringUtils.isEmpty(serviceRequest.getClusterName()) || StringUtils.isEmpty(serviceRequest.getServiceName())) {
      throw new AmbariException("invalid arguments");
    }
 else {
      if (!AuthorizationHelper.isAuthorized(ResourceType.CLUSTER,getClusterId(serviceRequest.getClusterName()),RoleAuthorization.SERVICE_ADD_DELETE_SERVICES)) {
        throw new AuthorizationException("The user is not authorized to delete services");
      }
      Service service=clusters.getCluster(serviceRequest.getClusterName()).getService(serviceRequest.getServiceName());
      for (      ServiceComponent sc : service.getServiceComponents().values()) {
        if (!sc.canBeRemoved()) {
          throw new AmbariException("Cannot remove " + serviceRequest.getClusterName() + "/"+ serviceRequest.getServiceName()+ ". "+ sc.getName()+ " is in a non-removable state.");
        }
      }
      removable.add(service);
    }
  }
  for (  Service service : removable) {
    service.getCluster().deleteService(service.getName());
  }
  return null;
}
