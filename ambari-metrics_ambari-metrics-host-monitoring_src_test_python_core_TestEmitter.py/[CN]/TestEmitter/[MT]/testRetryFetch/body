@patch('urllib2.urlopen')
def testRetryFetch(self, url_open_mock):
    config = Configuration()
    application_metric_map = ApplicationMetricMap('host', '10.10.10.10')
    application_metric_map.clear()
    application_metric_map.put_metric('APP1', {'metric1': 1, }, 1)
    emitter = Emitter(config, application_metric_map)
    emitter.RETRY_SLEEP_INTERVAL = 0.001
    emitter.submit_metrics()
    self.assertEqual(url_open_mock.call_count, 3)
    self.assertUrlData(url_open_mock)
