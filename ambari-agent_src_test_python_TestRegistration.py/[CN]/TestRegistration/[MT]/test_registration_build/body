def test_registration_build(self):
    config = AmbariConfig().getConfig()
    tmpdir = tempfile.gettempdir()
    config.set('agent', 'prefix', tmpdir)
    ver_file = os.path.join(tmpdir, 'version')
    with open(ver_file, 'w') as text_file:
        text_file.write('1.3.0')
    register = Register(config)
    data = register.build(1)
    self.assertEquals((len(data['hardwareProfile']) > 0), True, 'hardwareProfile should contain content')
    self.assertEquals((data['hostname'] != ''), True, 'hostname should not be empty')
    self.assertEquals((data['publicHostname'] != ''), True, 'publicHostname should not be empty')
    self.assertEquals(data['responseId'], 1)
    self.assertEquals((data['timestamp'] > 1353678475465L), True, 'timestamp should not be empty')
    self.assertEquals((len(data['agentEnv']) > 0), True, 'agentEnv should not be empty')
    self.assertEquals(data['agentVersion'], '1.3.0', 'agentVersion should not be empty')
    self.assertEquals(len(data), 7)
    os.remove(ver_file)
