{
  if (request.getClusterName() == null || request.getClusterName().isEmpty()) {
    throw new AmbariException("Invalid arguments");
  }
  LOG.info("Received a delete cluster request" + ", clusterName=" + request.getClusterName());
  Cluster cluster=clusters.getCluster(request.getClusterName());
  if (!cluster.getServices().isEmpty()) {
    boolean nonDeletableService=false;
    for (    Service service : cluster.getServices().values()) {
      if (!service.canBeRemoved()) {
        nonDeletableService=true;
        LOG.warn("Found non removable service when trying to delete cluster" + ", clusterName=" + request.getClusterName() + ", serviceName="+ service.getName());
      }
    }
    if (nonDeletableService) {
      throw new AmbariException("Cannot delete cluster as it has services" + " that cannot be deleted");
    }
  }
  cluster.deleteAllServices();
  clusters.deleteCluster(request.getClusterName());
}
