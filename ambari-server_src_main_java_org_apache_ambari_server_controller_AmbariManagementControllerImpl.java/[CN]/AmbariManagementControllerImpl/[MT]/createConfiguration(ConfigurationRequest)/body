{
  if (null == request.getClusterName() || request.getClusterName().isEmpty() || null == request.getType() || request.getType().isEmpty() || null == request.getVersionTag() || request.getVersionTag().isEmpty() || null == request.getConfigs() || request.getConfigs().isEmpty()) {
    throw new AmbariException("Invalid Arguments.");
  }
  Cluster cluster=clusters.getCluster(request.getClusterName());
  Map<String,Config> configs=cluster.getDesiredConfigsByType(request.getType());
  if (null == configs) {
    configs=new HashMap<String,Config>();
  }
  Config config=configs.get(request.getVersionTag());
  if (configs.containsKey(request.getVersionTag()))   throw new AmbariException("Configuration with that tag exists for '" + request.getType() + "'");
  config=configFactory.createNew(cluster,request.getType(),request.getConfigs());
  config.setVersionTag(request.getVersionTag());
  config.persist();
  cluster.addDesiredConfig(config);
  return null;
}
