{
  List<Host> hosts;
  Set<HostResponse> response=new HashSet<HostResponse>();
  Cluster cluster=null;
  String clusterName=request.getClusterName();
  String hostName=request.getHostname();
  if (clusterName != null) {
    try {
      cluster=clusters.getCluster(clusterName);
    }
 catch (    ObjectNotFoundException e) {
      throw new ParentObjectNotFoundException("Parent Cluster resource doesn't exist",e);
    }
  }
  if (hostName == null) {
    hosts=clusters.getHosts();
  }
 else {
    hosts=new ArrayList<Host>();
    hosts.add(clusters.getHost(request.getHostname()));
  }
  for (  Host h : hosts) {
    if (clusterName != null) {
      if (clusters.getClustersForHost(h.getHostName()).contains(cluster)) {
        HostResponse r=h.convertToResponse();
        r.setClusterName(clusterName);
        response.add(r);
      }
 else       if (hostName != null) {
        throw new HostNotFoundException(hostName);
      }
    }
 else {
      HostResponse r=h.convertToResponse();
      Set<Cluster> clustersForHost=clusters.getClustersForHost(h.getHostName());
      if (clustersForHost != null && clustersForHost.size() != 0) {
        r.setClusterName(clustersForHost.iterator().next().getClusterName());
      }
      response.add(r);
    }
  }
  return response;
}
