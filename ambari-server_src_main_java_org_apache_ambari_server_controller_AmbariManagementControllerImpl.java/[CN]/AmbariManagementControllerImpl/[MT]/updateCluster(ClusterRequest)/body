{
  if (request.getClusterName() == null || request.getClusterName().isEmpty()) {
    throw new IllegalArgumentException("Invalid arguments, cluster name" + " should not be null");
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Received a updateCluster request" + ", clusterName=" + request.getClusterName() + ", request="+ request);
  }
  final Cluster c=clusters.getCluster(request.getClusterName());
  if (null != request.getHostNames()) {
    clusters.mapHostsToCluster(request.getHostNames(),request.getClusterName());
  }
  if (!request.getStackVersion().equals(c.getDesiredStackVersion().getStackId())) {
    throw new IllegalArgumentException("Update of desired stack version" + " not supported");
  }
  if (null != request.getDesiredConfig()) {
    ConfigurationRequest cr=request.getDesiredConfig();
    if (null != cr.getProperties() && cr.getProperties().size() > 0) {
      cr.setClusterName(c.getClusterName());
      createConfiguration(cr);
    }
    Config baseConfig=c.getConfig(cr.getType(),cr.getVersionTag());
    if (null != baseConfig)     c.addDesiredConfig(baseConfig);
  }
  return null;
}
