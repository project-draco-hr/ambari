{
  boolean isAuthorized=false;
  for (  GrantedAuthority grantedAuthority : securityHelper.getCurrentAuthorities()) {
    if (grantedAuthority instanceof AmbariGrantedAuthority) {
      AmbariGrantedAuthority authority=(AmbariGrantedAuthority)grantedAuthority;
      PrivilegeEntity privilegeEntity=authority.getPrivilegeEntity();
      Integer permissionId=privilegeEntity.getPermission().getId();
      if (permissionId.equals(PermissionEntity.AMBARI_ADMIN_PERMISSION)) {
        isAuthorized=true;
        break;
      }
    }
  }
  if (!isAuthorized) {
    throw new IllegalArgumentException("You do not have authorization to update the requested resource property.");
  }
}
