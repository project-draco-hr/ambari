{
  Resource.Type opLvl=Resource.Type.Cluster;
  StackId stackId=service.getDesiredStackVersion();
  ComponentInfo compInfo=ambariMetaInfo.getServiceInfo(stackId.getStackName(),stackId.getStackVersion(),service.getName()).getClientComponent();
  if (compInfo != null) {
    try {
      ServiceComponent serviceComponent=service.getServiceComponent(compInfo.getName());
      if (!serviceComponent.getServiceComponentHosts().isEmpty()) {
        Set<String> candidateHosts=serviceComponent.getServiceComponentHosts().keySet();
        filterHostsForAction(candidateHosts,service,cluster,opLvl);
        return getHealthyHost(candidateHosts);
      }
    }
 catch (    ServiceComponentNotFoundException e) {
      LOG.warn("Could not find required component to run action" + ", clusterName=" + cluster.getClusterName() + ", serviceName="+ service.getName()+ ", componentName="+ compInfo.getName());
    }
  }
  Map<String,ServiceComponent> components=service.getServiceComponents();
  if (components.isEmpty()) {
    return null;
  }
  for (  ServiceComponent serviceComponent : components.values()) {
    if (serviceComponent.getServiceComponentHosts().isEmpty()) {
      continue;
    }
    Set<String> candidateHosts=serviceComponent.getServiceComponentHosts().keySet();
    filterHostsForAction(candidateHosts,service,cluster,opLvl);
    return getHealthyHost(candidateHosts);
  }
  return null;
}
