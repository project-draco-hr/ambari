{
  StackId stackId=service.getDesiredStackVersion();
  ComponentInfo compInfo=ambariMetaInfo.getServiceInfo(stackId.getStackName(),stackId.getStackVersion(),service.getName()).getClientComponent();
  if (compInfo != null) {
    try {
      ServiceComponent serviceComponent=service.getServiceComponent(compInfo.getName());
      if (!serviceComponent.getServiceComponentHosts().isEmpty()) {
        return getHealthyHost(serviceComponent.getServiceComponentHosts().keySet());
      }
    }
 catch (    ServiceComponentNotFoundException e) {
      LOG.warn("Could not find required component to run action" + ", clusterName=" + cluster.getClusterName() + ", serviceName="+ service.getName()+ ", componentName="+ compInfo.getName());
    }
  }
  Map<String,ServiceComponent> components=service.getServiceComponents();
  if (components.isEmpty()) {
    return null;
  }
  for (  ServiceComponent serviceComponent : components.values()) {
    if (serviceComponent.getServiceComponentHosts().isEmpty()) {
      continue;
    }
    return getHealthyHost(serviceComponent.getServiceComponentHosts().keySet());
  }
  return null;
}
