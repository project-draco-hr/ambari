{
  for (  UserRequest request : requests) {
    if (null == request.getUsername() || request.getUsername().isEmpty() || null == request.getPassword() || request.getPassword().isEmpty()) {
      throw new AmbariException("Username and password must be supplied.");
    }
    User user=users.getAnyUser(request.getUsername());
    if (null != user) {
      throw new AmbariException("User already exists.");
    }
    users.createUser(request.getUsername(),request.getPassword(),request.isActive(),request.isAdmin());
    if (null != request.isActive() && null != user) {
      users.setUserActive(user,request.isActive());
    }
  }
}
