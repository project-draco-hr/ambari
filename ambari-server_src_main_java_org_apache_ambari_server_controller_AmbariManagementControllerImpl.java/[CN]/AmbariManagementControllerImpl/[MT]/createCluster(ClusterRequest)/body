{
  if (request.getClusterName() == null || request.getClusterName().isEmpty()) {
    throw new AmbariException("Invalid arguments");
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Received a createCluster request" + ", clusterName=" + request.getClusterName() + ", request="+ request);
  }
  clusters.addCluster(request.getClusterName());
  if (request.getHostNames() != null) {
    clusters.mapHostsToCluster(request.getHostNames(),request.getClusterName());
  }
  Cluster c=clusters.getCluster(request.getClusterName());
  if (request.getStackVersion() != null) {
    c.setDesiredStackVersion(new StackVersion(request.getStackVersion()));
  }
  return null;
}
