{
  Set<StackServiceResponse> response;
  String stackName=request.getStackName();
  String stackVersion=request.getStackVersion();
  String serviceName=request.getServiceName();
  if (serviceName != null) {
    ServiceInfo service=this.ambariMetaInfo.getService(stackName,stackVersion,serviceName);
    response=Collections.singleton(service.convertToResponse());
  }
 else {
    Map<String,ServiceInfo> services=this.ambariMetaInfo.getServices(stackName,stackVersion);
    response=new HashSet<StackServiceResponse>();
    for (    ServiceInfo service : services.values()) {
      response.add(service.convertToResponse());
    }
  }
  return response;
}
