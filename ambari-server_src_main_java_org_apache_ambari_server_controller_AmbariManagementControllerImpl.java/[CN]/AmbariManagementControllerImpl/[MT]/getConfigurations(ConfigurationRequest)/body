{
  if (request.getClusterName() == null) {
    throw new AmbariException("Invalid arguments");
  }
  Cluster cluster=clusters.getCluster(request.getClusterName());
  Set<ConfigurationResponse> responses=new HashSet<ConfigurationResponse>();
  if (null != request.getType() && null != request.getVersionTag()) {
    Config config=cluster.getDesiredConfig(request.getType(),request.getVersionTag());
    if (null != config) {
      ConfigurationResponse response=new ConfigurationResponse(cluster.getClusterName(),config.getType(),config.getVersionTag(),config.getProperties());
      responses.add(response);
    }
  }
 else {
    if (null != request.getType()) {
      Map<String,Config> configs=cluster.getDesiredConfigsByType(request.getType());
      for (      Entry<String,Config> entry : configs.entrySet()) {
        ConfigurationResponse response=new ConfigurationResponse(cluster.getClusterName(),request.getType(),entry.getValue().getVersionTag(),new HashMap<String,String>());
        responses.add(response);
      }
    }
  }
  return responses;
}
