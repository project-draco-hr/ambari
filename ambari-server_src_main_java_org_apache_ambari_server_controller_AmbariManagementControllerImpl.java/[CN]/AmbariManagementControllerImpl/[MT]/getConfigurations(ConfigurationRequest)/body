{
  if (request.getClusterName() == null) {
    throw new IllegalArgumentException("Invalid arguments, cluster name" + " should not be null");
  }
  Cluster cluster=clusters.getCluster(request.getClusterName());
  Set<ConfigurationResponse> responses=new HashSet<ConfigurationResponse>();
  if (null != request.getType() && null != request.getVersionTag()) {
    Config config=cluster.getConfig(request.getType(),request.getVersionTag());
    if (null != config) {
      ConfigurationResponse response=new ConfigurationResponse(cluster.getClusterName(),config.getType(),config.getVersionTag(),config.getProperties(),config.getPropertiesAttributes());
      responses.add(response);
    }
  }
 else {
    if (null != request.getType()) {
      Map<String,Config> configs=cluster.getConfigsByType(request.getType());
      if (null != configs) {
        for (        Entry<String,Config> entry : configs.entrySet()) {
          ConfigurationResponse response=new ConfigurationResponse(cluster.getClusterName(),request.getType(),entry.getValue().getVersionTag(),new HashMap<String,String>(),new HashMap<String,Map<String,String>>());
          responses.add(response);
        }
      }
    }
 else {
      Collection<Config> all=cluster.getAllConfigs();
      for (      Config config : all) {
        ConfigurationResponse response=new ConfigurationResponse(cluster.getClusterName(),config.getType(),config.getVersionTag(),new HashMap<String,String>(),new HashMap<String,Map<String,String>>());
        responses.add(response);
      }
    }
  }
  return responses;
}
