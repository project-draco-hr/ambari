{
  if (requests.isEmpty()) {
  }
  Set<String> duplicates=new HashSet<String>();
  Set<String> unknowns=new HashSet<String>();
  Set<String> allHosts=new HashSet<String>();
  for (  HostRequest request : requests) {
    if (request.getHostname() == null || request.getHostname().isEmpty()) {
      throw new AmbariException("Invalid arguments");
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug("Received a createHost request" + ", hostname=" + request.getHostname() + ", request="+ request);
    }
    if (allHosts.contains(request.getHostname())) {
      duplicates.add(request.getHostname());
      continue;
    }
    allHosts.add(request.getHostname());
    try {
      clusters.getHost(request.getHostname());
    }
 catch (    HostNotFoundException e) {
      unknowns.add(request.getHostname());
      continue;
    }
  }
  if (!duplicates.isEmpty()) {
    StringBuilder names=new StringBuilder();
    boolean first=true;
    for (    String hName : duplicates) {
      if (!first) {
        names.append(",");
      }
      first=false;
      names.append(hName);
    }
    throw new AmbariException("Invalid request contains duplicate hostnames" + ", hostnames=" + names.toString());
  }
  if (!unknowns.isEmpty()) {
    StringBuilder names=new StringBuilder();
    boolean first=true;
    for (    String hName : unknowns) {
      if (!first) {
        names.append(",");
      }
      first=false;
      names.append(hName);
    }
    throw new AmbariException("Some hosts have not been registered with" + " the server" + ", hostnames="+ names.toString());
  }
  for (  HostRequest request : requests) {
    Host h=clusters.getHost(request.getHostname());
    if (request.getClusterNames() != null) {
      for (      String clusterName : request.getClusterNames()) {
        clusters.mapHostToCluster(request.getHostname(),clusterName);
      }
    }
    if (request.getHostAttributes() != null) {
      h=clusters.getHost(request.getHostname());
      h.setHostAttributes(request.getHostAttributes());
    }
  }
}
