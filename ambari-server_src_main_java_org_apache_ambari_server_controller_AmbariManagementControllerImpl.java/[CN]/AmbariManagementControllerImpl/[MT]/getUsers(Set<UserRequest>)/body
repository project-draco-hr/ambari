{
  Set<UserResponse> responses=new HashSet<UserResponse>();
  for (  UserRequest r : requests) {
    if (null == r.getUsername()) {
      for (      User u : users.getAllUsers()) {
        responses.add(new UserResponse(u.getUserName()));
      }
    }
 else {
      User u=users.getAnyUser(r.getUsername());
      if (null == u) {
        throw new AmbariException("Cannot find user '" + r.getUsername() + "'");
      }
      UserResponse resp=new UserResponse(u.getUserName());
      resp.setRoles(new HashSet<String>(u.getRoles()));
      responses.add(resp);
    }
  }
  return responses;
}
