{
  List<Stage> stages=doStageCreation(cluster,changedServices,changedComponents,changedHosts,requestParameters,requestProperties.get(REQUEST_CONTEXT_PROPERTY),runSmokeTest,reconfigureClients);
  persistStages(stages);
  updateServiceStates(changedServices,changedComponents,changedHosts,ignoredHosts);
  return stages == null || stages.isEmpty() ? null : getRequestStatusResponse(stages.get(0).getRequestId());
}
