def action_create(self):
    if (not self.user):
        command = ['useradd', '-m']
        useradd_options = dict(comment='-c', gid='-g', uid='-u', shell='-s', password='-p', home='-d')
        if self.resource.system:
            command.append('--system')
        if self.resource.groups:
            command += ['-G', ','.join(self.resource.groups)]
        for (option_name, option_flag) in useradd_options.items():
            option_value = getattr(self.resource, option_name)
            if (option_flag and option_value):
                command += [option_flag, str(option_value)]
        command.append(self.resource.username)
        shell.checked_call(command)
        self.resource.updated()
        self.log.info(('Added user %s' % self.resource))
