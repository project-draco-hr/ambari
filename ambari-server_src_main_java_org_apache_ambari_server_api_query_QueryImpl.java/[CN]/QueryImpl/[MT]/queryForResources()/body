{
  Set<Resource> providerResourceSet=new HashSet<Resource>();
  Resource.Type resourceType=getResourceDefinition().getType();
  Predicate queryPredicate=createPredicate(getKeyValueMap(),processUserPredicate(userPredicate));
  finalizeProperties();
  Request request=createRequest();
  Set<Resource> resourceSet=new LinkedHashSet<Resource>();
  Set<Resource> queryResources=doQuery(resourceType,request,queryPredicate,pageRequest,sortRequest);
  providerResourceSet.addAll(queryResources);
  resourceSet.addAll(queryResources);
  queryResults.put(null,new QueryResult(request,queryPredicate,userPredicate,getKeyValueMap(),resourceSet));
  clusterController.populateResources(resourceType,providerResourceSet,request,queryPredicate);
  queryForSubResources();
}
