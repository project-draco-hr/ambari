{
  Set<Resource> providerResourceSet=new HashSet<Resource>();
  Resource.Type resourceType=getResourceDefinition().getType();
  Request request=createRequest(!minimal);
  Request qRequest=createRequest(true);
  Predicate queryPredicate=createPredicate(getKeyValueMap(),processUserPredicate(userPredicate));
  Set<Resource> resourceSet=new LinkedHashSet<Resource>();
  for (  Resource queryResource : doQuery(resourceType,qRequest,queryPredicate)) {
    providerResourceSet.add(queryResource);
    resourceSet.add(queryResource);
  }
  queryResults.put(null,new QueryResult(request,queryPredicate,userPredicate,getKeyValueMap(),resourceSet));
  clusterController.populateResources(resourceType,providerResourceSet,qRequest,queryPredicate);
  queryForSubResources(userPredicate,hasSubResourcePredicate());
}
