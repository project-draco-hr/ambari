{
  Resource.Type resourceType=resource.getResourceDefinition().getType();
  Map<Resource.Type,String> mapResourceIds=resource.getIds();
  Schema schema=getClusterController().getSchema(resourceType);
  Set<Predicate> setPredicates=new HashSet<Predicate>();
  for (  Map.Entry<Resource.Type,String> entry : mapResourceIds.entrySet()) {
    if (entry.getValue() != null) {
      String keyPropertyId=schema.getKeyPropertyId(entry.getKey());
      if (keyPropertyId != null) {
        setPredicates.add(new EqualsPredicate<String>(keyPropertyId,entry.getValue()));
      }
    }
  }
  if (setPredicates.size() == 1) {
    return setPredicates.iterator().next();
  }
 else   if (setPredicates.size() > 1) {
    return new AndPredicate(setPredicates.toArray(new Predicate[setPredicates.size()]));
  }
 else {
    return null;
  }
}
