def datanode(action=None):
    import params
    if (action == 'configure'):
        Directory(params.dfs_domain_socket_dir, recursive=True, mode=488, owner=params.hdfs_user, group=params.user_group)
        for data_dir in params.dfs_data_dir.split(','):
            Directory(os.path.dirname(data_dir), recursive=True, mode=493)
            Directory(data_dir, recursive=False, mode=488, owner=params.hdfs_user, group=params.user_group)
    if (action == 'start'):
        service(action=action, name='datanode', user=params.hdfs_user, create_pid_dir=True, create_log_dir=True, keytab=params.dfs_datanode_keytab_file, principal=params.dfs_datanode_kerberos_principal)
    if (action == 'stop'):
        service(action=action, name='datanode', user=params.hdfs_user, create_pid_dir=True, create_log_dir=True, keytab=params.dfs_datanode_keytab_file, principal=params.dfs_datanode_kerberos_principal)
