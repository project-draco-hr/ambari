def test_recommendRangerConfigurations(self):
    clusterData = {}
    services = {'services': [{'StackServices': {'service_name': 'RANGER', }, 'components': [{'StackServiceComponents': {'component_name': 'RANGER_ADMIN', 'hostnames': ['host1'], }, }], }], 'configurations': {'admin-properties': {'properties': {'DB_FLAVOR': 'NOT_EXISTING', }, }, 'ranger-admin-site': {'properties': {'ranger.service.http.port': '7777', 'ranger.service.http.enabled': 'true', }, }, }, }
    expected = {'admin-properties': {'properties': {'SQL_CONNECTOR_JAR': '/usr/share/java/mysql-connector-java.jar', 'policymgr_external_url': 'http://host1:7777', }, }, }
    recommendedConfigurations = {}
    self.stackAdvisor.recommendRangerConfigurations(recommendedConfigurations, clusterData, services, None)
    self.assertEquals(recommendedConfigurations, expected)
    configurations = {'admin-properties': {'properties': {'DB_FLAVOR': 'POSTGRES', }, }, 'ranger-admin-site': {'properties': {'ranger.service.https.port': '7777', 'ranger.service.http.enabled': 'false', }, }, }
    services['configurations'] = configurations
    expected = {'admin-properties': {'properties': {'SQL_CONNECTOR_JAR': '/usr/share/java/postgresql.jar', 'policymgr_external_url': 'https://host1:7777', }, }, }
    recommendedConfigurations = {}
    self.stackAdvisor.recommendRangerConfigurations(recommendedConfigurations, clusterData, services, None)
    self.assertEquals(recommendedConfigurations, expected)
    configurations = {'admin-properties': {'properties': {'DB_FLAVOR': 'ORACLE', }, }, 'ranger-site': {'properties': {'http.enabled': 'false', 'https.service.port': '8888', }, }, }
    services['configurations'] = configurations
    expected = {'admin-properties': {'properties': {'SQL_CONNECTOR_JAR': '/usr/share/java/ojdbc6.jar', 'policymgr_external_url': 'https://host1:8888', }, }, }
    recommendedConfigurations = {}
    self.stackAdvisor.recommendRangerConfigurations(recommendedConfigurations, clusterData, services, None)
    self.assertEquals(recommendedConfigurations, expected)
