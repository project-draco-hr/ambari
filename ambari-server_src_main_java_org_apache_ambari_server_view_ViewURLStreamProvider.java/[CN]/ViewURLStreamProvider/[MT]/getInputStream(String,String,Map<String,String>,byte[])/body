{
  Map<String,List<String>> headerMap=new HashMap<String,List<String>>();
  for (  Map.Entry<String,String> entry : headers.entrySet()) {
    headerMap.put(entry.getKey(),Collections.singletonList(entry.getValue()));
  }
  HttpURLConnection connection=streamProvider.processURL(spec,requestMethod,info,headerMap);
  int responseCode=connection.getResponseCode();
  return responseCode >= ProxyService.HTTP_ERROR_RANGE_START ? connection.getErrorStream() : connection.getInputStream();
}
