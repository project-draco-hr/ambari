{
  ResourceTypeEntity resourceTypeEntity=new ResourceTypeEntity();
  resourceTypeEntity.setId(ResourceTypeEntity.AMBARI_RESOURCE_TYPE);
  resourceTypeEntity.setName(ResourceTypeEntity.AMBARI_RESOURCE_TYPE_NAME);
  resourceTypeDAO.create(resourceTypeEntity);
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setId(ResourceEntity.AMBARI_RESOURCE_ID);
  resourceEntity.setResourceType(resourceTypeEntity);
  resourceDAO.create(resourceEntity);
  PermissionEntity adminPermissionEntity=new PermissionEntity();
  adminPermissionEntity.setId(PermissionEntity.AMBARI_ADMIN_PERMISSION);
  adminPermissionEntity.setPermissionName(PermissionEntity.AMBARI_ADMIN_PERMISSION_NAME);
  adminPermissionEntity.setResourceType(resourceTypeEntity);
  permissionDAO.create(adminPermissionEntity);
  users.createUser("admin","admin",true,true,false);
  users.createUser("user","user");
  UserEntity userEntity=userDAO.findLocalUserByName("user");
  assertNotSame("user",userEntity.getUserPassword());
  assertTrue(passwordEncoder.matches("user",userEntity.getUserPassword()));
  users.modifyPassword("user","admin","user_new_password");
  assertTrue(passwordEncoder.matches("user_new_password",userDAO.findLocalUserByName("user").getUserPassword()));
}
