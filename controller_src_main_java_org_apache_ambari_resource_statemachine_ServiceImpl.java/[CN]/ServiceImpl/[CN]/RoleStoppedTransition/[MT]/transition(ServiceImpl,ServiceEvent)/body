{
  RoleFSM role=operand.getNextRole();
  if (role != null) {
    stateMachineInvoker.getAMBARIEventHandler().handle(new RoleEvent(RoleEventType.STOP,role));
    return ServiceState.STOPPING;
  }
 else {
    if (((ClusterImpl)operand.getAssociatedCluster()).getState() == ClusterStateFSM.STOPPING) {
      stateMachineInvoker.getAMBARIEventHandler().handle(new ClusterEvent(ClusterEventType.STOP_SUCCESS,operand.getAssociatedCluster()));
    }
    return ServiceState.INACTIVE;
  }
}
