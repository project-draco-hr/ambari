{
  if (hasValidRequest()) {
    return getRemoteAddress(((ServletRequestAttributes)RequestContextHolder.getRequestAttributes()).getRequest());
  }
  return null;
}
