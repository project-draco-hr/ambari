{
  this.hbaseConf=hbaseConf;
  this.metricsConf=metricsConf;
  RESULTSET_LIMIT=metricsConf.getInt(GLOBAL_RESULT_LIMIT,RESULTSET_LIMIT);
  try {
    Class.forName("org.apache.phoenix.jdbc.PhoenixDriver");
  }
 catch (  ClassNotFoundException e) {
    LOG.error("Phoenix client jar not found in the classpath.",e);
    throw new IllegalStateException(e);
  }
  this.dataSource=dataSource;
  this.retryCounterFactory=new RetryCounterFactory(metricsConf.getInt(GLOBAL_MAX_RETRIES,10),(int)SECONDS.toMillis(metricsConf.getInt(GLOBAL_RETRY_INTERVAL,5)));
  this.outOfBandTimeAllowance=metricsConf.getLong(OUT_OFF_BAND_DATA_TIME_ALLOWANCE,DEFAULT_OUT_OF_BAND_TIME_ALLOWANCE);
  this.skipBlockCacheForAggregatorsEnabled=metricsConf.getBoolean(AGGREGATORS_SKIP_BLOCK_CACHE,false);
  tableTTL.put(METRICS_RECORD_TABLE_NAME,getDaysInSeconds(metricsConf.get(PRECISION_TABLE_TTL,"1")));
  tableTTL.put(METRICS_AGGREGATE_MINUTE_TABLE_NAME,getDaysInSeconds(metricsConf.get(HOST_MINUTE_TABLE_TTL,"7")));
  tableTTL.put(METRICS_AGGREGATE_HOURLY_TABLE_NAME,getDaysInSeconds(metricsConf.get(HOST_HOUR_TABLE_TTL,"30")));
  tableTTL.put(METRICS_AGGREGATE_DAILY_TABLE_NAME,getDaysInSeconds(metricsConf.get(HOST_DAILY_TABLE_TTL,"365")));
  tableTTL.put(METRICS_CLUSTER_AGGREGATE_TABLE_NAME,getDaysInSeconds(metricsConf.get(CLUSTER_SECOND_TABLE_TTL,"7")));
  tableTTL.put(METRICS_CLUSTER_AGGREGATE_MINUTE_TABLE_NAME,getDaysInSeconds(metricsConf.get(CLUSTER_MINUTE_TABLE_TTL,"30")));
  tableTTL.put(METRICS_CLUSTER_AGGREGATE_HOURLY_TABLE_NAME,getDaysInSeconds(metricsConf.get(CLUSTER_HOUR_TABLE_TTL,"365")));
  tableTTL.put(METRICS_CLUSTER_AGGREGATE_DAILY_TABLE_NAME,getDaysInSeconds(metricsConf.get(CLUSTER_DAILY_TABLE_TTL,"730")));
}
