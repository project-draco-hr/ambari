{
  TimelineMetric metric=new TimelineMetric();
  metric.setAppId(rs.getString("APP_ID"));
  metric.setInstanceId(rs.getString("INSTANCE_ID"));
  metric.setTimestamp(rs.getLong("SERVER_TIME"));
  metric.setStartTime(rs.getLong("SERVER_TIME"));
  double value;
switch (f.getReadFunction()) {
case AVG:
    value=rs.getDouble("METRIC_SUM") / rs.getInt("METRIC_COUNT");
  break;
case MIN:
value=rs.getDouble("METRIC_MIN");
break;
case MAX:
value=rs.getDouble("METRIC_MAX");
break;
case SUM:
value=rs.getDouble("METRIC_SUM");
break;
default :
value=rs.getDouble("METRIC_SUM") / rs.getInt("METRIC_COUNT");
break;
}
metric.setMetricName(rs.getString("METRIC_NAME") + f.getSuffix());
Map<Long,Double> valueMap=new TreeMap<Long,Double>();
valueMap.put(rs.getLong("SERVER_TIME"),value);
metric.setMetricValues(valueMap);
return metric;
}
