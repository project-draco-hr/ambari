{
  Connection conn=null;
  Statement stmt=null;
  try {
    LOG.info("Initializing metrics schema...");
    conn=getConnectionRetryingOnException();
    stmt=conn.createStatement();
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_RECORD_TABLE_NAME,precisionTtl));
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_AGGREGATE_MINUTE_TABLE_NAME,hostMinTtl));
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_AGGREGATE_HOURLY_TABLE_NAME,hostHourTtl));
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_AGGREGATE_DAILY_TABLE_NAME,hostDailyTtl));
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_CLUSTER_AGGREGATE_TABLE_NAME,clusterSecTtl));
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_CLUSTER_AGGREGATE_MINUTE_TABLE_NAME,clusterMinTtl));
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_CLUSTER_AGGREGATE_HOURLY_TABLE_NAME,clusterHourTtl));
    stmt.executeUpdate(String.format(ALTER_SQL,METRICS_CLUSTER_AGGREGATE_DAILY_TABLE_NAME,clusterDailyTtl));
    conn.commit();
  }
 catch (  InterruptedException e) {
    LOG.warn("Error updating TTL on tables.",e);
  }
catch (  SQLException sql) {
    if (sql.getErrorCode() == SQLExceptionCode.SET_UNSUPPORTED_PROP_ON_ALTER_TABLE.getErrorCode()) {
      LOG.warn("Update TTL on tables is unsupported by the phoenix version. " + sql.getMessage());
    }
 else {
      LOG.warn("Error updating TTL on tables.",sql);
    }
  }
 finally {
    if (stmt != null) {
      try {
        stmt.close();
      }
 catch (      SQLException e) {
      }
    }
    if (conn != null) {
      try {
        conn.close();
      }
 catch (      SQLException e) {
      }
    }
  }
}
