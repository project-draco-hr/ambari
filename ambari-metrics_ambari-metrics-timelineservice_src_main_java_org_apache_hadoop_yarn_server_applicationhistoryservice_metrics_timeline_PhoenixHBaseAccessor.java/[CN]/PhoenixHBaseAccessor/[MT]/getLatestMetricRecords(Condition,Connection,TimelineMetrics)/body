{
  PreparedStatement stmt=null;
  SplitByMetricNamesCondition splitCondition=new SplitByMetricNamesCondition(condition);
  for (  String metricName : splitCondition.getOriginalMetricNames()) {
    splitCondition.setCurrentMetric(metricName);
    stmt=PhoenixTransactSQL.prepareGetLatestMetricSqlStmt(conn,splitCondition);
    ResultSet rs=stmt.executeQuery();
    while (rs.next()) {
      TimelineMetric metric=getLastTimelineMetricFromResultSet(rs);
      metrics.getMetrics().add(metric);
    }
  }
  return stmt;
}
