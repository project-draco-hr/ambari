{
  String metricName=rs.getString("METRIC_NAME");
  List<Function> functions=metricFunctions.get(metricName);
  for (  Function aggregateFunction : functions) {
    TimelineMetric metric;
    if (condition.getPrecision() == Precision.HOURS) {
      metric=getAggregateHoursTimelineMetricFromResultSet(rs,aggregateFunction);
    }
 else {
      metric=getAggregateTimelineMetricFromResultSet(rs,aggregateFunction);
    }
    if (condition.isGrouped()) {
      metrics.addOrMergeTimelineMetric(metric);
    }
 else {
      metrics.getMetrics().add(metric);
    }
  }
}
