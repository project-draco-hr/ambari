{
  if (condition.getPrecision() == Precision.HOURS || condition.getPrecision() == Precision.MINUTES || condition.getPrecision() == Precision.DAYS) {
    String metricName=rs.getString("METRIC_NAME");
    List<Function> functions=metricFunctions.get(metricName);
    for (    Function f : functions) {
      SingleValuedTimelineMetric metric=getAggregatedTimelineMetricFromResultSet(rs,f);
      if (condition.isGrouped()) {
        metrics.addOrMergeTimelineMetric(metric);
      }
 else {
        metrics.getMetrics().add(metric.getTimelineMetric());
      }
    }
  }
 else {
    TimelineMetric metric;
    metric=TIMELINE_METRIC_READ_HELPER.getTimelineMetricFromResultSet(rs);
    if (condition.isGrouped()) {
      metrics.addOrMergeTimelineMetric(metric);
    }
 else {
      metrics.getMetrics().add(metric);
    }
  }
}
