{
  TOperationHandle handle=null;
  for (  final String oneCmd : cmd.split(";")) {
    TExecuteStatementResp execResp=new HiveCall<TExecuteStatementResp>(this){
      @Override public TExecuteStatementResp body() throws HiveClientException {
        TExecuteStatementReq execReq=null;
        openSession();
        execReq=new TExecuteStatementReq(getSessHandle(),oneCmd);
        execReq.setRunAsync(async);
        execReq.setConfOverlay(new HashMap<String,String>());
        try {
          return client.ExecuteStatement(execReq);
        }
 catch (        TException e) {
          throw new HiveClientException("Unable to submit statement " + cmd,e);
        }
      }
    }
.call();
    Utils.verifySuccess(execResp.getStatus(),"Unable to submit statement " + cmd);
    handle=execResp.getOperationHandle();
  }
  if (handle == null) {
    throw new HiveClientException("Empty command given",null);
  }
  return handle;
}
