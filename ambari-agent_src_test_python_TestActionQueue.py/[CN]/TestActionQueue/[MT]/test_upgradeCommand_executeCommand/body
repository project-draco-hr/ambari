@patch.object(UpgradeExecutor, 'perform_stack_upgrade')
def test_upgradeCommand_executeCommand(self, perform_stack_upgrade_method):
    queue = ActionQueue(config=MagicMock())
    command = {'commandId': 17, 'role': 'role', 'taskId': 'taskId', 'clusterName': 'clusterName', 'serviceName': 'serviceName', 'roleCommand': 'UPGRADE', 'hostname': 'localhost.localdomain', 'hostLevelParams': 'hostLevelParams', 'clusterHostInfo': 'clusterHostInfo', 'configurations': 'configurations', 'commandType': 'EXECUTION_COMMAND', 'configurations': {'global': {}, }, 'roleParams': {}, 'commandParams': {'source_stack_version': 'HDP-1.2.1', 'target_stack_version': 'HDP-1.3.0', }, }
    perform_stack_upgrade_method.return_value = {'exitcode': 0, 'stdout': 'abc', 'stderr': 'def', }
    result = queue.executeCommand(command)
    expected_result = [{'actionId': 17, 'clusterName': 'clusterName', 'exitCode': 0, 'role': 'role', 'serviceName': 'serviceName', 'status': 'COMPLETED', 'stderr': 'def', 'stdout': 'abc', 'taskId': 'taskId', }]
    self.assertEquals(result, expected_result)
