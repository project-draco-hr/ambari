@OsFamilyFuncImpl(os_family=OsFamilyImpl.DEFAULT)
def falcon(type, action=None):
    import params
    if (action == 'config'):
        Directory(params.falcon_pid_dir, owner=params.falcon_user, recursive=True)
        Directory(params.falcon_log_dir, owner=params.falcon_user, recursive=True)
        Directory(params.falcon_webapp_dir, owner=params.falcon_user, recursive=True)
        Directory(params.falcon_home, owner=params.falcon_user, recursive=True)
        Directory(params.etc_prefix_dir, mode=493, recursive=True)
        Directory(params.falcon_conf_dir, owner=params.falcon_user, recursive=True)
        File((params.falcon_conf_dir + '/falcon-env.sh'), content=InlineTemplate(params.falcon_env_sh_template), owner=params.falcon_user)
        File((params.falcon_conf_dir + '/client.properties'), content=Template('client.properties.j2'), mode=420, owner=params.falcon_user)
        PropertiesFile((params.falcon_conf_dir + '/runtime.properties'), properties=params.falcon_runtime_properties, mode=420, owner=params.falcon_user)
        PropertiesFile((params.falcon_conf_dir + '/startup.properties'), properties=params.falcon_startup_properties, mode=420, owner=params.falcon_user)
        if params.falcon_graph_storage_directory:
            Directory(params.falcon_graph_storage_directory, owner=params.falcon_user, group=params.user_group, mode=509, recursive=True, cd_access='a')
        if params.falcon_graph_serialize_path:
            Directory(params.falcon_graph_serialize_path, owner=params.falcon_user, group=params.user_group, mode=509, recursive=True, cd_access='a')
    if (type == 'server'):
        if (action == 'config'):
            if (params.store_uri[0:4] == 'hdfs'):
                params.HdfsDirectory(params.store_uri, action='create_delayed', owner=params.falcon_user, mode=493)
            if (params.store_uri[0:4] == 'file'):
                Directory(params.store_uri[7:], owner=params.falcon_user, recursive=True)
            params.HdfsDirectory(params.flacon_apps_dir, action='create_delayed', owner=params.falcon_user, mode=511)
            if (params.falcon_store_uri[0:4] == 'hdfs'):
                params.HdfsDirectory(params.falcon_store_uri, action='create_delayed', owner=params.falcon_user, mode=493)
            if (params.falcon_store_uri[0:4] == 'file'):
                Directory(params.falcon_store_uri[7:], owner=params.falcon_user, recursive=True)
            params.HdfsDirectory(None, action='create')
            Directory(params.falcon_local_dir, owner=params.falcon_user, recursive=True, cd_access='a')
            if (params.falcon_embeddedmq_enabled == True):
                Directory(os.path.abspath(os.path.join(params.falcon_embeddedmq_data, '..')), owner=params.falcon_user, recursive=True)
                Directory(params.falcon_embeddedmq_data, owner=params.falcon_user, recursive=True)
        if (action == 'start'):
            Execute(format('{falcon_home}/bin/falcon-start -port {falcon_port}'), user=params.falcon_user, path=params.hadoop_bin_dir)
        if (action == 'stop'):
            Execute(format('{falcon_home}/bin/falcon-stop'), user=params.falcon_user, path=params.hadoop_bin_dir)
            File(params.server_pid_file, action='delete')
