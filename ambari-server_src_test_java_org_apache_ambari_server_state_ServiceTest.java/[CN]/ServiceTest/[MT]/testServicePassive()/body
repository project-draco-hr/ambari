{
  String serviceName="HDFS";
  Service s=serviceFactory.createNew(cluster,serviceName);
  cluster.addService(s);
  s.persist();
  Service service=cluster.getService(serviceName);
  Assert.assertNotNull(service);
  ClusterServiceDAO dao=injector.getInstance(ClusterServiceDAO.class);
  ClusterServiceEntity entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(PassiveState.ACTIVE,entity.getServiceDesiredStateEntity().getPassiveState());
  Assert.assertEquals(PassiveState.ACTIVE,service.getPassiveState());
  service.setPassiveState(PassiveState.PASSIVE);
  Assert.assertEquals(PassiveState.PASSIVE,service.getPassiveState());
  entity=dao.findByClusterAndServiceNames(clusterName,serviceName);
  Assert.assertNotNull(entity);
  Assert.assertEquals(PassiveState.PASSIVE,entity.getServiceDesiredStateEntity().getPassiveState());
}
