{
  initTestData();
  List<AlertGroupEntity> groups=m_dao.findAllGroups();
  assertNotNull(groups);
  assertEquals(10,groups.size());
  for (  AlertGroupEntity group : groups) {
    assertFalse(group.isDefault());
  }
  Cluster cluster=m_helper.buildNewCluster(m_clusters,m_serviceFactory,m_componentFactory,m_schFactory,HOSTNAME);
  assertEquals(12,m_dao.findAllGroups().size());
  AlertDefinitionEntity datanodeProcess=new AlertDefinitionEntity();
  datanodeProcess.setClusterId(cluster.getClusterId());
  datanodeProcess.setDefinitionName("datanode_process");
  datanodeProcess.setServiceName("INVALID");
  datanodeProcess.setComponentName("DATANODE");
  datanodeProcess.setHash(UUID.randomUUID().toString());
  datanodeProcess.setScheduleInterval(60);
  datanodeProcess.setScope(Scope.SERVICE);
  datanodeProcess.setSource("{\"type\" : \"SCRIPT\"}");
  datanodeProcess.setSourceType(SourceType.SCRIPT);
  try {
    m_definitionDao.create(datanodeProcess);
  }
  finally {
    assertEquals(12,m_dao.findAllGroups().size());
    teardown();
  }
}
