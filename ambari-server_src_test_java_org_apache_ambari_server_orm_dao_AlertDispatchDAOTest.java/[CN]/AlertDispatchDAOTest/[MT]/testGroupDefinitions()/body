{
  List<AlertDefinitionEntity> definitions=createDefinitions();
  AlertGroupEntity group=helper.createAlertGroup(clusterId,null);
  group=dao.findGroupById(group.getGroupId());
  assertNotNull(group);
  group.getAlertDefinitions().addAll(definitions);
  dao.merge(group);
  group=dao.findGroupByName(group.getGroupName());
  assertEquals(definitions.size(),group.getAlertDefinitions().size());
  for (  AlertDefinitionEntity definition : definitions) {
    assertTrue(group.getAlertDefinitions().contains(definition));
  }
  definitionDao.refresh(definitions.get(0));
  definitionDao.remove(definitions.get(0));
  definitions.remove(0);
  group=dao.findGroupByName(group.getGroupName());
  assertEquals(definitions.size(),group.getAlertDefinitions().size());
  for (  AlertDefinitionEntity definition : definitions) {
    assertTrue(group.getAlertDefinitions().contains(definition));
  }
}
