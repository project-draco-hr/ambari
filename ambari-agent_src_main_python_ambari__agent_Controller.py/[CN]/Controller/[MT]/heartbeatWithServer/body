def heartbeatWithServer(self):
    retry = False
    id = 0
    while True:
        try:
            if (retry == False):
                data = json.dumps(self.heartbeat.build(id))
                pass
            logger.info(('Sending HeartBeat ' + pprint.pformat(data)))
            req = urllib2.Request(self.heartbeatUrl, data, {'Content-Type': 'application/json', })
            f = security.secured_url_open(req)
            response = f.read()
            f.close()
            response = json.loads(response)
            id = int(response['responseId'])
            if ('executionCommands' in response.keys()):
                self.addToQueue(response['executionCommands'])
                pass
            else:
                logger.info('No commands sent from the Server.')
                pass
            retry = False
        except Exception as err:
            retry = True
            if ('code' in err):
                logger.error(err.code)
            else:
                logger.error(('Unable to connect to: ' + self.heartbeatUrl), exc_info=True)
        if self.actionQueue.isIdle():
            time.sleep(3)
        else:
            time.sleep(1)
    pass
