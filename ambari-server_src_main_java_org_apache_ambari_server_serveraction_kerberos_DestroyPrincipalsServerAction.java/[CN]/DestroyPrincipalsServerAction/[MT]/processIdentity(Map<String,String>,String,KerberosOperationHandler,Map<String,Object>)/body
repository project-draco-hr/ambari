{
  String message=String.format("Destroying identity, %s",evaluatedPrincipal);
  LOG.info(message);
  actionLog.writeStdOut(message);
  try {
    operationHandler.removePrincipal(evaluatedPrincipal);
  }
 catch (  KerberosOperationException e) {
    message=String.format("Failed to remove identity for %s from the KDC - %s",evaluatedPrincipal,e.getMessage());
    LOG.warn(message);
    actionLog.writeStdErr(message);
  }
  try {
    KerberosPrincipalEntity principalEntity=kerberosPrincipalDAO.find(evaluatedPrincipal);
    if (principalEntity != null) {
      String cachedKeytabPath=principalEntity.getCachedKeytabPath();
      kerberosPrincipalDAO.remove(principalEntity);
      if (cachedKeytabPath != null) {
        if (!new File(cachedKeytabPath).delete()) {
          LOG.debug(String.format("Failed to remove cached keytab for %s",evaluatedPrincipal));
        }
      }
    }
  }
 catch (  Throwable t) {
    message=String.format("Failed to remove identity for %s from the Ambari database - %s",evaluatedPrincipal,t.getMessage());
    LOG.warn(message);
    actionLog.writeStdErr(message);
  }
  return null;
}
