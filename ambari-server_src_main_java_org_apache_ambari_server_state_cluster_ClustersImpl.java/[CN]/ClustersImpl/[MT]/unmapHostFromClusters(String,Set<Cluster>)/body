{
  Host host=null;
  HostEntity hostEntity=null;
  checkLoaded();
  if (clusters.isEmpty()) {
    return;
  }
  r.lock();
  try {
    host=getHost(hostname);
    hostEntity=hostDAO.findByName(hostname);
  }
  finally {
    r.unlock();
  }
  w.lock();
  try {
    for (    Cluster cluster : clusters) {
      long clusterId=cluster.getClusterId();
      if (LOG.isDebugEnabled()) {
        LOG.debug("Unmapping host {} from cluster {} (id={})",hostname,cluster.getClusterName(),clusterId);
      }
      unmapHostClusterEntities(hostname,cluster.getClusterId());
      hostClusterMap.get(hostname).remove(cluster);
      clusterHostMap.get(cluster.getClusterName()).remove(host);
      host.refresh();
      cluster.refresh();
    }
    deleteConfigGroupHostMapping(hostEntity.getHostId());
    kerberosPrincipalHostDAO.removeByHost(hostEntity.getHostId());
  }
  finally {
    w.unlock();
  }
}
