{
  checkLoaded();
  if (!hosts.containsKey(hostname)) {
    return;
  }
  w.lock();
  try {
    HostEntity entity=hostDAO.findByName(hostname);
    if (entity == null) {
      return;
    }
    deleteConfigGroupHostMapping(entity.getHostId());
    Collection<HostVersionEntity> hostVersions=hosts.get(hostname).getAllHostVersions();
    for (    HostVersionEntity hostVersion : hostVersions) {
      hostVersionDAO.remove(hostVersion);
    }
    hostDAO.refresh(entity);
    hostDAO.remove(entity);
    hosts.remove(hostname);
    hostsById.remove(entity.getHostId());
    kerberosPrincipalHostDAO.removeByHost(hostname);
    HostRemovedEvent event=new HostRemovedEvent(hostname);
    eventPublisher.publish(event);
  }
 catch (  Exception e) {
    throw new AmbariException("Could not remove host",e);
  }
 finally {
    w.unlock();
  }
}
