{
  checkLoaded();
  w.lock();
  try {
    Host host=getHost(hostname);
    Cluster cluster=getCluster(clusterName);
    if (LOG.isDebugEnabled()) {
      LOG.debug("Unmapping a host from a cluster" + ", clusterName=" + clusterName + ", clusterId="+ cluster.getClusterId()+ ", hostname="+ hostname);
    }
    unmapHostClusterEntities(hostname,cluster.getClusterId());
    host.refresh();
    cluster.refresh();
    hostClusterMap.get(hostname).remove(cluster);
    clusterHostMap.get(clusterName).remove(host);
    host.refresh();
    cluster.refresh();
    deleteConfigGroupHostMapping(hostname);
    kerberosPrincipalHostDAO.removeByHost(hostname);
  }
  finally {
    w.unlock();
  }
}
