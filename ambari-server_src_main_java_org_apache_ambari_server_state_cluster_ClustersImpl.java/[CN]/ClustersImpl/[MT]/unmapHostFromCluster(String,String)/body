{
  Host host=null;
  Cluster cluster=null;
  HostEntity hostEntity=null;
  checkLoaded();
  r.lock();
  try {
    host=getHost(hostname);
    cluster=getCluster(clusterName);
    hostEntity=hostDAO.findByName(hostname);
  }
  finally {
    r.unlock();
  }
  long clusterId=cluster.getClusterId();
  if (LOG.isDebugEnabled()) {
    LOG.debug("Unmapping host {} from cluster {} (id={})",hostname,clusterName,clusterId);
  }
  w.lock();
  try {
    unmapHostClusterEntities(hostname,cluster.getClusterId());
    hostClusterMap.get(hostname).remove(cluster);
    clusterHostMap.get(clusterName).remove(host);
    host.refresh();
    cluster.refresh();
    deleteConfigGroupHostMapping(hostEntity.getHostId());
    kerberosPrincipalHostDAO.removeByHost(hostname);
  }
  finally {
    w.unlock();
  }
}
