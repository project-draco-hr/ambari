{
  ResourceTypeEntity resourceTypeEntity=resourceTypeDAO.findById(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE);
  if (resourceTypeEntity == null) {
    resourceTypeEntity=new ResourceTypeEntity();
    resourceTypeEntity.setId(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE);
    resourceTypeEntity.setName(ResourceTypeEntity.CLUSTER_RESOURCE_TYPE_NAME);
    resourceTypeEntity=resourceTypeDAO.merge(resourceTypeEntity);
  }
  StackEntity stackEntity=stackDAO.find("HDP","0.1");
  ResourceEntity resourceEntity=new ResourceEntity();
  resourceEntity.setResourceType(resourceTypeEntity);
  ClusterEntity clusterEntity=clusterDAO.findByName("c1");
  if (clusterEntity == null) {
    clusterEntity=new ClusterEntity();
    clusterEntity.setClusterName("c1");
    clusterEntity.setResource(resourceEntity);
    clusterEntity.setDesiredStack(stackEntity);
    clusterDAO.create(clusterEntity);
  }
  ServiceConfigEntity serviceConfigEntity=new ServiceConfigEntity();
  serviceConfigEntity.setServiceName(serviceName);
  serviceConfigEntity.setUser(userName);
  serviceConfigEntity.setVersion(version);
  serviceConfigEntity.setServiceConfigId(serviceConfigId);
  serviceConfigEntity.setClusterId(clusterEntity.getClusterId());
  serviceConfigEntity.setCreateTimestamp(createTimestamp);
  serviceConfigEntity.setClusterConfigEntities(clusterConfigEntities);
  serviceConfigEntity.setClusterEntity(clusterEntity);
  serviceConfigEntity.setStack(clusterEntity.getDesiredStack());
  serviceConfigDAO.create(serviceConfigEntity);
  return serviceConfigEntity;
}
