{
  URLStreamProviderBasicAuth urlStreamProviderBasicAuth;
  if (isRemoteCluster()) {
    if (remoteUsername == null || remoteUsername.isEmpty() || remotePassword == null || remotePassword.isEmpty()) {
      throw new AmbariApiException("RA020 Remote Ambari username and password are not filled");
    }
    URLStreamProvider urlStreamProvider=context.getURLStreamProvider();
    urlStreamProviderBasicAuth=new URLStreamProviderBasicAuth(urlStreamProvider,remoteUsername,remotePassword);
  }
 else   if (isLocalCluster()) {
    urlStreamProviderBasicAuth=new URLStreamProviderBasicAuth(context.getAmbariStreamProvider());
  }
 else {
    throw new NoClusterAssociatedException("RA070 Not associated with any cluster. URLStreamProvider is not available");
  }
  urlStreamProviderBasicAuth.setRequestedBy(requestedBy);
  return urlStreamProviderBasicAuth;
}
