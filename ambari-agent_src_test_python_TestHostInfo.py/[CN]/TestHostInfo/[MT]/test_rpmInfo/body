@patch('subprocess.Popen')
def test_rpmInfo(self, subproc_popen):
    hostInfo = HostInfo()
    p = MagicMock()
    p.returncode = 0
    p.communicate.side_effect = [('out', 'err'), ('', 'err'), ('out', 'err', 'fail')]
    subproc_popen.return_value = p
    rpmList = []
    hostInfo.rpmInfo(rpmList)
    self.assertEquals(rpmList[0]['version'], 'out')
    self.assertEquals(rpmList[0]['name'], 'glusterfs')
    self.assertTrue(rpmList[0]['installed'])
    self.assertEquals(rpmList[1]['name'], 'openssl')
    self.assertFalse(rpmList[1]['installed'])
    self.assertFalse(rpmList[2]['available'])
    self.assertEquals(rpmList[2]['name'], 'wget')
