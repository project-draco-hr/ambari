{
  Map<Long,Resource> resourceMap=new HashMap<Long,Resource>();
  List<RequestEntity> requests=s_requestDAO.findByPks(requestIds);
  for (  RequestEntity re : requests) {
    if ((null == clusterId && (null == re.getClusterId() || -1L == re.getClusterId())) || (null != clusterId && null != re.getRequestId() && re.getClusterId().equals(clusterId))) {
      Resource r=getRequestResource(re,clusterName,requestedPropertyIds);
      resourceMap.put(re.getRequestId(),r);
    }
  }
  return resourceMap.values();
}
