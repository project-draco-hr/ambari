{
  List<HostRoleCommand> hostRoleCommands=actionManager.getAllTasksByRequestIds(requestIds);
  Map<Long,String> requestContexts=actionManager.getRequestContext(requestIds);
  Map<Long,Resource> resourceMap=new HashMap<Long,Resource>();
  Map<Long,Set<HostRoleCommand>> commandMap=new HashMap<Long,Set<HostRoleCommand>>();
  for (  HostRoleCommand hostRoleCommand : hostRoleCommands) {
    Long requestId=hostRoleCommand.getRequestId();
    Set<HostRoleCommand> commands=commandMap.get(requestId);
    if (commands == null) {
      commands=new HashSet<HostRoleCommand>();
      commandMap.put(requestId,commands);
    }
    commands.add(hostRoleCommand);
  }
  for (  Map.Entry<Long,Set<HostRoleCommand>> entry : commandMap.entrySet()) {
    Long requestId=entry.getKey();
    Set<HostRoleCommand> commands=entry.getValue();
    String context=requestContexts.get(requestId);
    resourceMap.put(requestId,getRequestResource(clusterName,requestId,context,commands,requestedPropertyIds));
  }
  return resourceMap.values();
}
