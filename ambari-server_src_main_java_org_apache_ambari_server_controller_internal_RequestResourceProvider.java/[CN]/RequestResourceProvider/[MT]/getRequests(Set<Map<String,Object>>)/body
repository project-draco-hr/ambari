{
  Map<String,Set<RequestStatusRequest>> requestSetMap=new HashMap<String,Set<RequestStatusRequest>>();
  for (  Map<String,Object> properties : propertiesSet) {
    Long requestId=null;
    String clusterName=(String)properties.get(REQUEST_CLUSTER_NAME_PROPERTY_ID);
    Set<RequestStatusRequest> requestSet=requestSetMap.get(clusterName);
    if (requestSet == null) {
      requestSet=new HashSet<RequestStatusRequest>();
      requestSetMap.put(clusterName,requestSet);
    }
    if (properties.get(REQUEST_ID_PROPERTY_ID) != null) {
      requestId=Long.valueOf((String)properties.get(REQUEST_ID_PROPERTY_ID));
    }
    String requestStatus=null;
    if (properties.get(REQUEST_STATUS_PROPERTY_ID) != null) {
      requestStatus=(String)properties.get(REQUEST_STATUS_PROPERTY_ID);
    }
    requestSet.add(new RequestStatusRequest(requestId,requestStatus));
  }
  return requestSetMap;
}
