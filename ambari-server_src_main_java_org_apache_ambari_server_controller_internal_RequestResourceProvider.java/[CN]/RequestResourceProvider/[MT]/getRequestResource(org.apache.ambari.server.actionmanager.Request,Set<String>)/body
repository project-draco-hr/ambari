{
  Resource resource=new ResourceImpl(Resource.Type.Request);
  if (null != request.getClusterName())   setResourceProperty(resource,REQUEST_CLUSTER_NAME_PROPERTY_ID,request.getClusterName(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_ID_PROPERTY_ID,request.getRequestId(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_CONTEXT_ID,request.getRequestContext(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_TYPE_ID,request.getRequestType(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_INPUTS_ID,request.getInputs(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_RESOURCE_FILTER_ID,request.getResourceFilters(),requestedPropertyIds);
  RequestOperationLevel operationLevel=request.getOperationLevel();
  String opLevelStr=null;
  if (operationLevel != null) {
    opLevelStr=RequestOperationLevel.getExternalLevelName(operationLevel.getLevel().toString());
  }
  setResourceProperty(resource,REQUEST_OPERATION_LEVEL_ID,opLevelStr,requestedPropertyIds);
  setResourceProperty(resource,REQUEST_CREATE_TIME_ID,request.getCreateTime(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_START_TIME_ID,request.getStartTime(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_END_TIME_ID,request.getEndTime(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_EXCLUSIVE_ID,request.isExclusive(),requestedPropertyIds);
  if (request.getRequestScheduleId() != null) {
    setResourceProperty(resource,REQUEST_SOURCE_SCHEDULE_ID,request.getRequestScheduleId(),requestedPropertyIds);
  }
 else {
    setResourceProperty(resource,REQUEST_SOURCE_SCHEDULE,null,requestedPropertyIds);
  }
  Collection<HostRoleCommand> commands=request.getCommands();
  Collection<Stage> stages=request.getStages();
  CalculatedStatus status=CalculatedStatus.statusFromStages(stages);
  setResourceProperty(resource,REQUEST_STATUS_PROPERTY_ID,status.getStatus().toString(),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_PROGRESS_PERCENT_ID,status.getPercent(),requestedPropertyIds);
  int taskCount=commands.size();
  Map<HostRoleStatus,Integer> hostRoleStatusCounters=CalculatedStatus.calculateStatusCounts(getHostRoleStatuses(commands));
  setResourceProperty(resource,REQUEST_TASK_CNT_ID,taskCount,requestedPropertyIds);
  setResourceProperty(resource,REQUEST_FAILED_TASK_CNT_ID,hostRoleStatusCounters.get(HostRoleStatus.FAILED),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_ABORTED_TASK_CNT_ID,hostRoleStatusCounters.get(HostRoleStatus.ABORTED),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_TIMED_OUT_TASK_CNT_ID,hostRoleStatusCounters.get(HostRoleStatus.TIMEDOUT),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_QUEUED_TASK_CNT_ID,hostRoleStatusCounters.get(HostRoleStatus.QUEUED),requestedPropertyIds);
  setResourceProperty(resource,REQUEST_COMPLETED_TASK_CNT_ID,hostRoleStatusCounters.get(HostRoleStatus.COMPLETED),requestedPropertyIds);
  return resource;
}
