def connect(self):
    if self.sock:
        self.sock.close()
    logger.info('SSL Connect being called.. connecting to the server')
    sock = socket.create_connection((self.host, self.port), 60)
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1)
    if self._tunnel_host:
        self.sock = sock
        self._tunnel()
    agent_key = (((AmbariConfig.config.get('security', 'keysdir') + os.sep) + hostname.hostname()) + '.key')
    agent_crt = (((AmbariConfig.config.get('security', 'keysdir') + os.sep) + hostname.hostname()) + '.crt')
    server_crt = ((AmbariConfig.config.get('security', 'keysdir') + os.sep) + 'ca.crt')
    self.sock = ssl.wrap_socket(sock, keyfile=agent_key, certfile=agent_crt, cert_reqs=ssl.CERT_REQUIRED, ca_certs=server_crt)
