def connect(self):
    sock = socket.create_connection((self.host, self.port), self.timeout)
    if self._tunnel_host:
        self.sock = sock
        self._tunnel()
    agent_key = (((AmbariConfig.config.get('security', 'keysdir') + os.sep) + socket.gethostname()) + '.key')
    agent_crt = (((AmbariConfig.config.get('security', 'keysdir') + os.sep) + socket.gethostname()) + '.crt')
    server_crt = ((AmbariConfig.config.get('security', 'keysdir') + os.sep) + 'ca.crt')
    self.sock = ssl.wrap_socket(sock, keyfile=agent_key, certfile=agent_crt, cert_reqs=ssl.CERT_REQUIRED, ca_certs=server_crt)
