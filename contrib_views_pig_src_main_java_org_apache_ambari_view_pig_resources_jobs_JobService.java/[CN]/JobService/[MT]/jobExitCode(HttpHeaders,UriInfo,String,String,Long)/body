{
  PigJob job=null;
  try {
    job=getResourceManager().read(jobId);
  }
 catch (  ItemNotFound itemNotFound) {
    return Response.ok("No such job").status(404).build();
  }
  try {
    String filePath=job.getStatusDir() + "/" + fileName;
    LOG.debug("Reading file " + filePath);
    FilePaginator paginator=new FilePaginator(filePath,context);
    if (page == null)     page=0L;
    FileResource file=new FileResource();
    file.filePath=filePath;
    file.fileContent=paginator.readPage(page);
    file.hasNext=paginator.pageCount() > page + 1;
    file.page=page;
    file.pageCount=paginator.pageCount();
    JSONObject object=new JSONObject();
    object.put("file",file);
    return Response.ok(object).status(200).build();
  }
 catch (  IOException e) {
    return Response.ok(e.getMessage()).status(404).build();
  }
catch (  InterruptedException e) {
    return Response.ok(e.getMessage()).status(404).build();
  }
}
